<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pelican on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/pelican/</link><description>Recent content in Pelican on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Thu, 09 Jan 2014 14:55:00 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/pelican/index.xml" rel="self" type="application/rss+xml"/><item><title>ç”¨Misakaåšä¸ºpelicançš„Markdownè§£æå™¨</title><link>https://wizmann.top/posts/misaka-pelican/</link><pubDate>Thu, 09 Jan 2014 14:55:00 +0000</pubDate><guid>https://wizmann.top/posts/misaka-pelican/</guid><description>&lt;h2 id="ä¸ºå•¥">ä¸ºå•¥ï¼Ÿ &lt;a href="#%e4%b8%ba%e5%95%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Pelicanå†…ç½®&lt;a href="http://pythonhosted.org/Markdown/">python-markdown&lt;/a>åšä¸ºé»˜è®¤è§£æå™¨ï¼Œç”¨æ¥å°†ç”¨æˆ·çš„&lt;code>Markdown&lt;/code>æ ¼å¼çš„æ–‡ç« è½¬ä¸ºç½‘é¡µæ ¼å¼å±•ç¤ºã€‚&lt;/p>
&lt;p>&lt;strong>ç„¶è€Œ&lt;/strong>ï¼Œ&lt;code>python-markdown&lt;/code>æ¨¡å—çš„è§£æé€»è¾‘æœ‰ä¸¥é‡çš„Bugã€‚ä¾‹å¦‚ä¸€ä¸ª&lt;code>æœªæ ‡æ˜è¯­è¨€çš„ä»£ç å—&lt;/code>ä¼šè¢«æ ‡å‡ºå¾ˆå¤šè«åå¥‡å¦™çš„é”™è¯¯ï¼›è¿˜æœ‰&lt;code>C++&lt;/code>ä¸­çš„æŒ‡é’ˆç¬¦å·&lt;code>*&lt;/code>ä¼šè¢«è§£æä¸ºæ–œä½“çš„ç¬¦å·&lt;code>*SomeText*&lt;/code>ï¼Œåœ¨ä»£ç å—ä¸­ä¼šäº§ç”Ÿå¤§é‡å’Œè¯­æ³•é«˜äº®æ— å…³çš„æ–œä½“å­—ã€‚&lt;/p>
&lt;p>åœ¨ç½‘ä¸Šå¯»æ‰¾äº†å¾ˆä¹…çš„ç­”æ¡ˆï¼Œç»ˆäºæ‰¾åˆ°äº†ä¸€ç¯‡&lt;a href="http://qiita.com/5t111111/items/4614b207f3942d05e55c">æ—¥æ–‡åšå®¢&lt;/a>ï¼Œå…¶ä¸­è®²åˆ°äº†ä½¿ç”¨&lt;a href="http://misaka.61924.nl/">misaka&lt;/a>æ¥æ›¿æ¢&lt;code>python-markdown&lt;/code>æ¥è§£ææ—¥å¿—ã€‚&lt;/p>
&lt;h2 id="ä¸¤éš¾çš„metadata">ä¸¤éš¾çš„Metadata &lt;a href="#%e4%b8%a4%e9%9a%be%e7%9a%84metadata" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æˆ‘ä½¿ç”¨äº†ä¸Šæ–‡æåˆ°çš„æ—¥å¿—ä¸­çš„æ–¹æ³•æ¥æ›¿æ¢è§£æå™¨ï¼Œæ•ˆæœæ‹”ç¾¤ï¼Œæ—¥å¿—ä¸­çš„è§£æé—®é¢˜å®Œå…¨è§£å†³äº†ã€‚ä½†æ˜¯æ—¥å¿—ä¸­çš„&lt;code>Metadata&lt;/code>å¹¶æ²¡æœ‰è¢«éšè—ï¼Œè€Œæ˜¯æ˜¾ç¤ºåœ¨äº†æ—¥å¿—çš„æœ€å‰é¢ï¼Œéå¸¸å½±å“å¿ƒæƒ…ï¼ˆå¼ºè¿«ç—‡ï¼Ÿï¼‰ã€‚&lt;/p>
&lt;p>äºæ˜¯æˆ‘åˆ†æäº†è§£ææ¨¡å—çš„ä»£ç ã€‚åŸæ¥çš„è§£ææ¨¡å—ä½¿ç”¨äº†&lt;code>python-markdown&lt;/code>çš„ä¸€ä¸ªå¤„ç†&lt;code>Metadata&lt;/code>çš„&lt;a href="https://github.com/waylan/Python-Markdown/blob/master/markdown/extensions/meta.py">æ‰©å±•&lt;/a>ï¼Œç”¨æ¥è§£æ&lt;code>Metadata&lt;/code>ï¼Œå¹¶ä»æ­£æ–‡ä¸­åˆ é™¤è¿™ä¸€éƒ¨åˆ†ã€‚&lt;/p>
&lt;p>ä½†æ˜¯&lt;code>Misaka&lt;/code>å¹¶ä¸æ”¯æŒè¿™ç§è¯­æ³•ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰å¤„ç†&lt;code>Metadata&lt;/code>çš„æ’ä»¶ã€‚&lt;/p>
&lt;p>äºæ˜¯æˆ‘æƒ³å¯ä¸å¯ä»¥æŠŠè¿™ä¸¤ç§&lt;code>Markdown&lt;/code>è§£æå™¨çš„é•¿å¤„åˆå¹¶ä¸€ä¸‹ï¼Œä»è€Œå®ç°æœ€ç»ˆçš„ç›®æ ‡ã€‚&lt;/p>
&lt;h2 id="å°å°çš„æ”¹åŠ¨">å°å°çš„æ”¹åŠ¨ &lt;a href="#%e5%b0%8f%e5%b0%8f%e7%9a%84%e6%94%b9%e5%8a%a8" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ç¼–è¾‘&lt;code>pelican&lt;/code>çš„&lt;code>readers.py&lt;/code>æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ï¼ˆæˆ‘æ˜¯ç›´æ¥æ”¹çš„&lt;code>/usr/local/lib/python2.7/dist-packages/pelican&lt;/code>ä¸‹çš„æ–‡ä»¶ï¼Œä¸å¤ªä¼˜é›…ï¼Œä¸è¿‡è¿™ä¸ªæ”¹åŠ¨ä¹Ÿæ˜¯éå¸¸Dirtyçš„ï¼Œåªæ˜¯ç”¨æ¥è§£å†³é—®é¢˜ï¼‰&lt;/p>
&lt;p>é¦–å…ˆå¼•ç”¨&lt;code>Misaka&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> markdown &lt;span style="color:#f92672">import&lt;/span> Markdown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">import&lt;/span> misaka
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">import&lt;/span> pygments
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">ImportError&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Markdown &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span> &lt;span style="color:#75715e"># NOQA&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†ä¿®æ”¹&lt;code>class MarkdownReader&lt;/code>ï¼Œæ”¹å˜è§£æé€»è¾‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">read&lt;/span>(self, source_path):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;Parse content and metadata of markdown files&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#æå–Metadata&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> self&lt;span style="color:#f92672">.&lt;/span>_md &lt;span style="color:#f92672">=&lt;/span> Markdown(extensions&lt;span style="color:#f92672">=&lt;/span>self&lt;span style="color:#f92672">.&lt;/span>extensions)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> pelican_open(source_path) &lt;span style="color:#66d9ef">as&lt;/span> text:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">=&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>_md&lt;span style="color:#f92672">.&lt;/span>convert(text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> metadata &lt;span style="color:#f92672">=&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>_parse_metadata(self&lt;span style="color:#f92672">.&lt;/span>_md&lt;span style="color:#f92672">.&lt;/span>Meta)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#è‡ªå®šä¹‰Misakaè§£æå™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> renderer &lt;span style="color:#f92672">=&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>BleepRenderer()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> misaka_md &lt;span style="color:#f92672">=&lt;/span> misaka&lt;span style="color:#f92672">.&lt;/span>Markdown(renderer,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> extensions&lt;span style="color:#f92672">=&lt;/span>misaka&lt;span style="color:#f92672">.&lt;/span>EXT_FENCED_CODE &lt;span style="color:#f92672">|&lt;/span> misaka&lt;span style="color:#f92672">.&lt;/span>EXT_NO_INTRA_EMPHASIS)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> misaka_content &lt;span style="color:#f92672">=&lt;/span> misaka_md&lt;span style="color:#f92672">.&lt;/span>render(text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> misaka_content, metadata
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„&lt;code>Misaka&lt;/code>è§£æå™¨ï¼Œç”¨æ¥å»é™¤&lt;code>Metadata&lt;/code>ä¿¡æ¯&lt;/p>
&lt;p>è¿™æ®µä»£ç æ˜¯åŸºäºä¸Šæ–‡è¯´çš„é‚£ç¯‡æ—¥å¿—å’Œ&lt;code>Misaka&lt;/code>çš„å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰é—®é¢˜çš„è¯å¯ä»¥å»æŸ¥é˜…ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">BleepRenderer&lt;/span>(misaka&lt;span style="color:#f92672">.&lt;/span>HtmlRenderer, misaka&lt;span style="color:#f92672">.&lt;/span>SmartyPants):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#é¢„å¤„ç†å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">preprocess&lt;/span>(self, text):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#ä½¿ç”¨ä¸€ä¸ªFakeClassæ¥éª—è¿‡å¯¹è±¡å…ƒç´ çš„æ£€æŸ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#åŒæ—¶æˆ‘ä»¬åªæ˜¯åˆ é™¤Metadataï¼Œå¹¶ä¸ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥è¿™æ ·çš„ä¿®æ”¹æ˜¯å¯ä»¥æ¥å—çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">FakeClass&lt;/span>(object):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">__init__&lt;/span>(self):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> self&lt;span style="color:#f92672">.&lt;/span>Meta &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#è°ƒç”¨Markdownçš„æ’ä»¶æ¥å¤„ç†Metadata&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">import&lt;/span> markdown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mp &lt;span style="color:#f92672">=&lt;/span> markdown&lt;span style="color:#f92672">.&lt;/span>extensions&lt;span style="color:#f92672">.&lt;/span>meta&lt;span style="color:#f92672">.&lt;/span>MetaPreprocessor()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mp&lt;span style="color:#f92672">.&lt;/span>markdown &lt;span style="color:#f92672">=&lt;/span> FakeClass()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lines &lt;span style="color:#f92672">=&lt;/span> mp&lt;span style="color:#f92672">.&lt;/span>run(text&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(lines)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#å‘Šè¯‰Misakaå¦‚ä½•å¤„ç†ä»£ç ï¼Œä½¿ç”¨pygmentsè¿›è¡Œé«˜äº®å¤„ç†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">block_code&lt;/span>(self, text, lang):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> lang:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;&lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74">&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> escape(text&lt;span style="color:#f92672">.&lt;/span>strip())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lexer &lt;span style="color:#f92672">=&lt;/span> pygments&lt;span style="color:#f92672">.&lt;/span>lexers&lt;span style="color:#f92672">.&lt;/span>get_lexer_by_name(lang, stripall&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> formatter &lt;span style="color:#f92672">=&lt;/span> pygments&lt;span style="color:#f92672">.&lt;/span>formatters&lt;span style="color:#f92672">.&lt;/span>HtmlFormatter()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> pygments&lt;span style="color:#f92672">.&lt;/span>highlight(text, lexer, formatter)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç»“è¯­">ç»“è¯­ &lt;a href="#%e7%bb%93%e8%af%ad" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>è¿™ä¸ªä¿®æ”¹çœŸTMD&lt;strong>ç³™å¿«çŒ›&lt;/strong>å•Šï¼&lt;/p>
&lt;h2 id="æ–‡ä»¶ä¸‹è½½">æ–‡ä»¶ä¸‹è½½ &lt;a href="#%e6%96%87%e4%bb%b6%e4%b8%8b%e8%bd%bd" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¿®æ”¹å¥½çš„&lt;code>readers.py&lt;/code>æ–‡ä»¶ï¼š
&lt;a href="https://s.yunio.com/_Lt!Lb">æˆ³æˆ‘&lt;/a>&lt;/p></description></item></channel></rss>