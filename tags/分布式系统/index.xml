<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>åˆ†å¸ƒå¼ç³»ç»Ÿ on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/</link><description>Recent content in åˆ†å¸ƒå¼ç³»ç»Ÿ on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Sat, 17 May 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/index.xml" rel="self" type="application/rss+xml"/><item><title>ä¸ºä»€ä¹ˆæˆ‘ä¸å»ºè®®ä½ é˜…è¯»ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ï¼ˆä¹‹ä¸€ï¼‰</title><link>https://wizmann.top/posts/why-not-start-with-ddia-part-1/</link><pubDate>Sat, 17 May 2025 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/why-not-start-with-ddia-part-1/</guid><description>&lt;p>&lt;strong>å› ä¸ºæˆ‘æ˜¯æ ‡é¢˜å…šã€‚&lt;/strong>&lt;/p>
&lt;p>è¿™æœ¬ä¹¦ä¸æˆ‘ä»¬å¸¸ç”¨æ¥å«æ˜¾ç¤ºå™¨çš„ã€Šç®—æ³•å¯¼è®ºã€‹æˆ–ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼ˆå¦‚æœä½ æ˜¯å¤§ä¸€å¤§äºŒçš„åŒå­¦ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹ï¼‰å¹¶ä¸å±äºåŒä¸€ç±»ã€‚å®ƒæ›´æ¥è¿‘ã€ŠC++ Primerã€‹æˆ–é‚£æœ¬ã€Šç®—æ³•ã€‹(Robert Sedgewick è‘—ï¼‰â€”â€”å±äºé€šè¯†å‹è¯»ç‰©ã€‚&lt;/p>
&lt;p>æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ å°šæœªæŒæ¡ç›¸å…³åŸºç¡€çŸ¥è¯†ï¼Œé˜…è¯»è¿™æœ¬ä¹¦çš„å­¦ä¹ æ›²çº¿å°†ä¼šå¼‚å¸¸é™¡å³­ï¼›è€Œä¸€æ—¦ä½ å·²ç»å…¥é—¨ï¼Œå®ƒçš„è¡¨è¾¾æ–¹å¼ä¼šè®©ä½ è§‰å¾—ååˆ†ä¼˜é›…ï¼Œç»“æ„ä¹Ÿå¾ˆæ¸…æ™°ï¼Œå´åˆå¯èƒ½è®©ä½ è§‰å¾—â€œè¯´å¾—éƒ½å¯¹ï¼Œä½†å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆæ–°ä¸œè¥¿â€ã€‚&lt;/p>
&lt;p>å¦‚æœä½ æ˜¯åˆå…¥æ•°æ®ç›¸å…³ç³»ç»Ÿé¢†åŸŸçš„æ–°æ‰‹ï¼Œæˆ‘æ›´å¸Œæœ›ä½ å…ˆå¯¹è¿™æœ¬ä¹¦çš„è„‰ç»œå’Œé‡ç‚¹æœ‰ä¸ªæ¸…æ™°æ¦‚è§ˆï¼Œå‰ªæä¿¡æ¯ã€åŒ–ç¹ä¸ºç®€ï¼Œå¸®åŠ©ä½ æ›´å¿«å»ºç«‹èµ·åŸºç¡€è®¤çŸ¥ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°é˜…è¯»è¿™æœ¬ä¹¦ï¼Œè€Œä¸æ˜¯åœ¨æœ¯è¯­å’Œç»†èŠ‚ä¸­åå¤è¿·è·¯ã€‚&lt;/p>
&lt;h2 id="ä»€ä¹ˆæ˜¯æ•°æ®å¯†é›†å‹ç³»ç»Ÿ">ä»€ä¹ˆæ˜¯æ•°æ®å¯†é›†å‹ç³»ç»Ÿ &lt;a href="#%e4%bb%80%e4%b9%88%e6%98%af%e6%95%b0%e6%8d%ae%e5%af%86%e9%9b%86%e5%9e%8b%e7%b3%bb%e7%bb%9f" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æ•°æ®å¯†é›†å‹ç³»ç»Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç»“æ„ä¸Šçš„â€œåŒé¢ä½“â€ï¼šä¸€æ–¹é¢ï¼Œå®ƒéœ€è¦å®æ—¶åœ°å¤„ç†æ•°æ®çš„å­˜å‚¨ä¸æ£€ç´¢ï¼›å¦ä¸€æ–¹é¢ï¼Œå®ƒè¿˜æ‰¿æ‹…ç€å¼‚æ­¥å¤„ç†å’Œè®¡ç®—å·²æœ‰æ•°æ®çš„ä»»åŠ¡ã€‚è¿™ä¸¤ç§æ¨¡å¼å…±åŒæ”¯æ’‘äº†ç³»ç»Ÿå¯¹æ•°æ®çš„å…¨é¢åˆ©ç”¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¹‹æ‰€ä»¥ç§°å…¶ä¸ºâ€œæ•°æ®å¯†é›†å‹â€ï¼Œæ˜¯å› ä¸ºå®ƒæ‰€å¤„ç†çš„æ•°æ®å…·å¤‡ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒç‰¹å¾ï¼š&lt;/p>
&lt;ul>
&lt;li>æ•°æ®æ˜¯ä¸å¯å†ç”Ÿçš„â€”â€”ä¸€æ—¦ä¸¢å¤±ï¼Œå°±æ— æ³•é‡æ–°è·å–ï¼Œå…·æœ‰å”¯ä¸€æ€§ä¸ä¸å¯é€†æ€§ï¼›&lt;/li>
&lt;li>æ•°æ®æ˜¯æŒç»­å¢é•¿çš„â€”â€”ç³»ç»Ÿéœ€è¦ä¸æ–­æ¥æ”¶æ–°æ•°æ®ï¼Œæ•°æ®é‡éšç€æ—¶é—´æ¨ç§»å‘ˆçº¿æ€§ï¼Œç”šè‡³æŒ‡æ•°çº§ä¸Šå‡ï¼›&lt;/li>
&lt;li>æ•°æ®çš„åº”ç”¨æ˜¯ä¸æ–­æ¼”è¿›çš„â€”â€”æ•°æ®çš„ä»·å€¼å’Œä½¿ç”¨æ–¹å¼ä¼šéšç€ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯æ‰‹æ®µçš„å‘å±•è€Œå˜åŒ–ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ­£å› ä¸ºå¦‚æ­¤ï¼Œè®¾è®¡å’Œæ„å»ºæ•°æ®å¯†é›†å‹ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»é‡ç‚¹å…³æ³¨ä¸‰ä¸ªç›®æ ‡ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯é æ€§ï¼šé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼Œä¿éšœç³»ç»Ÿåœ¨æ•…éšœæ—¶èƒ½å¤Ÿæ­£ç¡®æ¢å¤ï¼›&lt;/li>
&lt;li>å¯æ‰©å±•æ€§ï¼šç³»ç»Ÿèƒ½å¤Ÿéšç€æ•°æ®é‡å’Œè®¿é—®é‡çš„å¢åŠ å¹³ç¨³æ‰©å±•ï¼›&lt;/li>
&lt;li>å¯ç»´æŠ¤æ€§ï¼šç³»ç»Ÿç»“æ„æ¸…æ™°ã€æ˜“äºç†è§£ï¼Œèƒ½å¤Ÿé€‚åº”æœªæ¥ä¸æ–­å˜åŒ–çš„éœ€æ±‚å’Œç¯å¢ƒã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ•°æ®æ¨¡å‹ä¸æ•°æ®ç¼–ç ">æ•°æ®æ¨¡å‹ä¸æ•°æ®ç¼–ç  &lt;a href="#%e6%95%b0%e6%8d%ae%e6%a8%a1%e5%9e%8b%e4%b8%8e%e6%95%b0%e6%8d%ae%e7%bc%96%e7%a0%81" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="æ•°æ®æ¨¡å‹">æ•°æ®æ¨¡å‹ &lt;a href="#%e6%95%b0%e6%8d%ae%e6%a8%a1%e5%9e%8b" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æ•°æ®æ¨¡å‹æ˜¯å¯¹ç°å®ä¸–ç•Œçš„ç»“æ„åŒ–æŠ½è±¡ï¼Œæ˜¯æˆ‘ä»¬ä¸æ•°æ®ç³»ç»Ÿæ²Ÿé€šçš„â€œè¯­è¨€â€ã€‚ä¸åŒç±»å‹çš„æ•°æ®æ¨¡å‹åŸºäºä¸åŒçš„è®¾è®¡å‡è®¾ï¼Œé€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚&lt;/p>
&lt;p>å¸¸è§çš„æ•°æ®æ¨¡å‹åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å…³ç³»æ¨¡å‹&lt;/p>
&lt;ul>
&lt;li>å…¸å‹ä»£è¡¨ï¼šMySQLã€PostgreSQL ç­‰ä¼ ç»Ÿ SQL æ•°æ®åº“&lt;/li>
&lt;li>æ•°æ®ä»¥â€œè¡¨æ ¼â€çš„å½¢å¼ç»„ç»‡ï¼Œæ¯å¼ è¡¨è¡¨ç¤ºä¸€ç§å®ä½“æˆ–å…³ç³»ï¼Œæ¯è¡Œæ˜¯ä¸€æ¡è®°å½•&lt;/li>
&lt;li>ç‰¹ç‚¹ï¼š
&lt;ul>
&lt;li>ä¸¥æ ¼çš„ç»“æ„çº¦æŸï¼ˆschemaï¼‰&lt;/li>
&lt;li>æ”¯æŒå¤æ‚çš„æŸ¥è¯¢è¯­å¥å’Œäº‹åŠ¡å¤„ç†&lt;/li>
&lt;li>æ•°æ®ä¸€è‡´æ€§å¼ºï¼Œé€‚åˆç»“æ„æ¸…æ™°ã€å…³ç³»å¤æ‚çš„åœºæ™¯&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>æ–‡æ¡£æ¨¡å‹&lt;/p>
&lt;ul>
&lt;li>å…¸å‹ä»£è¡¨ï¼šMongoDBã€Redisï¼ˆéƒ¨åˆ†ç”¨ä½œæ–‡æ¡£å­˜å‚¨ï¼‰ç­‰ NoSQL ç³»ç»Ÿ&lt;/li>
&lt;li>æ•°æ®ä»¥æ–‡æ¡£å½¢å¼ç»„ç»‡ï¼ˆé€šå¸¸æ˜¯ JSON æˆ– BSON æ ¼å¼ï¼‰ï¼Œæ¯ä¸ªæ–‡æ¡£æ˜¯ä¸€æ¡è®°å½•&lt;/li>
&lt;li>ç‰¹ç‚¹ï¼š
&lt;ul>
&lt;li>æ¨¡å¼çµæ´»ï¼Œä¸å¼ºåˆ¶ schema&lt;/li>
&lt;li>æ›´é€‚åˆåµŒå¥—ç»“æ„å’Œéç»“æ„åŒ–æ•°æ®&lt;/li>
&lt;li>å†™å…¥ä¸æ‰©å±•æ€§èƒ½æ›´å¥½ï¼Œé€‚ç”¨äºå¿«é€Ÿè¿­ä»£å’Œæµ·é‡æ•°æ®åœºæ™¯&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>é€‰æ‹©ä½•ç§æ•°æ®æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹ä¸šåŠ¡éœ€æ±‚å’Œç³»ç»Ÿçº¦æŸä¹‹é—´åšå‡ºçš„æƒè¡¡ã€‚&lt;/p>
&lt;h3 id="æ•°æ®ç¼–ç ">æ•°æ®ç¼–ç  &lt;a href="#%e6%95%b0%e6%8d%ae%e7%bc%96%e7%a0%81" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨å†…å­˜ä¸­ï¼Œæˆ‘ä»¬å€¾å‘äºä½¿ç”¨é“¾è¡¨ã€å“ˆå¸Œè¡¨ã€æ ‘ç­‰ç»“æ„è¿›è¡Œå¿«é€Ÿè®¿é—®ã€‚ä½†åœ¨æŒä¹…åŒ–å­˜å‚¨å’Œç½‘ç»œä¼ è¾“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®ç¼–ç æˆ&lt;strong>ç´§å‡‘ä¸”ç»“æ„åŒ–çš„æ ¼å¼&lt;/strong>ï¼Œä»¥æé«˜è¯»å†™æ•ˆç‡ä¸å…¼å®¹æ€§ã€‚&lt;/p>
&lt;p>å¥½çš„æ•°æ®ç¼–ç æ ¼å¼éœ€è¦æƒè¡¡ä¸‰ä¸ªæ ¸å¿ƒæŒ‡æ ‡ï¼š&lt;/p>
&lt;ul>
&lt;li>å‘å‰å…¼å®¹æ€§ï¼šæ–°ç‰ˆæœ¬çš„ç³»ç»Ÿä»èƒ½è¯»å–æ—§æ ¼å¼çš„æ•°æ®ï¼›&lt;/li>
&lt;li>å‘åå…¼å®¹æ€§ï¼šæ—§ç‰ˆæœ¬çš„ç³»ç»Ÿèƒ½å¿½ç•¥æ–°æ•°æ®ä¸­çš„æœªçŸ¥å­—æ®µï¼Œæ­£å¸¸è¿è¡Œï¼›&lt;/li>
&lt;li>æ•ˆç‡ï¼šç¼–ç åçš„æ•°æ®å¤§å°ä¸ CPU è§£ç å¼€é”€ä¹‹é—´å–å¾—å¹³è¡¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¸¸è§çš„æ•°æ®ç¼–ç æ–¹æ¡ˆï¼š&lt;/p>
&lt;ul>
&lt;li>è¯­è¨€å†…ç½®æ ¼å¼ï¼ˆå¦‚ Python çš„ &lt;code>pickle&lt;/code>ã€Java çš„ &lt;code>Serializable&lt;/code>ï¼‰
&lt;ul>
&lt;li>ä¸è¯­è¨€ç´§è€¦åˆï¼Œç§»æ¤æ€§å·®&lt;/li>
&lt;li>ä¸æ”¯æŒæ•°æ®ç»“æ„æ¼”åŒ–&lt;/li>
&lt;li>ç¼–è§£ç æ•ˆç‡ä¸é«˜ï¼Œä¸å»ºè®®ç”¨äºè·¨ç³»ç»ŸæŒä¹…åŒ–æˆ–ç½‘ç»œä¼ è¾“&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ–‡æœ¬æ ¼å¼ï¼ˆå¦‚ CSVã€XMLã€JSONï¼‰
&lt;ul>
&lt;li>é€šç”¨ã€æ˜“è¯»ã€è°ƒè¯•å‹å¥½&lt;/li>
&lt;li>å‡ ä¹è¢«æ‰€æœ‰ç¼–ç¨‹è¯­è¨€æ”¯æŒ&lt;/li>
&lt;li>å­˜åœ¨å¤§é‡å†—ä½™ï¼ˆå¦‚é”®åé‡å¤ï¼‰ï¼Œä¸é€‚åˆé«˜æ•ˆå­˜å‚¨æˆ–ä¼ è¾“&lt;/li>
&lt;li>ä¸é€‚åˆåµŒå¥—ç»“æ„æˆ–äºŒè¿›åˆ¶æ•°æ®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>äºŒè¿›åˆ¶æ ¼å¼ï¼ˆå¦‚ Protobufã€Thriftã€Avroï¼‰
&lt;ul>
&lt;li>é«˜åº¦ç´§å‡‘ï¼Œæ”¯æŒåµŒå¥—ä¸å¤æ‚ç»“æ„&lt;/li>
&lt;li>æ”¯æŒæ•°æ®æ¼”åŒ–ï¼Œå…¼å®¹æ€§å¥½&lt;/li>
&lt;li>ç¼–è§£ç æ€§èƒ½é«˜ï¼Œä½†ä¸æ˜“è°ƒè¯•ï¼ˆéœ€å·¥å…·æŸ¥çœ‹ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>åœ¨æ„å»ºæ•°æ®å¯†é›†å‹ç³»ç»Ÿæ—¶ï¼Œ&lt;strong>æ¨¡å‹ä¸ç¼–ç çš„é€‰æ‹©å¾€å¾€å½±å“æ·±è¿œï¼Œä¸”éš¾ä»¥éšæ„æ›´æ”¹&lt;/strong>ï¼ŒåŠ¡å¿…æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ…é‡é€‰æ‹©ã€‚&lt;/p>
&lt;h2 id="æ•°æ®æ£€ç´¢">æ•°æ®æ£€ç´¢ &lt;a href="#%e6%95%b0%e6%8d%ae%e6%a3%80%e7%b4%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="äº‹åŠ¡å¤„ç†ç³»ç»Ÿoltpä¸­çš„ç´¢å¼•ç»“æ„">äº‹åŠ¡å¤„ç†ç³»ç»Ÿï¼ˆOLTPï¼‰ä¸­çš„ç´¢å¼•ç»“æ„ &lt;a href="#%e4%ba%8b%e5%8a%a1%e5%a4%84%e7%90%86%e7%b3%bb%e7%bb%9foltp%e4%b8%ad%e7%9a%84%e7%b4%a2%e5%bc%95%e7%bb%93%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>OLTPï¼ˆåœ¨çº¿äº‹åŠ¡å¤„ç†ï¼‰ç³»ç»Ÿä¸»è¦å¤„ç†é«˜å¹¶å‘ã€å®æ—¶è¯»å†™è¯·æ±‚ï¼Œå› æ­¤å¯¹å»¶è¿Ÿæåº¦æ•æ„Ÿã€‚å¸¸è§çš„ç´¢å¼•ç»“æ„æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>å“ˆå¸Œè¡¨ï¼šç”¨äºå¿«é€Ÿé”®å€¼å¯¹æ£€ç´¢ï¼Œç»“æ„ç®€å•ï¼Œæ€§èƒ½é«˜ï¼›&lt;/li>
&lt;li>LSM-Treeï¼šå¤šå±‚å·²æ’åºæ•°ç»„ç»“æ„ï¼Œå†™å…¥å¿«ï¼Œé€‚åˆå†™å¤šè¯»å°‘åœºæ™¯ï¼›&lt;/li>
&lt;li>B-Treeï¼šå¤šå‰å¹³è¡¡æ’åºæ ‘ï¼Œé€‚åˆè¯»å†™æ··åˆåœºæ™¯ï¼Œæ˜¯å¤šæ•°æ•°æ®åº“çš„é»˜è®¤ç´¢å¼•ç±»å‹ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="æ•°æ®åˆ†æç³»ç»Ÿolapä¸­çš„ç´¢å¼•ç»“æ„">æ•°æ®åˆ†æç³»ç»Ÿï¼ˆOLAPï¼‰ä¸­çš„ç´¢å¼•ç»“æ„ &lt;a href="#%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90%e7%b3%bb%e7%bb%9folap%e4%b8%ad%e7%9a%84%e7%b4%a2%e5%bc%95%e7%bb%93%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>OLAPï¼ˆåœ¨çº¿åˆ†æå¤„ç†ï¼‰ç³»ç»Ÿç”¨äºå¤„ç†å¤§è§„æ¨¡ç¦»çº¿æ•°æ®ä»»åŠ¡ï¼Œå…³æ³¨çš„æ˜¯æ•´ä½“ååè€Œéå•æ¬¡è¯·æ±‚çš„å“åº”å»¶è¿Ÿã€‚&lt;/p>
&lt;h4 id="äº‹å®è¡¨ä¸åˆ—å¼å­˜å‚¨">äº‹å®è¡¨ä¸åˆ—å¼å­˜å‚¨ &lt;a href="#%e4%ba%8b%e5%ae%9e%e8%a1%a8%e4%b8%8e%e5%88%97%e5%bc%8f%e5%ad%98%e5%82%a8" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åœ¨æ•°æ®ä»“åº“ä¸­ï¼Œäº‹å®è¡¨è®°å½•æ¯ä¸€æ¡äº‹ä»¶æ•°æ®ï¼Œé€šå¸¸æœ‰å¾ˆå¤šåˆ—æ¥è¡¨ç¤ºä¸åŒç»´åº¦ã€‚è™½ç„¶é€»è¾‘ä¸ŠæŒ‰è¡Œå­˜å‚¨ï¼Œä½†ç‰©ç†ä¸Šé‡‡ç”¨åˆ—å¼å­˜å‚¨æ›´ä¸ºé«˜æ•ˆï¼š&lt;/p>
&lt;ul>
&lt;li>æŸ¥è¯¢åªéœ€è¯»å–å¿…è¦çš„åˆ—ï¼ŒI/Oæ›´å°‘ï¼›&lt;/li>
&lt;li>åŒä¸€åˆ—æ•°æ®åˆ†å¸ƒç›¸ä¼¼ï¼Œå‹ç¼©ç‡æ›´é«˜ï¼›&lt;/li>
&lt;li>åˆ—å¼å¸ƒå±€æ›´åˆ©äºå‘é‡åŒ–è®¡ç®—å’Œå¹¶è¡Œå¤„ç†ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å°ç»“">å°ç»“ &lt;a href="#%e5%b0%8f%e7%bb%93" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä»æ¨¡å‹ã€ç¼–ç åˆ°æ£€ç´¢ï¼Œæ•°æ®ç³»ç»Ÿçš„åŸºç¡€æ„æˆå…¶å®å›´ç»•ç€ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜å±•å¼€ï¼šæˆ‘ä»¬å¦‚ä½•é«˜æ•ˆã€å¯é åœ°ç»„ç»‡ã€ä¿å­˜ä¸ä½¿ç”¨æ•°æ®ã€‚&lt;/p>
&lt;ul>
&lt;li>æ•°æ®æ¨¡å‹å†³å®šäº†æˆ‘ä»¬å¦‚ä½•æŠ½è±¡ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©ä¸å…³ç³»ï¼›&lt;/li>
&lt;li>æ•°æ®ç¼–ç å†³å®šäº†æˆ‘ä»¬å¦‚ä½•åœ¨ç³»ç»Ÿä¹‹é—´ä¼ é€’å’ŒæŒä¹…åŒ–è¿™äº›æŠ½è±¡ï¼›&lt;/li>
&lt;li>æ•°æ®æ£€ç´¢ç»“æ„åˆ™å†³å®šäº†æˆ‘ä»¬å¦‚ä½•ä»¥å°½å¯èƒ½ä½çš„å¼€é”€è·å¾—æ‰€éœ€ä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;p>ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ¢è®¨åˆ†å¸ƒå¼æ—¥å¿—ã€å¤åˆ¶æœºåˆ¶å’Œä¸€è‡´æ€§åè®®åœ¨æ•°æ®ç³»ç»Ÿä¸­çš„è§’è‰²ä¸å®è·µ â€”â€” å¸Œæœ›èƒ½æœ‰ä¸‹ä¸€ç¯‡ã€‚&lt;/p></description></item><item><title>6.824 Lab 2: Raftåè®®å®ç°æŒ‡å— ï¼ˆæ— å‰§é€ç‰ˆï¼‰</title><link>https://wizmann.top/posts/raft-lab-mit-6.824/</link><pubDate>Thu, 02 May 2019 21:33:00 +0000</pubDate><guid>https://wizmann.top/posts/raft-lab-mit-6.824/</guid><description>&lt;h2 id="èƒŒæ™¯">èƒŒæ™¯ &lt;a href="#%e8%83%8c%e6%99%af" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>MIT6.824æ˜¯ä¸€ä¸ªç”¨æ¥å­¦ä¹ åˆ†å¸ƒå¼ç³»ç»Ÿçš„éå¸¸å¥½çš„èµ„æºã€‚å…¶ä¸­ç¬¬äºŒä¸ªè¯¾ç¨‹ä½œä¸šå°±æ˜¯å…³äº&lt;a href="https://pdos.csail.mit.edu/6.824/labs/lab-raft.html">Raftç®—æ³•&lt;/a>ã€‚&lt;/p>
&lt;p>ç”±äºåœ¨å·¥ä½œä¸­æ¶‰åŠåˆ°åˆ†å¸ƒä¸€è‡´æ€§ç®—æ³•çš„è°ƒç ”ï¼Œæ¥è§¦äº†paxos/raftç®—æ³•ã€‚ç„¶åè¢«@neutronestå®‰åˆ©äº†ä¸€å‘ï¼Œäºæ˜¯å¼€å§‹ç€æ‰‹å®ç°è¿™ä¸ªä½œä¸šã€‚&lt;/p>
&lt;p>æœ¬æ–‡æ˜¯æˆ‘å¯¹è¿™ä¸ªé¡¹ç›®çš„å®ç°æ€»ç»“ã€‚å¸Œæœ›èƒ½åœ¨åˆ’å‡ºé‡ç‚¹çš„åŒæ—¶ï¼Œä¸æ¶‰åŠå®ç°ç»†èŠ‚ï¼Œé¿å…ç ´åå¤§å®¶çš„å†™ä»£ç ä½“éªŒã€‚&lt;/p>
&lt;p>æœ¬æ–‡å”¯ä¸€å‚è€ƒèµ„æ–™ï¼š&lt;a href="https://raft.github.io/raft.pdf">In Search of an Understandable Consensus Algorithm&lt;/a>&lt;/p>
&lt;h2 id="ä»»åŠ¡åˆ†è§£">ä»»åŠ¡åˆ†è§£ &lt;a href="#%e4%bb%bb%e5%8a%a1%e5%88%86%e8%a7%a3" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åœ¨å®˜æ–¹æ–‡æ¡£é‡Œï¼Œæ•´ä¸ªé¡¹ç›®è¢«åˆ†æˆäº†2Aã€2Bã€2Cä¸‰ä¸ªéƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>2A - æŠ•ç¥¨ä¸é€‰ä¸¾&lt;/li>
&lt;li>2B - ä¸€è‡´æ€§&lt;/li>
&lt;li>2C - å¯æŒä¹…åŒ–&lt;/li>
&lt;/ul>
&lt;p>å®é™…ä¸Šï¼Œ2Cçš„å·¥ä½œé‡éå¸¸å°‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ2Bå’Œ2Cåˆæˆä¸€ä¸ªã€‚ç„¶åå•ç‹¬æå‡ºå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåˆ’åˆ†æˆå­é¡¹ç›®ã€‚ä»»åŠ¡åˆ†è§£å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>2A - æŠ•ç¥¨ä¸é€‰ä¸¾&lt;/li>
&lt;li>2B/2C - ä¸€è‡´æ€§å’Œå¯æŒä¹…åŒ–&lt;/li>
&lt;li>ä¸‰ä¸ªéš¾åº¦æ¯”è¾ƒé«˜çš„Case
&lt;ul>
&lt;li>Test (2B): leader backs up quickly over incorrect follower logs &lt;br>
éªŒè¯åè®®å®ç°çš„æ­£ç¡®æ€§&lt;/li>
&lt;li>Test (2B): RPC counts aren&amp;rsquo;t too high &lt;br>
æµ‹è¯•åè®®æ˜¯å¦äº§ç”Ÿäº†è¿‡å¤šçš„RPCè¯·æ±‚ã€‚éªŒè¯åè®®çš„æ€§èƒ½ã€‚&lt;/li>
&lt;li>Test (2C): Figure 8 (unreliable) &lt;br>
æµ‹è¯•åœ¨æç«¯æ··ä¹±çš„æƒ…å†µä¸‹ï¼ŒRaftåè®®æ˜¯å¦èƒ½åŠæ—¶æ¢å¤æ­£å¸¸å·¥ä½œã€‚éªŒè¯åè®®å®ç°çš„æ­£ç¡®æ€§å’Œæ€§èƒ½ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥æ¨èå¤§å®¶æŒ‰é¡ºåºä»¥ä¸Šé¡ºåºè¿›è¡Œå®ç°ã€‚å¹¶ä¸”å……åˆ†åˆ©ç”¨ç‰ˆæœ¬æ§åˆ¶å¯¹ä»£ç è¿›è¡Œå¼€å‘å’Œé‡æ„ã€‚&lt;/p>
&lt;h2 id="éœ€è¦å…³æ³¨çš„çŸ¥è¯†ç‚¹">éœ€è¦å…³æ³¨çš„çŸ¥è¯†ç‚¹ &lt;a href="#%e9%9c%80%e8%a6%81%e5%85%b3%e6%b3%a8%e7%9a%84%e7%9f%a5%e8%af%86%e7%82%b9" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä»¥ä¸‹ä¼šä»‹ç»æ¯ä¸€ä¸ªéƒ¨åˆ†éœ€è¦é‡ç‚¹å…³æ³¨çš„çŸ¥è¯†ç‚¹ï¼Œå†…å®¹åŒ…æ‹¬golangåŸºç¡€å’Œè®ºæ–‡ä¸­çš„çŸ¥è¯†ç‚¹ï¼Œæ— å‰§é€ï¼Œè¯·æ”¾å¿ƒé£Ÿç”¨ã€‚&lt;/p>
&lt;h3 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ &lt;a href="#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>golangæ˜¯ä¸€é—¨å‚²æ…¢çš„è¯­è¨€ï¼Œå…¶æ ‡å‡†åº“çš„ç¼ºä¹å®åœ¨æ˜¯è®©äººæ„Ÿåˆ°TMDè›‹ç–¼ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªè¯¾ç¨‹ä½œä¸šæ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰å¿…è¦å¼•å…¥ä¸€ç³»åˆ—ç¬¬ä¸‰æ–¹åº“ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆè¦æ‰©å……&lt;code>util.go&lt;/code>æ–‡ä»¶ï¼Œä½¿å…¶ä¸ºæˆ‘ä»¬çš„å¼€å‘æä¾›æ›´å¤šçš„ä¾¿åˆ©ã€‚&lt;/p>
&lt;h4 id="logæ¨¡å—">Logæ¨¡å— &lt;a href="#log%e6%a8%a1%e5%9d%97" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>é¡¹ç›®ç»™å‡ºçš„&lt;code>DPrintf&lt;/code>å‡½æ•°éå¸¸ç®€å•ï¼Œåªæä¾›äº†ä¸€ä¸ª&lt;code>fmt.Printf&lt;/code>çš„å°è£…ã€‚å¹¶ä¸èƒ½æ‰“å°è¡Œå·å’Œæ–‡ä»¶åã€‚è¿™é‡Œæä¾›ä¸€ä¸ªæ‰©å±•ç‰ˆæœ¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">DPrintf&lt;/span>(&lt;span style="color:#a6e22e">format&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#66d9ef">interface&lt;/span>{}) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">Debug&lt;/span> &amp;gt; &lt;span style="color:#ae81ff">0&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">path&lt;/span>, &lt;span style="color:#a6e22e">lineno&lt;/span>, &lt;span style="color:#a6e22e">ok&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">runtime&lt;/span>.&lt;span style="color:#a6e22e">Caller&lt;/span>(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">filepath&lt;/span>.&lt;span style="color:#a6e22e">Split&lt;/span>(&lt;span style="color:#a6e22e">path&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">ok&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Now&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">a&lt;/span> = append([]&lt;span style="color:#66d9ef">interface&lt;/span>{} { &lt;span style="color:#a6e22e">t&lt;/span>.&lt;span style="color:#a6e22e">Format&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;2006-01-02 15:04:05.00&amp;#34;&lt;/span>), &lt;span style="color:#a6e22e">file&lt;/span>, &lt;span style="color:#a6e22e">lineno&lt;/span> }, &lt;span style="color:#a6e22e">a&lt;/span>&lt;span style="color:#f92672">...&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Printf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;%s [%s:%d] &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">format&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span>&lt;span style="color:#f92672">...&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶è¾“å‡ºç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>2019-05-02 09:28:35.04 [raft.go:652] Node[1] is processing, state: [LEADER], term 1, commitIndex: 12, logCount: 12, leader 1
&lt;/code>&lt;/pre>&lt;h4 id="maxå’Œminå‡½æ•°">Maxå’ŒMinå‡½æ•° &lt;a href="#max%e5%92%8cmin%e5%87%bd%e6%95%b0" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>golangæ˜¯æ²¡æœ‰å¯¹äºintå€¼çš„&lt;code>max&lt;/code>å’Œ&lt;code>min&lt;/code>å‡½æ•°çš„ï¼Œè¿™é‡Œçœç•¥è„è¯100å¥ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">Min&lt;/span>(&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>, &lt;span style="color:#a6e22e">b&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>) (&lt;span style="color:#66d9ef">int&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span> &amp;lt; &lt;span style="color:#a6e22e">b&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">b&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">Max&lt;/span>(&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>, &lt;span style="color:#a6e22e">b&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>) (&lt;span style="color:#66d9ef">int&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span> &amp;gt; &lt;span style="color:#a6e22e">b&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">b&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="assertå‡½æ•°">Assertå‡½æ•° &lt;a href="#assert%e5%87%bd%e6%95%b0" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æ˜¯çš„ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼Œgolangä¹Ÿæ²¡æœ‰æä¾›&lt;code>assert&lt;/code>å‡½æ•°ã€‚å¦‚æœä½ å«Œåˆ°å¤„å†™&lt;code>if&lt;/code>å’Œ&lt;code>panic&lt;/code>å¤ªä¸‘çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ª&lt;code>assert&lt;/code>å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">Assert&lt;/span>(&lt;span style="color:#a6e22e">flag&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span>, &lt;span style="color:#a6e22e">format&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#66d9ef">interface&lt;/span>{}) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (!&lt;span style="color:#a6e22e">flag&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">path&lt;/span>, &lt;span style="color:#a6e22e">lineno&lt;/span>, &lt;span style="color:#a6e22e">ok&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">runtime&lt;/span>.&lt;span style="color:#a6e22e">Caller&lt;/span>(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">filepath&lt;/span>.&lt;span style="color:#a6e22e">Split&lt;/span>(&lt;span style="color:#a6e22e">path&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">ok&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Now&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">a&lt;/span> = append([]&lt;span style="color:#66d9ef">interface&lt;/span>{} { &lt;span style="color:#a6e22e">t&lt;/span>.&lt;span style="color:#a6e22e">Format&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;2006-01-02 15:04:05.00&amp;#34;&lt;/span>), &lt;span style="color:#a6e22e">file&lt;/span>, &lt;span style="color:#a6e22e">lineno&lt;/span> }, &lt;span style="color:#a6e22e">a&lt;/span>&lt;span style="color:#f92672">...&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">reason&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Sprintf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;%s [%s:%d] &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">format&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span>&lt;span style="color:#f92672">...&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> panic(&lt;span style="color:#a6e22e">reason&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> panic(&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="log-id">Log Id &lt;a href="#log-id" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>ä¸ºäº†éªŒè¯æ—¥å¿—çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬åœ¨æ—¥å¿—ä¸­é¢å¤–åŠ å…¥ä¸€ä¸ªUUIDæ¥è¿›è¡Œæ ‡è¯†ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>import &amp;#34;math/rand&amp;#34;
func CreateLogId() (uuid string) {
b := make([]byte, 16)
_, err := rand.Read(b)
if err != nil {
fmt.Println(&amp;#34;Error: &amp;#34;, err)
return
}
uuid = fmt.Sprintf(&amp;#34;%X-%X-%X-%X-%X&amp;#34;, b[0:4], b[4:6], b[6:8], b[8:10], b[10:])
return uuid
}
&lt;/code>&lt;/pre>&lt;p>ä»¥ä¸Šä»£ç å¯ä»¥ç”Ÿæˆä¸€ä¸ªï¼ˆä¼ªï¼‰UUIDå¯¹æ—¥å¿—è¿›è¡Œæ ‡è¯†ã€‚æ¨èä½¿ç”¨&lt;code>math/rand&lt;/code>ï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¼ªéšæœºæ•°å°±å¤Ÿäº†ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ³¨ï¼šè¿™é‡Œçš„UUIDåªæ˜¯çœ‹èµ·æ¥åƒä¸€ä¸ªUUIDï¼Œå®é™…ä¸ŠUUIDæœ‰å…¶ç‰¹æ®Šçš„è§„èŒƒä¸æ ¼å¼ã€‚ä½†æ˜¯ç”±äºgolangå†…éƒ¨æ²¡æœ‰æä¾›å¯ç”¨çš„UUIDåº“ï¼Œæ‰€ä»¥åªå¥½éšæ‰‹æ¨¡æ‹Ÿäº†ä¸€ä¸ªã€‚&lt;/p>&lt;/blockquote>
&lt;h4 id="æ–‡ä»¶ç»„ç»‡">æ–‡ä»¶ç»„ç»‡ &lt;a href="#%e6%96%87%e4%bb%b6%e7%bb%84%e7%bb%87" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>é»˜è®¤çš„å®ç°æ˜¯æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½å†™åˆ°äº†&lt;code>raft.go&lt;/code>æ–‡ä»¶é‡Œã€‚ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶å¯èƒ½ä¼šç»™æˆ‘ä»¬çš„å¼€å‘å¸¦æ¥è´Ÿæ‹…ï¼Œæ‰€ä»¥æˆ‘çš„åšæ³•æ˜¯æŠŠæ‰€æœ‰çš„ç±»å£°æ˜æ”¾åˆ°&lt;code>models.go&lt;/code>æ–‡ä»¶é‡Œã€‚ä»¥é¿å…æ–‡ä»¶çš„è†¨èƒ€ã€‚&lt;/p>
&lt;h4 id="é”ä¸defer">é”ä¸defer &lt;a href="#%e9%94%81%e4%b8%8edefer" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åœ¨raftå®ç°ä¸­ï¼Œé”å¯ä»¥ç”¨æ¥ä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•°æ®çš„æ­£ç¡®æ€§ã€‚æ‰€ä»¥åªè¦åœ¨æ¶‰åŠåˆ°raftå†…éƒ¨çŠ¶æ€çš„å˜åŒ–æ—¶ï¼Œéƒ½éœ€è¦åŠ é”ã€‚ä¸€ä¸ªå¸¸è§çš„åŠ é”patternæ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">mu&lt;/span>.&lt;span style="color:#a6e22e">Lock&lt;/span>() &lt;span style="color:#75715e">// åŠ é”&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">defer&lt;/span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">mu&lt;/span>.&lt;span style="color:#a6e22e">Lock&lt;/span>() &lt;span style="color:#75715e">// åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆåè§£é”&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œæ¨èä½¿ç”¨deferï¼Œå› ä¸ºæ‰‹åŠ¨æ§åˆ¶é”å®ç°æ˜¯è¿‡äºå®¹æ˜“å‡ºé”™ã€‚ä½†æ˜¯deferä¹Ÿæ˜¯æœ‰å‘çš„ï¼&lt;/p>
&lt;p>ä¸åŒäºC++çš„å¤§æ‹¬å·ä½œç”¨åŸŸï¼Œdeferçš„è§¦å‘æ—¶é—´æ˜¯åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åï¼Œè€Œå¹¶ä¸æ˜¯é€€å‡ºå½“å‰å¤§æ‹¬å·æ—¶ã€‚è¿™ç‚¹éå¸¸éœ€è¦æ³¨æ„ï¼Œå¦åˆ™ææ˜“å‡ºç°æ­»é”ã€‚&lt;/p>
&lt;p>å¦‚æœæˆ‘ä»¬æƒ³å®ç°C++ä¸­&lt;code>do { ... } while (0);&lt;/code>ç±»ä¼¼çš„lock guard patternï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">mu&lt;/span>.&lt;span style="color:#a6e22e">Lock&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">defer&lt;/span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">mu&lt;/span>.&lt;span style="color:#a6e22e">Unlock&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// do something here&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·ä¸€æ¥ï¼Œåœ¨æ‰§è¡Œå®Œå½“å‰lambdaä¹‹åï¼Œå°±ä¼šè‡ªåŠ¨è§£é”ã€‚&lt;/p>
&lt;h4 id="åˆ·æ–°å®šæ—¶å™¨">åˆ·æ–°å®šæ—¶å™¨ &lt;a href="#%e5%88%b7%e6%96%b0%e5%ae%9a%e6%97%b6%e5%99%a8" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>ç”±äºraftç®—æ³•é‡Œé¢ä½¿ç”¨äº†å®šæ—¶å™¨ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªåˆ·æ–°å®šæ—¶å™¨çš„golangä»£ç ã€‚è¿™æ ·å®ç°æ˜¯ä¸ºäº†æ¯æ¬¡åœ¨åˆ·æ–°çš„æ—¶å€™ï¼Œæ¸…ç©ºå®šæ—¶å™¨ä¸­åŸæœ‰çš„è¶…æ—¶æ—¶é—´ï¼Œä»¥é¿å…æ··ä¹±ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-golang" data-lang="golang">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> (&lt;span style="color:#a6e22e">rf&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">Raft&lt;/span>) &lt;span style="color:#a6e22e">renewTimer&lt;/span>(&lt;span style="color:#a6e22e">timeout&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Duration&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">timer&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">timer&lt;/span> = &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">NewTimer&lt;/span>(&lt;span style="color:#a6e22e">timeout&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (!&lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">timer&lt;/span>.&lt;span style="color:#a6e22e">Stop&lt;/span>()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">select&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#f92672">&amp;lt;-&lt;/span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">timer&lt;/span>.&lt;span style="color:#a6e22e">C&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// pass&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// pass&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rf&lt;/span>.&lt;span style="color:#a6e22e">timer&lt;/span>.&lt;span style="color:#a6e22e">Reset&lt;/span>(&lt;span style="color:#a6e22e">timeout&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»¥åŠï¼Œåœ¨å®šæ—¶å™¨è¶…æ—¶ä¹‹åï¼Œä¸è¦å¿˜äº†æ›´æ–°å®šæ—¶å™¨ã€‚&lt;/p>
&lt;h3 id="2a---æŠ•ç¥¨ä¸é€‰ä¸¾">2A - æŠ•ç¥¨ä¸é€‰ä¸¾ &lt;a href="#2a---%e6%8a%95%e7%a5%a8%e4%b8%8e%e9%80%89%e4%b8%be" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="æ‰€éœ€è¦ç±»çš„å£°æ˜">æ‰€éœ€è¦ç±»çš„å£°æ˜ &lt;a href="#%e6%89%80%e9%9c%80%e8%a6%81%e7%b1%bb%e7%9a%84%e5%a3%b0%e6%98%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>è®ºæ–‡ä¸­çš„&lt;code>Figure2&lt;/code>åŒ…å«äº†ç®—æ³•ä¸­æ‰€æœ‰çš„ç±»ä»¥åŠåŸºæœ¬ç®—æ³•ã€‚åœ¨2Aä¸­ï¼Œæ‰€æœ‰çš„ç±»éƒ½ä¼šè¢«ç”¨åˆ°ã€‚ç”±äº2Aä¸­åªåŒ…æ‹¬æŠ•ç¥¨ä¸é€‰ä¸¾ï¼Œæ‰€ä»¥å’Œæ—¥å¿—ç›¸å…³çš„å­—æ®µå¯ä»¥å…ˆå¿½ç•¥æ‰ã€‚&lt;/p>
&lt;h4 id="checklist-for-2a">Checklist for 2A &lt;a href="#checklist-for-2a" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;ul>
&lt;li>å®ç°raftçŠ¶æ€æœºçš„ä¸‰ä¸ªçŠ¶æ€ï¼šleaderï¼Œfollowerå’Œcandidate&lt;/li>
&lt;li>å®ç°RPCå‡½æ•°ï¼š&lt;code>sendRequestVote&lt;/code>ï¼ˆå‘é€ç«¯ï¼‰å’Œ&lt;code>RequestVote&lt;/code>ï¼ˆæ¥æ”¶ç«¯çš„å›è°ƒå‡½æ•°ï¼‰&lt;/li>
&lt;li>å®ç°RPCå‡½æ•°ï¼š&lt;code>sendAppendEntries&lt;/code>ï¼ˆå‘é€ç«¯ï¼‰å’Œ&lt;code>AppendEntries&lt;/code>ï¼ˆæ¥æ”¶ç«¯çš„å›è°ƒå‡½æ•°ï¼‰&lt;/li>
&lt;li>ä¿è¯raftçŠ¶æ€æœºçš„ä»»æœŸå·ï¼ˆ&lt;code>currentTerm&lt;/code>ï¼‰æ˜¯å•è°ƒé€’å¢çš„&lt;/li>
&lt;li>ä¸€ä¸ªFollowerå¯¹äºæŸä¸€ä¸ªTermåªèƒ½æŠ•å‡ºä¸€ç¥¨&lt;/li>
&lt;li>å®ç°Leaderå¿ƒè·³ï¼Œç»´æŠ¤å½“å‰ä»»æœŸï¼ˆTermï¼‰ã€‚&lt;/li>
&lt;li>å®ç°Followeré€‰ä¸¾è¶…æ—¶ï¼ˆelection timeoutï¼‰&lt;/li>
&lt;li>å®ç°Candidateé€‰ä¸¾çš„ä¸‰ç§åœºæ™¯
&lt;ul>
&lt;li>è·å¾—å¤šæ•°é€‰ç¥¨ï¼Œèµ¢å¾—é€‰ä¸¾ã€‚çŠ¶æ€åˆ‡æ¢ä¸ºLeader&lt;/li>
&lt;li>å…¶å®ƒçš„èŠ‚ç‚¹å·²ç»è¢«é€‰ä¸ºLeaderã€‚çŠ¶æ€åˆ‡æ¢ä¸ºFollower&lt;/li>
&lt;li>åœ¨é€‰ä¸¾ä¸­å¹¶æœªè·å¾—å¤šæ•°é€‰ç¥¨ï¼ŒçŠ¶æ€åˆ‡æ¢ä¸ºFollower&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å®ç°Candidateéšæœºé€‰ä¸¾è¶…æ—¶ï¼ˆrandomized election timeoutï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="2b2c---æ—¥å¿—å¤åˆ¶ä¸æŒä¹…åŒ–">2B/2C - æ—¥å¿—å¤åˆ¶ä¸æŒä¹…åŒ– &lt;a href="#2b2c---%e6%97%a5%e5%bf%97%e5%a4%8d%e5%88%b6%e4%b8%8e%e6%8c%81%e4%b9%85%e5%8c%96" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="åŸºæœ¬å·¥ä½œæµ">åŸºæœ¬å·¥ä½œæµ &lt;a href="#%e5%9f%ba%e6%9c%ac%e5%b7%a5%e4%bd%9c%e6%b5%81" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æ—¥å¿—å¤åˆ¶çš„åŸºæœ¬å·¥ä½œæµå¦‚ä¸‹ï¼š&lt;/p>
&lt;p>Leaderæ¥å—ç”¨æˆ·è¯·æ±‚ï¼Œå°†çŠ¶æ€å˜åŒ–å†™å…¥æœ¬æœºçš„æ—¥å¿—æµä¸­ï¼Œå¹¶ä¸”æŠŠæ—¥å¿—å¤åˆ¶åˆ°Followersã€‚å¦‚æœæœ¬æ¡æ—¥å¿—åˆæ³•ï¼ŒFollowersä¼šå°†è¿™æ¡æ—¥å¿—æ ‡è®°ä¸ºâ€œæäº¤â€ï¼ˆcommittedï¼‰ï¼Œç„¶åå†å°†è¿™æ¡æ—¥å¿—â€œåº”ç”¨â€ï¼ˆapplyï¼‰åˆ°Raftåè®®ä¹‹å¤–çš„çŠ¶æ€æœºã€‚Followeråœ¨æäº¤æ—¥å¿—ä¹‹åï¼Œå°±å¯ä»¥å‘Leaderå›æŠ¥è¿™æ¡æ—¥å¿—å·²ç»è¢«æäº¤ã€‚åœ¨æœ¬æ¡æ—¥å¿—è¢«å¤šæ•°èŠ‚ç‚¹æäº¤ä¹‹åï¼ŒLeaderå†å°†è¿™æ¡æ—¥å¿—æ ‡è®°ä¸ºæäº¤ã€‚æ­¤æ—¶ï¼Œç”¨æˆ·çš„è¯·æ±‚å°±å¯ä»¥è¢«ç¡®è®¤ï¼ˆACKï¼‰äº†ã€‚&lt;/p>
&lt;p>Raftçš„è®ºæ–‡ä¸­ï¼ŒLeaderéœ€è¦ç»´æŠ¤&lt;code>commitIndex&lt;/code>å’Œ&lt;code>lastApplied&lt;/code>è¿™ä¸¤ä¸ªçŠ¶æ€ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥â€œåº”ç”¨â€ï¼ˆapplyï¼‰è¿™ä¸ªè¿‡ç¨‹ã€‚è¿™ä¸¤ä¸ªçŠ¶æ€æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤&lt;code>commitIndex&lt;/code>å³å¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Raftåè®®ä¸æ˜¯2PCï¼Œåƒä¸‡ä¸è¦ææ··äº†å“¦ï½&lt;/p>&lt;/blockquote>
&lt;h4 id="å›æ»šä¸æ»šå›æ¥">å›æ»šä¸æ»šå›æ¥ &lt;a href="#%e5%9b%9e%e6%bb%9a%e4%b8%8e%e6%bb%9a%e5%9b%9e%e6%9d%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/3f1056d6f142755204092fb89a474dc964608bab/wizmann-pic/2019-05-02_14-40-52.png" alt="rollback">&lt;/p>
&lt;p>ä»ä¸Šé¢çš„å·¥ä½œæµæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºå·²ç»committedçš„æ—¥å¿—ï¼Œä»ç„¶æœ‰å¯èƒ½æ˜¯ä¸å¯é çš„ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œåœ¨Term1æ—¶ï¼ŒèŠ‚ç‚¹1ä½œä¸šLeaderæäº¤åˆ°äº†æ—¥å¿—(1, 2)ï¼Œè€ŒFollowerèŠ‚ç‚¹Node2å’ŒNode3åˆ†åˆ«æäº¤åˆ°äº†æ—¥å¿—(1, 2)å’Œ(1, 3)ã€‚æ­¤æ—¶LeaderçŸ­æš‚æ–­çº¿ï¼Œå‡ºå‘é€‰ä¸¾è¶…æ—¶ï¼Œå°±ä¼šè¿›è¡Œä¸‹ä¸€è½®çš„é€‰ä¸¾ã€‚å¦‚æœèŠ‚ç‚¹Node2è¢«é€‰ä¸ºLeaderï¼Œé‚£ä¹ˆèŠ‚ç‚¹Node3å°±ä¼šè¢«Leaderå¤šå‡ºä¸€æ¡æ—¥å¿—ï¼Œè¿™æ˜¯ä¸è¢«å…è®¸çš„ã€‚å¦‚æœèŠ‚ç‚¹Node3è¢«é€‰ä¸ºLeaderï¼Œé‚£ä¹ˆNode2å°±æ¯”Leaderåœ¨Term1å°‘ä¸€æ¡æ—¥å¿—ï¼Œéœ€è¦è¡¥é½ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œæœ‰äººå¯èƒ½ä¼šæ€€ç–‘ï¼ŒèŠ‚ç‚¹2æ¯”èŠ‚ç‚¹3å°‘ä¸€æ¡æ—¥å¿—ï¼Œé‚£ä¹ˆæŒ‰ç…§è®ºæ–‡é‡Œçš„è¯´æ³•ï¼Œå› ä¸ºèŠ‚ç‚¹3çš„æ—¥å¿—æ¯”è¾ƒèŠ‚ç‚¹2è¦å¤šï¼Œæ‰€ä»¥åªæœ‰èŠ‚ç‚¹3æ‰èƒ½èµ¢å¾—ä¸‹ä¸€è½®é€‰ä¸¾ã€‚è¿™å…¶å®æ˜¯ä¸å¯¹çš„ï¼Œå¦‚æœèŠ‚ç‚¹3æ–­çº¿ï¼ŒèŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2ä»ç„¶å¯ä»¥ç»„æˆä¸€ä¸ªquorumï¼Œé€‰ä¸¾å‡ºLeaderã€‚&lt;/p>&lt;/blockquote>
&lt;p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦è€ƒè™‘å°†å·²committedçš„æ—¥å¿—å›æ»šï¼ˆå‘å·¦æ»šï¼‰ï¼Œä»¥åŠç¼ºå¤±çš„æ—¥å¿—è¡¥é½ï¼ˆå‘å³æ»šï¼‰ã€‚è¿™é‡Œå…¶å®æœ‰ä¸€äº›ä¼˜åŒ–çš„ç‚¹ï¼Œæˆ‘ä»¬åæ–‡å†è¯´ã€‚&lt;/p>
&lt;p>å†æ¬¡æ³¨æ„ï¼Œä¿è¯æ—¥å¿—çš„ä¸€è‡´æ€§æ˜¯Raftåè®®æ­£ç¡®æ€§çš„å¿…é¡»ä¿è¯ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šä¸€å®šè¦æ³¨æ„ã€‚&lt;/p>
&lt;h4 id="ä¹±åºè¯·æ±‚">ä¹±åºè¯·æ±‚ &lt;a href="#%e4%b9%b1%e5%ba%8f%e8%af%b7%e6%b1%82" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æœ¬é¡¹ç›®ä¸­ï¼Œæ¨¡æ‹Ÿçš„RPCåè®®å¹¶ä¸èƒ½ä¿è¯å¯é æ€§ï¼ˆä¼šä¸¢åŒ…ï¼‰ã€æœ‰åºæ€§ï¼ˆä¼šä¹±åºï¼‰ï¼Œä¹Ÿæ²¡æœ‰SLAï¼ˆæ²¡æœ‰è¶…æ—¶æ—¶é—´çš„ä¸Šé™ï¼‰ï¼Œæ›´ä¸ç”¨æƒ³æ‹¥å¡æ§åˆ¶ã€‚æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå®ƒåœ¨åº•å±‚ä½¿ç”¨äº†UDPåè®®ï¼Œè€Œä¸æ˜¯TCPã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åšå‡ºä»»ä½•å‡è®¾ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œä¸¤ä¸ªè¯·æ±‚å…ˆåæ¥åˆ°Leaderç«¯ï¼ŒAè¯·æ±‚ç¼–å·(1,100)ï¼ŒBè¯·æ±‚ç¼–å·(1,110)ã€‚ç„¶åæˆ‘ä»¬ä¾æ¬¡å°†Logå¤åˆ¶åˆ°Followerç«¯ï¼ˆAå…ˆBåï¼‰ï¼Œä½†æ˜¯åœ¨Followerç«¯æœ‰å¯èƒ½æ”¶åˆ°çš„é¡ºåºæ˜¯Bå…ˆAåã€‚ç”šè‡³åªæ”¶åˆ°Bï¼Œæ²¡æ”¶åˆ°Aã€‚è¿™ç§æƒ…å†µæ—¥å¸¸å·¥ç¨‹ä¸­çš„TCPåè®®ä¸‹å‡ ä¹ä¸èƒ½å‘ç”Ÿï¼Œä½†æ˜¯åœ¨æµ‹è¯•ç¯å¢ƒä¸­è¦ååˆ†å°å¿ƒã€‚&lt;/p>
&lt;h4 id="checklist-for-2b2c">Checklist for 2B/2C &lt;a href="#checklist-for-2b2c" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;ul>
&lt;li>æ—¥å¿—çš„çŠ¶æ€ä¼šå½±å“Leaderé€‰ä¸¾ &lt;br>
å¦‚æœä¸¤ä»½æ—¥å¿—æµçš„æœ€åä¸€æ¡æ—¥å¿—çš„Termä¸ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºTermå·å¤§çš„æ—¥å¿—â€œæ¯”è¾ƒæ–°â€ã€‚å¦‚æœTermå·ä¸€æ ·ï¼Œé‚£ä¹ˆIndexå¤§çš„æ—¥å¿—â€œæ¯”è¾ƒæ–°â€&lt;/li>
&lt;li>å¦‚æœLeaderå’ŒFollowerçš„æ—¥å¿—ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆFolloweréœ€è¦æ‹·è´Leaderçš„æ—¥å¿—ï¼ˆå‘å·¦æ»šæˆ–å‘å³æ»šçš„æ­£ç¡®æ€§ï¼‰ &lt;br>
è¿™é‡Œæ¨èä½¿ç”¨AssertåŠ æ–­è¨€è¿›è¡Œä¿è¯ï¼Œå¦‚æœå‡ºé”™å¯ä»¥è·å¾—å®æ—¶çš„ç°åœº&lt;/li>
&lt;li>å¯¹äºå°äºå½“å‰Termçš„æ—¥å¿—ï¼ŒLeaderä¸éœ€è¦ç­‰å¤šæ•°Followerç¡®è®¤å°±å¯ä»¥ç›´æ¥commit&lt;/li>
&lt;li>ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼šå¦‚æœä¸¤ä¸ªæ—¥å¿—çš„(Term, Index)ä¸€è‡´ï¼Œé‚£ä¹ˆå…¶å†…å®¹ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚å¹¶ä¸”åœ¨æ­¤æ—¥å¿—ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—éƒ½å¿…é¡»æ˜¯ä¸€è‡´çš„&lt;/li>
&lt;li>å¦ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼šRPCè¯·æ±‚æ˜¯å¹‚ç­‰çš„ï¼Œä¹Ÿå°±æ˜¯å¤šæ¬¡é‡å¤å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶ä¸ä¼šç ´åRaftåè®®çš„çŠ¶æ€&lt;/li>
&lt;/ul>
&lt;h3 id="æœ€åçš„3ä¸ªcase">æœ€åçš„3ä¸ªCase &lt;a href="#%e6%9c%80%e5%90%8e%e7%9a%843%e4%b8%aacase" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æœ€åçš„ä¸‰ä¸ªCaseæœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼Œå°±æ˜¯å¯¹åè®®çš„æ•ˆç‡å’Œæ­£ç¡®æ€§æœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚ã€‚å³ä½¿å‰é¢çš„ä»£ç é‡Œä½ çš„å®ç°æ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿæœ‰å¯èƒ½å› ä¸ºå„ç§å…¶å®ƒçš„åŸå› é€ æˆCaseæŒ‚æ‰ã€‚&lt;/p>
&lt;p>å»ºè®®é¦–å…ˆè§£å†³æ­£ç¡®æ€§é—®é¢˜ï¼Œå†æå‡æ•ˆç‡ã€‚&lt;/p>
&lt;h4 id="å‘å·¦æ»šçš„ä¼˜åŒ–é‡è¦">å‘å·¦æ»šçš„ä¼˜åŒ–ï¼ˆé‡è¦ï¼ï¼‰ &lt;a href="#%e5%90%91%e5%b7%a6%e6%bb%9a%e7%9a%84%e4%bc%98%e5%8c%96%e9%87%8d%e8%a6%81" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åœ¨è®ºæ–‡çš„5.3èŠ‚ï¼Œä»‹ç»äº†ä¸€ç§å›æ»šçš„ä¼˜åŒ–ã€‚å¦‚æœLeaderå’ŒFolloweråœ¨æŸä¸ªIndexä¸Šçš„æ—¥å¿—ä¸ä¸€è‡´ï¼ŒLeaderçš„ç‰ˆæœ¬è®°ä¸º(Term1, Index)ï¼ŒFollowerçš„ç‰ˆæœ¬è®°ä¸º(Term2, Index)ã€‚é‚£ä¹ˆFolloweréœ€è¦å›æ»šæ‰€æœ‰æ—¥å¿—ï¼Œç›´åˆ°Termå°äº&lt;code>Min(Term1, Term2)&lt;/code>ã€‚&lt;/p>
&lt;p>è¿™æ ·çš„å¥½å¤„æ˜¯å¯ä»¥åŠ å¿«å›æ»šçš„æ•ˆç‡ã€‚è™½ç„¶è®ºæ–‡ä¸Šè¡¨ç¤ºè¿™ç§ä¼˜åŒ–å¹¶éå¿…è¦ï¼Œä½†æ˜¯åœ¨æ¨¡æ‹Ÿå‡ºæ¥çš„æç«¯ç½‘ç»œç¯å¢ƒä¸‹ï¼Œè¿™æ ·çš„ä¼˜åŒ–å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ä¸€äº›æ¯”è¾ƒå˜æ€çš„Caseã€‚&lt;/p>
&lt;h4 id="å…¶å®ƒçš„éå®˜æ–¹ä¼˜åŒ–">å…¶å®ƒçš„éå®˜æ–¹ä¼˜åŒ– &lt;a href="#%e5%85%b6%e5%ae%83%e7%9a%84%e9%9d%9e%e5%ae%98%e6%96%b9%e4%bc%98%e5%8c%96" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>è¿™é‡Œè¿˜æœ‰ä¸€äº›è®ºæ–‡é‡Œæ²¡çš„æåˆ°çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¸ä¿è¯ä¸€å®šæ˜¯æ­£ç¡®çš„ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¸å‰§é€ï¼Œæ”¾åˆ°å•ç‹¬çš„é“¾æ¥é‡Œäº†ï¼š&lt;a href="https://github.com/Wizmann/assets/blob/master/wizmann-pic/19-05-02/raft-hints.md">å‰§é€è­¦å‘Šï¼&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>è¿˜æœ‰ä¸€ä¸ªBonusæŒ‘æˆ˜ï¼Œè°æ¯”è¾ƒé—²å¯ä»¥è¯•ä¸€ä¸‹ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="æµ‹è¯•ç»“æœ">æµ‹è¯•ç»“æœ &lt;a href="#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/e35dd59aa533ddd19065f070dcb85a3734cc035d/wizmann-pic/19-05-02/2019-05-02_21-37-14.png" alt="tests">&lt;/p>
&lt;p>åœ¨Travis CIä¸Šé¢è¿è¡Œçš„æµ‹è¯•ã€‚è‡ªæˆ‘æ„Ÿè§‰å®ç°çš„æ¯”è¾ƒä¸€èˆ¬ï¼Œæ‰€ä»¥ä½ ä»¬çš„ç¨‹åºåº”è¯¥è·‘çš„æ¯”æˆ‘å¿«ä¸€ç‚¹æ‰æ­£å¸¸ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“ &lt;a href="#%e6%80%bb%e7%bb%93" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æƒ³è¦å®Œæ•´æ­£ç¡®çš„å®ç°è¿™ä¸ªé¡¹ç›®ï¼Œé¦–å…ˆä¸€å®šè¦æŠŠè®ºæ–‡è¯»æ‡‚ã€‚å¹¶ä¸”åˆ’å‡ºå®ç°ä¸Šåº”è¯¥æ³¨æ„çš„é‡ç‚¹ã€‚&lt;/p>
&lt;p>å½“é‡åˆ°æ­£ç¡®æ€§é—®é¢˜æ—¶ï¼Œä¸€å®šè¦å›å½’è®ºæ–‡ï¼Œå¤§éƒ¨åˆ†çš„é—®é¢˜éƒ½å¯ä»¥è·å¾—è§£ç­”ã€‚å½“é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¯ä»¥å‚è€ƒä½œä¸šä¸Šé¢çš„Hintsï¼Œé‡Œé¢ä¹Ÿæœ‰éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;p>MITçš„è¿™ä¸ªè¯¾ç¨‹è¿˜æœ‰åŸºäºraftå®ç°kv storageçš„é¡¹ç›®ï¼Œåç»­å¦‚æœæœ‰æ—¶é—´åº”è¯¥è¿˜ä¼šåšå§ã€‚&lt;/p></description></item><item><title>ç™½è¯ä¸€è‡´æ€§åè®® - Paxosã€Raftå’ŒPacificA[2]</title><link>https://wizmann.top/posts/paxos-raft-pecifaca2/</link><pubDate>Mon, 18 Feb 2019 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/paxos-raft-pecifaca2/</guid><description>&lt;h2 id="pacificaæ˜¯ä¸€ä¸ªæ¡†æ¶">PacificAæ˜¯ä¸€ä¸ªæ¡†æ¶ &lt;a href="#pacifica%e6%98%af%e4%b8%80%e4%b8%aa%e6%a1%86%e6%9e%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>è™½ç„¶åœ¨é¢˜ç›®ä¸­æˆ‘ä»¬æŠŠPaxosã€Raftå’ŒPacificAå¹¶åˆ—ï¼Œä½†æ˜¯Paxoså’ŒRaftåœ¨è®ºæ–‡ä¸­ç§°è‡ªå·±ä¸ºä¸€ç§â€œç®—æ³•â€ï¼ˆalgorithmï¼‰ï¼›è€ŒPacificAå¯¹è‡ªå·±çš„å®šä½æ˜¯ä¸€ç§é€šç”¨çš„ï¼Œå¼ºä¸€è‡´çš„æ•°æ®åŒæ­¥&lt;strong>æ¡†æ¶&lt;/strong>ã€‚&lt;/p>
&lt;p>åœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…æåˆ°ç°æœ‰çš„å¯è¯æ˜çš„æ•°æ®åŒæ­¥åè®®å¾€å¾€è¿‡åˆ†ç®€åŒ–äº†æ€§èƒ½é—®é¢˜ï¼Œå¯¼è‡´çœ‹èµ·æ¥å¾ˆç¾çš„ç†è®ºè®¾è®¡æ— æ³•è½¬å˜æœ‰å®é™…çš„ç³»ç»Ÿï¼ˆæ³¨ï¼šæœ¬ç¯‡è®ºæ–‡åº”è¯¥æ—©äºRaftçš„è®ºæ–‡ï¼‰ã€‚æ‰€ä»¥ä½œè€…çš„ç›®æ ‡æ˜¯å°†ç®—æ³•ç†è®ºä¸å®é™…ç›¸ç»“åˆï¼Œè¿›è¡Œç›¸åº”çš„ç³»ç»Ÿè®¾è®¡ã€‚&lt;/p>
&lt;h2 id="pacificaçš„å®ç°">PacificAçš„å®ç° &lt;a href="#pacifica%e7%9a%84%e5%ae%9e%e7%8e%b0" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¸Paxoså’ŒRaftä¸åŒçš„æ˜¯ï¼ŒPacificAé‡‡ç”¨çš„ç®—æ³•éå¸¸ç®€å•ã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä¸è¿›è¡Œå¤ªå¤šé“ºå«ï¼Œç›´æ¥è¿›å…¥æ­£é¢˜ã€‚&lt;/p>
&lt;h3 id="ä¸»ä»åŒæ­¥">ä¸»ä»åŒæ­¥ &lt;a href="#%e4%b8%bb%e4%bb%8e%e5%90%8c%e6%ad%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>PacificAä½¿ç”¨äº†ä¸»ä»åŒæ­¥æ¨¡å‹ï¼Œç”¨æˆ·çš„è¯»å†™è¯·æ±‚éƒ½ä¼šå‘å¾€ä¸»èŠ‚ç‚¹ï¼Œä»¥ä¿è¯å¼ºä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>ä¸»èŠ‚ç‚¹ä¼šå¯¹å‘æ¥çš„å†™è¯·æ±‚è¿›è¡Œç¼–å·ï¼Œä½¿å¾—æ‰€æœ‰å†™è¯·æ±‚ç¼–å·å”¯ä¸€ä¸”å•è°ƒé€’å¢ã€‚è¿™ä¸ªç¼–å·ä¹Ÿä¼šåŒæ­¥åˆ°ä»èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>æ— è®ºæ˜¯ä¸»èŠ‚ç‚¹è¿˜æ˜¯ä»èŠ‚ç‚¹ï¼Œæ‰€æœ‰çš„å†™è¯·æ±‚éƒ½å†™å…¥ä¸€ä¸ªåªè¿½åŠ çš„æ—¥å¿—ã€‚ä¸»ä»èŠ‚ç‚¹éƒ½éœ€è¦ç»´æŠ¤&lt;code>committed&lt;/code>æŒ‡é’ˆï¼Œä»£è¡¨åœ¨è¿™ä¸ªæŒ‡é’ˆä¹‹å‰çš„æ•°æ®éƒ½å·²ç»è¢«æ‰€æœ‰èŠ‚ç‚¹æ‰€è®¤å¯ï¼Œå¤„ç†â€œå·²ç¡®è®¤â€çŠ¶æ€ã€‚ä»èŠ‚ç‚¹éœ€è¦é¢å¤–ç»´æŠ¤ä¸€ä¸ª&lt;code>prepared&lt;/code>æŒ‡é’ˆï¼Œä»£è¡¨åœ¨è¿™ä¸ªæŒ‡é’ˆä¹‹å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤„äºâ€œå¾…ç¡®è®¤â€çŠ¶æ€ï¼Œè€Œåœ¨&lt;code>prepared&lt;/code>æŒ‡é’ˆä¹‹åçš„æ•°æ®ï¼Œéƒ½æ˜¯â€œå¾…åŒæ­¥â€çŠ¶æ€ã€‚&lt;/p>
&lt;p>ä¸»ä»ä¹‹é—´çš„æ•°æ®åŒæ­¥ä½¿ç”¨ä¸¤æ­¥æäº¤æ¨¡å‹ï¼ˆ2-PCï¼‰ï¼š&lt;/p>
&lt;ol>
&lt;li>ä¸»èŠ‚ç‚¹é¦–å…ˆæŠŠå†™è¯·æ±‚å†™å…¥æ—¥å¿—&lt;/li>
&lt;li>ä¸»èŠ‚ç‚¹å‘é€&lt;code>prepare&lt;/code>è¯·æ±‚åˆ°ä»èŠ‚ç‚¹ï¼Œè¿™ä¸ªè¯·æ±‚ä¸­åŒ…å«å†™å…¥çš„æ•°æ®&lt;/li>
&lt;li>ä»èŠ‚ç‚¹æ”¶åˆ°&lt;code>prepare&lt;/code>è¯·æ±‚åï¼Œå°†æ•°æ®åŠ å…¥æ—¥å¿—ï¼Œå¹¶ç§»åŠ¨&lt;code>prepared&lt;/code>æŒ‡é’ˆï¼Œå°†å…¶æ ‡è®°ä¸ºâ€œå¾…ç¡®è®¤â€&lt;/li>
&lt;li>å½“æ‰€æœ‰ä»èŠ‚ç‚¹è¿”å›ACKåï¼Œä¸»èŠ‚ç‚¹ç§»åŠ¨&lt;code>committed&lt;/code>æŒ‡é’ˆï¼Œè¡¨æ˜è¿™ä¸ªæ•°æ®å¤„äºâ€œå¾…ç¡®è®¤â€çŠ¶æ€&lt;/li>
&lt;li>ä¸»èŠ‚ç‚¹å‘æ‰€æœ‰ä»èŠ‚ç‚¹å‘é€ACKæ¶ˆæ¯ï¼Œç¡®è®¤è¿™æ¡è¯·æ±‚å·²ç»è¢«æœ€ç»ˆç¡®è®¤&lt;/li>
&lt;li>ä»èŠ‚ç‚¹æ”¶åˆ°ACKæ¶ˆæ¯åï¼Œç§»åŠ¨&lt;code>committed&lt;/code>æŒ‡é’ˆï¼Œç¡®è®¤è¯·æ±‚&lt;/li>
&lt;/ol>
&lt;p>æ‰€ä»¥å¯¹äºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ€»ä¼šæœ‰:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/19-02-18/1902180052.PNG" alt="">&lt;/p>
&lt;h3 id="å…¨å±€é…ç½®ç®¡ç†å™¨">å…¨å±€é…ç½®ç®¡ç†å™¨ &lt;a href="#%e5%85%a8%e5%b1%80%e9%85%8d%e7%bd%ae%e7%ae%a1%e7%90%86%e5%99%a8" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>PacificAä½¿ç”¨äº†ä¸€ä¸ªâ€œä¸­å¿ƒåŒ–çš„â€å…¨å±€é…ç½®ç®¡ç†å™¨ã€‚è¿™ä¸ªç®¡ç†å™¨ç”¨äºæ¢æµ‹ç³»ç»Ÿå†…çš„å¤±æ•ˆèŠ‚ç‚¹ï¼Œç®¡ç†ã€æ›´æ–°èŠ‚ç‚¹çš„é…ç½®ã€‚è€ŒRaftæ˜¯â€œå»ä¸­å¿ƒåŒ–çš„â€ï¼Œé€šè¿‡èŠ‚ç‚¹ä¹‹é—´çš„é€‰ä¸¾é€šä¿¡æ¥ç®¡ç†é…ç½®ã€‚&lt;/p>
&lt;p>PacificAçš„å…¨å±€é…ç½®ç®¡ç†å™¨ä¿è¯åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå½“ä¸”ä»…å½“å…¨å±€é…ç½®ç®¡ç†å™¨è®¤å¯èŠ‚ç‚¹&lt;code>s&lt;/code>ä¸ºä¸»èŠ‚ç‚¹æ—¶ï¼ŒèŠ‚ç‚¹&lt;code>s&lt;/code>æ‰ä¼šè®¤ä¸ºè‡ªå·±æ˜¯ä¸»èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>å…¨å±€é…ç½®ç®¡ç†å™¨åœ¨â€œé’¦ç‚¹â€äº†ä¸»èŠ‚ç‚¹åï¼Œä¸»èŠ‚ç‚¹ä¼šä¸ä»èŠ‚ç‚¹å‘é€å¿ƒè·³åŒ…ï¼ˆbeaconsï¼‰ï¼Œç»´æŠ¤ä¸€ä¸ªç§ŸæœŸï¼ˆleaseï¼‰ã€‚åœ¨ç§ŸæœŸå†…ï¼Œä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹éƒ½ä¼šäº’ç›¸æ‰¿è®¤ç›¸äº’ä¹‹é—´çš„ä¸»ä»å…³ç³»ã€‚å½“ç§ŸæœŸå¤±æ•ˆæ—¶ï¼Œä¸»èŠ‚ç‚¹ä¼šå‘å…¨å±€é…ç½®ç®¡ç†å™¨æŠ¥å‘Šä»èŠ‚ç‚¹å¤±æ•ˆã€‚å½“ä»èŠ‚ç‚¹æ”¶ä¸åˆ°å¿ƒè·³åŒ…æ—¶ï¼Œä»èŠ‚ç‚¹ä¼šæŠ¥å‘Šä¸»èŠ‚ç‚¹å¤±æ•ˆã€‚&lt;/p>
&lt;p>ä¸€ä¸ªä¸­å¿ƒåŒ–çš„é…ç½®ç®¡ç†å™¨ä¼šè®©æ•´ä¸ªç³»ç»Ÿçš„ç»´æŠ¤å˜çš„éå¸¸ç®€å•ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥å•ç‚¹å¤±æ•ˆçš„éšæ‚£ã€‚è¿™é‡Œï¼Œå…¨å±€é…ç½®ç®¡ç†å™¨ä½¿ç”¨äº†Paxosç®—æ³•æ¥ä¿è¯ç®¡ç†å™¨èŠ‚ç‚¹ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œå¯ä»¥å®¹å¿å°‘äºåŠæ•°èŠ‚ç‚¹çš„å¤±æ•ˆã€‚&lt;/p>
&lt;h3 id="é…ç½®å˜åŒ–ä¸ç¾éš¾æ¢å¤">é…ç½®å˜åŒ–ä¸ç¾éš¾æ¢å¤ &lt;a href="#%e9%85%8d%e7%bd%ae%e5%8f%98%e5%8c%96%e4%b8%8e%e7%81%be%e9%9a%be%e6%81%a2%e5%a4%8d" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„å…¨å±€çš„é…ç½®ç®¡ç†å™¨ï¼Œæ‰€ä»¥æ·»åŠ åˆ é™¤ä»èŠ‚ç‚¹ä¼šæ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºä¸»èŠ‚ç‚¹çš„å¤±æ•ˆä¸ç¾éš¾æ¢å¤ã€‚&lt;/p>
&lt;p>å½“ä¸»èŠ‚ç‚¹å¤±æ•ˆä¹‹åï¼Œä»èŠ‚ç‚¹ä¼šæ­ç«¿è€Œèµ·ï¼Œå‘é…ç½®ç®¡ç†å™¨ç”³è¯·æˆä¸ºä¸»èŠ‚ç‚¹ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œæ ¹æ®ä¸Šé¢çš„è®¨è®ºï¼Œä»èŠ‚ç‚¹ä¸­çš„&lt;code>committed&lt;/code>æŒ‡é’ˆæœ‰å¯èƒ½ä¼šè½åäºä¸»èŠ‚ç‚¹ï¼Œä»¥åŠä¸åŒä»èŠ‚ç‚¹ä¸­çš„&lt;code>committed&lt;/code>æŒ‡é’ˆå¯èƒ½ä¼šä¸ä¸€è‡´ã€‚ä½†æ˜¯è¢«ä¸»èŠ‚ç‚¹ACKçš„æ•°æ®ï¼Œä¸€å®šä½äºä»èŠ‚ç‚¹çš„æ—¥å¿—ä¸­ï¼Œå¹¶å¤„äºâ€œå¾…ç¡®è®¤â€çŠ¶æ€ã€‚&lt;/p>
&lt;p>æ‰€ä»¥åœ¨æ–°çš„ä¸»èŠ‚ç‚¹è¢«æŒ‡æ´¾ä¹‹åï¼Œä¼šé‡æ–°çš„å‘å…¶å®ƒçš„ä»èŠ‚ç‚¹å‘å‡º&lt;code>prepare&lt;/code>æŒ‡ä»¤ï¼Œè¦æ±‚ç¡®è®¤å…¶æ—¥å¿—ä¸­å¾…ç¡®è®¤çš„æ•°æ®ã€‚ä»è€Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§&lt;/p>
&lt;h2 id="pacificaçš„æ­£ç¡®æ€§çš„ç®€å•è®¨è®º">PacificAçš„æ­£ç¡®æ€§çš„ç®€å•è®¨è®º &lt;a href="#pacifica%e7%9a%84%e6%ad%a3%e7%a1%ae%e6%80%a7%e7%9a%84%e7%ae%80%e5%8d%95%e8%ae%a8%e8%ae%ba" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¸€ä¸ªå¼ºä¸€è‡´æ€§çš„ç³»ç»Ÿä¸€å®šä¼šåŒ…å«ä»¥ä¸‹ä¸‰ç§ç‰¹æ€§ï¼š&lt;/p>
&lt;ol>
&lt;li>çº¿æ€§ä¸€è‡´æ€§ï¼ˆLinearizabilityï¼‰ &lt;br>
ç”±äºæˆ‘ä»¬çš„å†™è¯·æ±‚ä½äºä¸€ä¸ªåªå¯è¿½åŠ å†™çš„æ—¥å¿—å½“ä¸­ï¼Œå¹¶ä¸”ä¸åŒçš„å‰¯æœ¬çš„æ—¥å¿—ä¿æŒå¼ºä¸€è‡´ã€‚æ‰€ä»¥ä¸åŒçš„å‰¯æœ¬çš„çŠ¶æ€ä¹Ÿåº”è¯¥æ˜¯ä¸€è‡´çš„ã€‚&lt;/li>
&lt;li>å¯æŒä¹…æ€§ï¼ˆDurabilityï¼‰ &lt;br>
å¦‚æœç”¨æˆ·æ”¶åˆ°äº†ACKï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚ä¸€å®šå·²ç»æŒä¹…åŒ–åˆ°æ‰€æœ‰çš„å‰¯æœ¬ä¹‹ä¸Šäº†ã€‚å³ä½¿å‘ç”Ÿäº†ä¸»èŠ‚ç‚¹å¤±æ•ˆï¼Œæ–°çš„ä¸»èŠ‚ç‚¹ä»ä¼šç»´æŒå·²ACKçš„æ•°æ®ã€‚&lt;/li>
&lt;li>å‰è¿›æ€§ï¼ˆProgressï¼Œä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘ï¼‰ &lt;br>
å…¨å±€é…ç½®ç®¡ç†å™¨åœ¨å¤„ç†å®Œé…ç½®æ›´æ–°è¯·æ±‚åï¼Œä¸€å®šå¯ä»¥å‰”é™¤å¤±æ•ˆçš„èŠ‚ç‚¹ã€‚ä½¿å¾—æ•´ä¸ªç³»ç»Ÿå¯ä»¥å¤„ç†ç”¨æˆ·çš„è¯»å†™è¯·æ±‚ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="ä¸€äº›å…¶å®ƒçš„è®¨è®º">ä¸€äº›å…¶å®ƒçš„è®¨è®º &lt;a href="#%e4%b8%80%e4%ba%9b%e5%85%b6%e5%ae%83%e7%9a%84%e8%ae%a8%e8%ae%ba" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="å…¨å±€é…ç½®ç®¡ç†å™¨çš„å¯ç”¨æ€§å’Œæ€§èƒ½">å…¨å±€é…ç½®ç®¡ç†å™¨çš„å¯ç”¨æ€§å’Œæ€§èƒ½ &lt;a href="#%e5%85%a8%e5%b1%80%e9%85%8d%e7%bd%ae%e7%ae%a1%e7%90%86%e5%99%a8%e7%9a%84%e5%8f%af%e7%94%a8%e6%80%a7%e5%92%8c%e6%80%a7%e8%83%bd" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç”±äºå…¨å±€é…ç½®ç®¡ç†å™¨åœ¨é€»è¾‘ä¸Šæ˜¯æ•´ä¸ªç³»ç»Ÿçš„å•ç‚¹ï¼Œæ‰€ä»¥å…¶å¯ç”¨æ€§å’Œæ€§èƒ½æ˜¯éå¸¸å€¼å¾—å…³æ³¨çš„ã€‚&lt;/p>
&lt;p>å…¨å±€é…ç½®ç®¡ç†å™¨äº†Paxosç®—æ³•ï¼Œæ‰€ä»¥åœ¨å°‘äºä¸€åŠçš„èŠ‚ç‚¹å¤±æ•ˆæ—¶ï¼Œå®ƒä»èƒ½å¯¹å¤–æä¾›æœåŠ¡ã€‚&lt;/p>
&lt;p>åŒæ—¶ï¼Œå…¨å±€é…ç½®ç®¡ç†å™¨çš„å¤„ç†ä¸åœ¨æ•´ä¸ªç³»ç»Ÿçš„å…³é”®è·¯å¾„ä¸Šï¼Œæ‰€ä»¥åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚åŒæ—¶ï¼Œåœ¨ç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œå³ä½¿é…ç½®ç®¡ç†å™¨æš‚æ—¶å¤±æ•ˆï¼Œä¹Ÿä¸ä¼šå½±å“ç³»ç»Ÿçš„è¿è¡Œã€‚&lt;/p>
&lt;h3 id="å¯æŒä¹…æ€§">å¯æŒä¹…æ€§ &lt;a href="#%e5%8f%af%e6%8c%81%e4%b9%85%e6%80%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>PacificAçš„æ—¥å¿—åŒæ­¥é‡‡ç”¨äº†ä¸¤æ­¥æäº¤ï¼Œæ‰€ä»¥ç”¨æˆ·æ”¶åˆ°ACKæ—¶ï¼Œè¯´æ˜ç”¨æˆ·çš„å†™è¯·æ±‚å·²ç»è¢«æŒä¹…åŒ–åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¹‹ä¸Šäº†ã€‚&lt;/p>
&lt;p>è¿™æ„å‘³ç€ï¼Œåœ¨ä¸€ä¸ªæœ‰nå°æœºå™¨çš„é›†ç¾¤é‡Œï¼Œå³ä½¿æœ‰n - 1å°èŠ‚ç‚¹å¤±æ•ˆï¼Œæˆ‘ä»¬ä»èƒ½æä¾›å¯ç”¨çš„æœåŠ¡ã€‚ï¼ˆä½†æ˜¯ä¸€èˆ¬åªæä¾›åªè¯»æœåŠ¡ï¼‰&lt;/p>
&lt;h3 id="ä¸»ä»å¤åˆ¶-vs-paxos">ä¸»ä»å¤åˆ¶ vs. Paxos &lt;a href="#%e4%b8%bb%e4%bb%8e%e5%a4%8d%e5%88%b6-vs-paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨PaxosèŒƒå¼çš„å®ç°ä¸­ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚è¢«å¤šæ•°èŠ‚ç‚¹è®¤å¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç”¨æˆ·ç«¯è¿”å›ACKï¼Œå£°æ˜è¿™ä¸ªè¯·æ±‚å·²ç»è¢«æ•´ä¸ªç³»ç»Ÿæ‰€è®¤å¯ã€‚ä½†æ˜¯åœ¨ä¸»ä»å¤åˆ¶çš„èŒƒå¼ä¸‹ï¼Œå¿…é¡»è¦æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è®¤å¯è¿™ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬æ‰å¯ä»¥è¯´è¿™ä¸ªè¯·æ±‚è¢«æ•´ä¸ªç³»ç»Ÿæ‰€è®¤å¯ã€‚&lt;/p>
&lt;p>å› ä¸ºè¿™ä¸¤ç§èŒƒå¼ä¹‹é—´çš„ä¸åŒç­–ç•¥å¯¼è‡´äº†å¾®å¦™çš„å·®åˆ«ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼ŒPaxosèŒƒå¼ä¸­å¯¹äºå•ä¸ªèŠ‚ç‚¹çš„æ€§èƒ½æ³¢åŠ¨å¹¶ä¸æ•æ„Ÿï¼Œä½†æ˜¯ä¸»ä»å¤åˆ¶çš„ä¸€ä¸ªæ…¢èŠ‚ç‚¹å¯èƒ½ä¼šæ‹–æ…¢æ•´ä¸ªç³»ç»Ÿã€‚ä½†æ˜¯ï¼Œå¦‚æœç³»ç»Ÿä¸­å¤šæ•°èŠ‚ç‚¹å…¨éƒ¨å¤±æ•ˆï¼Œé‚£ä¹ˆPaxosèŒƒå¼å°±æ— æ³•æä¾›æœåŠ¡äº†ï¼ˆè¯»/å†™éƒ½ä¸å¯ä»¥çš„ï¼‰ï¼›å¯¹äºä¸»ä»å¤åˆ¶èŒƒå¼ï¼Œåªè¦æœ‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å­˜æ´»çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œå¹¶ä¸”ä¿æŒå¼ºä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>æ›´é‡è¦çš„æ˜¯ï¼Œä½¿ç”¨å•ç‚¹æ¥ç®¡ç†æ•´ä¸ªç³»ç»Ÿçš„é…ç½®ï¼Œå¹¶è®©å¼€å‘ä¸è¿ç»´çš„æˆæœ¬é™ä½ã€‚æ¢åšPaxosèŒƒå¼ï¼Œä¸€ä¸ªèŠ‚ç‚¹è‹¥è¦æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œåˆ™éœ€è¦åŒå¤šæ•°èŠ‚ç‚¹è¿›è¡Œåå•†ã€‚&lt;/p>
&lt;p>è¿™ä¸¤ç§èŒƒå¼çš„é€‰æ‹©æ˜¯éå¸¸æœ‰äº‰è®®çš„ï¼ŒPecificAé€‰æ‹©ä¸»ä»å¤åˆ¶çš„ä¸»è¦åŸå› å°±æ˜¯å› ä¸ºå®ƒç®€å•ã€‚ï¼ˆå¤ªå®åœ¨äº†ï¼‰&lt;/p>
&lt;h3 id="åœ¨å¼ºä¸€è‡´æ€§ä¸Šçš„å¦¥å">åœ¨å¼ºä¸€è‡´æ€§ä¸Šçš„å¦¥å &lt;a href="#%e5%9c%a8%e5%bc%ba%e4%b8%80%e8%87%b4%e6%80%a7%e4%b8%8a%e7%9a%84%e5%a6%a5%e5%8d%8f" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¦‚æœéœ€è¦æ”¾æ¾å¯¹å¼ºä¸€è‡´æ€§çš„è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»èŠ‚ç‚¹æ”¯æŒè¯»è¯·æ±‚ã€‚è¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯æˆ‘ä»¬æœ‰å¯èƒ½è¯»åˆ°é™ˆæ—§çš„æ•°æ®ï¼Œç”±å¼ºä¸€è‡´æ€§é€€åŒ–åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>æœ€ç»ˆä¸€è‡´æ€§ä»æœ¬è´¨ä¸Šè¯´éœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªè¦æ±‚ï¼š&lt;/p>
&lt;ol>
&lt;li>æ‰€æœ‰çš„èŠ‚ç‚¹éœ€è¦ä»¥åŒæ ·çš„é¡ºåºæ‰§è¡ŒåŒæ ·çš„çŠ¶æ€æ›´æ–°æ“ä½œ&lt;/li>
&lt;li>åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œå¿…é¡»è¿”å›æœ€æ–°çš„çŠ¶æ€&lt;/li>
&lt;/ol>
&lt;p>å¦‚æœæ”¾æ¾ç¬¬ä¸€ä¸ªè¦æ±‚ï¼Œå°±ä¼šé¢ä¸´â€œçŠ¶æ€åˆ†å‰â€çš„é—®é¢˜ï¼ˆåƒgit branchä¸€æ ·ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¤„ç†è¿™ç§ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆåƒgit rebaseä¸€æ ·ï¼‰ã€‚è¿™å°±ä¼šå¸¦æ¥é¢å¤–çš„å¤æ‚æ€§å’Œä¸ç¡®å®šæ€§ã€‚&lt;/p>
&lt;p>æ”¾æ¾ç¬¬äºŒä¸ªè¦æ±‚æ˜¯æ›´åŠ ç†æ€§çš„ï¼Œå› ä¸ºåœ¨PecificAä¸­ï¼Œæ‰€æœ‰çš„çŠ¶æ€å˜åŒ–å…¨éƒ½è¢«å†™å…¥ä¸€ä¸ªâ€œåªå¯è¿½åŠ å†™â€çš„æ—¥å¿—ä¸­ã€‚å¹¶ä¸”å½“å‰çš„çŠ¶æ€å˜åŒ–é€šè¿‡æ—¥å¿—æŒ‡é’ˆçš„ç§»åŠ¨æ¥è¡¨ç¤ºã€‚åˆå› ä¸ºä»èŠ‚ç‚¹çš„æ—¥å¿—ä¸€å®šæ˜¯ä¸»èŠ‚ç‚¹çš„å‰è¾ï¼Œå¹¶ä¸”æ—¥å¿—æŒ‡é’ˆç¨å¾®è½åä¸ä¸»èŠ‚ç‚¹ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯ä»¥æ”¾æ¾å¼ºä¸€è‡´æ€§çš„è¦æ±‚ï¼Œå°±å¯ä»¥è®©ä»èŠ‚ç‚¹æ¥å¤„ç†è¯»è¯·æ±‚ã€‚&lt;/p>
&lt;h2 id="å†™åœ¨åé¢">å†™åœ¨åé¢ &lt;a href="#%e5%86%99%e5%9c%a8%e5%90%8e%e9%9d%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>è¿˜æœ‰å¥½å¤šä¸œè¥¿æ²¡è¯»é€å‘¢ã€‚è¦ä¸å†é¥¶ä¸€ç¯‡ï¼Ÿ&lt;/p></description></item><item><title>ç™½è¯ä¸€è‡´æ€§åè®® - Paxosã€Raftå’ŒPacificA[1]</title><link>https://wizmann.top/posts/paxos-raft-pecifaca1/</link><pubDate>Wed, 05 Dec 2018 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/paxos-raft-pecifaca1/</guid><description>&lt;h2 id="ä¹¦æ¥ä¸Šæ–‡---multi-paxos">ä¹¦æ¥ä¸Šæ–‡ - Multi Paxos &lt;a href="#%e4%b9%a6%e6%8e%a5%e4%b8%8a%e6%96%87---multi-paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†Basic Paxoså’ŒMulti Paxosçš„å¼‚åŒã€‚åœ¨&lt;a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf">Paxos Made Simple&lt;/a>è®ºæ–‡ä¸­ï¼Œä½œè€…æåˆ°äº†Multi Paxosçš„ä¸€ç§å®ç°ã€‚è¿™ä¸ªå®ç°å…è®¸æˆ‘ä»¬å¯¹ä¸€ä¸ªè¿ç»­çš„æ•°æ®æµï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºå¤åˆ¶æ—¥å¿—ï¼Œreplicated logï¼‰è¾¾æˆå…±è¯†ï¼Œä»è€Œå®ç°èŠ‚ç‚¹çŠ¶æ€çš„ä¸€è‡´æ€§å¤åˆ¶ã€‚&lt;/p>
&lt;h3 id="ç¡®å®šæ€§çŠ¶æ€æœº">ç¡®å®šæ€§çŠ¶æ€æœº &lt;a href="#%e7%a1%ae%e5%ae%9a%e6%80%a7%e7%8a%b6%e6%80%81%e6%9c%ba" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æˆ‘ä»¬å¯ä»¥å°†ç³»ç»Ÿä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹æŠ½è±¡ä¸ºä¸€ä¸ªæœ‰ç€ç¡®å®šæ€§çŠ¶æ€æœºï¼Œå³ç»™å®šå¤šä¸ªçŠ¶æ€ä¸€è‡´çš„çŠ¶æ€æœºï¼Œåœ¨æ‰§è¡ŒåŒä¸€ä¸ªå‘½ä»¤ä¹‹åï¼Œå…¶çŠ¶æ€ä»ä¿æŒä¸€è‡´ã€‚ï¼ˆå¯ä»¥æƒ³ä¸€æƒ³ç¼–è¯‘åŸç†é‡Œé¢çš„DFAï¼‰&lt;/p>
&lt;h3 id="leader---ç³»ç»Ÿä¸­å”¯ä¸€çš„proposer">Leader - ç³»ç»Ÿä¸­å”¯ä¸€çš„proposer &lt;a href="#leader---%e7%b3%bb%e7%bb%9f%e4%b8%ad%e5%94%af%e4%b8%80%e7%9a%84proposer" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨æœ‰å¤šä¸ªproposerï¼Œé‚£ä¹ˆå°±å¾ˆå¯èƒ½ä¼šå‡ºç°å¤šä¸ªææ¡ˆç›¸äº’å¹²æ‰°çš„æƒ…å†µã€‚è™½ç„¶æ ¹æ®è¯æ˜ï¼Œæœ€ç»ˆè¿™äº›ææ¡ˆéƒ½ä¼šæ”¶æ•›åˆ°ä¸€è‡´ï¼Œä½†æ˜¯æ€§èƒ½ä¼šéå¸¸ä½ä¸‹ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­é€šè¿‡é€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªleaderåšä¸ºä¸»proposerï¼ˆdistinguishied proposerï¼‰ï¼Œæ‰€æœ‰çš„ææ¡ˆéƒ½ç”±leaderæå‡ºã€‚&lt;/p>
&lt;p>è¿™æ ·ä¸€æ¥ï¼Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä¸ä¼šå‡ºç°ææ¡ˆç›¸äº’å¹²æ‰°çš„æƒ…å†µã€‚åªæœ‰åœ¨leaderåˆ‡æ¢çš„ç¬é—´ï¼Œå¯èƒ½ä¼šå‡ºç°ç›¸åŒç¼–å·çš„ä¸åŒææ¡ˆï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç®—æ³•å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¿™ç§æƒ…å†µã€‚&lt;/p>
&lt;h3 id="åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„tcp">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„â€œTCPâ€ &lt;a href="#%e5%88%86%e5%b8%83%e5%bc%8f%e7%b3%bb%e7%bb%9f%e4%b8%ad%e7%9a%84tcp" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç±»ä¼¼äºTCPåè®®ä¸­åºåˆ—å·ï¼ŒMulti Paxosä¸­çš„æ¯ä¸€ä¸ªå‘½ä»¤éƒ½æœ‰ä¸€ä¸ªé€’å¢çš„ç¼–å·ã€‚å³æˆ‘ä»¬å‰ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤æ˜¯100å·ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤ä¸€å®šæ˜¯101å·ã€‚æ¯ä¸€ä¸ªå‘½ä»¤éƒ½æ˜¯ä¸€ä¸ªPaxoså®ä¾‹ï¼ŒLeaderå‘æ‰€æœ‰èŠ‚ç‚¹å‘å¸ƒè¿™ä¸ªææ¡ˆï¼Œåœ¨ææ¡ˆè¾¾æˆä¸€è‡´ä¹‹åï¼ˆå¤šæ•°èŠ‚ç‚¹è¿”å›ACKï¼‰ï¼Œå°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªå‘½ä»¤å·²ç»è¾¾æˆäº†ä¸€è‡´ã€‚&lt;/p>
&lt;p>å’ŒTCPä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬é¡ºåºçš„å‘å¸ƒå¹¶è¡¨å†³ææ¡ˆï¼Œæ•ˆç‡ä¼šéå¸¸ä½ä¸‹ï¼ˆTCPåœç­‰æ¨¡å‹ï¼‰ã€‚æ‰€ä»¥ï¼ŒMulti Paxosé‡‡ç”¨ç±»ä¼¼æ»‘åŠ¨çª—å£çš„æ–¹æ¡ˆï¼Œæ¯æ¬¡å¯¹Nä¸ªææ¡ˆè¿›è¡Œè¡¨å†³ï¼Œä»¥å¢åŠ è¡¨å†³çš„å¸¦å®½ã€‚&lt;/p>
&lt;p>å’ŒTCPä¸åŒçš„æ˜¯ï¼Œå¦‚æœæŸäº›åºå·çš„TCPåŒ…åœ¨ä¼ è¾“ä¸­ä¸¢å¤±ï¼Œæœ€åçš„æƒ…å†µæ˜¯æˆ‘ä»¬ä¼šRSTè¿™æ¡é“¾æ¥ï¼Œå…¶å®ƒçš„å·¥ä½œéƒ½äº¤ç»™åº”ç”¨å±‚é€»è¾‘æ¥è§£å†³ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å¯¹äºMulti Paxosæ¥è¯´ï¼Œå¦‚æœæŸäº›ææ¡ˆæ²¡æœ‰è¢«è¡¨å†³ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨æ—¥å¿—ä¸­ç•™ä¸‹ç©ºæ´ï¼ˆgapï¼‰ã€‚è¿™ä¼šç›´æ¥å½±å“ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚å¦‚æœæ°å·§è¿™ä¸ªæ—¶å€™å‘ç”Ÿäº†Leaderå¤±æ•ˆï¼Œé‚£ä¹ˆæ–°é€‰ä¸¾å‡ºæ¥çš„LeaderèŠ‚ç‚¹å°±è¦å¤„ç†æ—¥å¿—ä¸­çš„ç©ºæ´ã€‚&lt;/p>
&lt;p>è§£å†³ç©ºæ´çš„åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯Leaderå‘æ‰€æœ‰æˆå‘˜è¯¢é—®ï¼Œå¯¹äºè¿™ä¸ªææ¡ˆï¼Œæ˜¯å¦å·²ç»æœ‰è¾¾æˆå…±è¯†çš„å€¼ã€‚å¦‚æœæœ‰çš„è¯ï¼Œå°±ä½¿ç”¨è¿™ä¸ªå€¼ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±ç”¨ä¸€ä¸ªno-opï¼ˆæ— æ“ä½œï¼‰å‘½ä»¤æ¥å¡«è¡¥è¿™ä¸ªç©ºä½ã€‚ä½†æ˜¯ï¼Œå¯¹äºå®é™…å·¥ç¨‹ä¸­æ¥è¯´ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è§£å†³æœªè¾¾æˆå…±è¯†æ—¶å€¼çš„å†²çªç­‰æƒ…å†µã€‚&lt;/p>
&lt;h2 id="ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦raft">ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦Raftï¼Ÿ &lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e6%88%91%e4%bb%ac%e8%bf%98%e9%9c%80%e8%a6%81raft" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Multi-Paxosåœ¨ç°å®çš„å·¥ç¨‹å½“ä¸­æ›´å¤šçš„æ˜¯ä¸€ç§ç¬¦å·ã€‚å› ä¸ºç†è®ºä¸å®è·µä¸Šçš„éš”é˜‚æ˜¯å¦‚æ­¤ä¹‹å¤§ï¼Œå¦‚æœæƒ³åœ¨å·¥ç¨‹æ„ä¹‰ä¸Šå®ç°ä¸€ä¸ªå¯ç”¨çš„Multi-Paxosç®—æ³•ï¼Œå¿…ç„¶ä¼šåœ¨åŸç®—æ³•çš„åŸºç¡€ä¸Šè¿›è¡Œä¸€ç³»åˆ—çš„é­”æ”¹ï¼Œè¿™äº›é­”æ”¹è™½ç„¶å‡å£°ç§°è‡ªå·±å®ç°äº†Multi-Paxosç®—æ³•ï¼Œä½†æ˜¯è¿™äº›ç®—æ³•å¤§å¤šä¸èƒ½è¢«è¯æ˜æ˜¯æ­£ç¡®çš„ã€‚&lt;/p>
&lt;p>Raftçš„ç›®æ ‡æ˜¯ï¼Œå³è®©ç®—æ³•æ»¡è¶³å·¥ç¨‹åŒ–éœ€è¦ï¼Œåˆèƒ½ä¿è¯å…¶æ­£ç¡®æ€§ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Raftè®ºæ–‡å½“ä¸­è¯´Paxosç®—æ³•éš¾ä»¥ç†è§£ï¼Œæˆ‘å¹¶ä¸è¿™ä¹ˆè§‰å¾—ã€‚å› ä¸ºPaxosè®ºæ–‡é‡Œé¢æŠŠå›°éš¾çš„éƒ¨åˆ†éƒ½ä¸€ç¬”å¸¦è¿‡äº†ã€‚åªå‰©ä¸‹ç®€å•çš„é‚£éƒ¨åˆ†äº†ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="raft-vs-paxos">Raft vs. Paxos &lt;a href="#raft-vs-paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="leaderé€‰ä¸¾">Leaderé€‰ä¸¾ &lt;a href="#leader%e9%80%89%e4%b8%be" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨Paxosè®ºæ–‡ä¸­ï¼ŒLeaderé€‰ä¸¾è¢«è§†ä½œä¸€ç§ç‰¹æ®Šçš„â€œææ¡ˆé€‰ä¸¾â€ã€‚åªéœ€è¦Proposerå’ŒAcceptorè¿›è¡Œä¸€è½®æˆ–å¤šè½®ï¼ˆå–å†³äºè¿æ°”ï¼‰æŠ•ç¥¨ï¼Œå°±å¯ä»¥ç¡®å®šLeaderã€‚&lt;/p>
&lt;p>ä½†åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹çš„é—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å¦‚ä½•åˆ¤æ–­Leaderæ˜¯å¦å­˜æ´»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ˜¯å¦æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æ‹…å½“Leader&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="leaderçš„ä»»æœŸ">Leaderçš„ä»»æœŸ &lt;a href="#leader%e7%9a%84%e4%bb%bb%e6%9c%9f" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>Leaderåœ¨è¢«é€‰ä¸¾å‡ºæ¥ä¹‹åï¼Œéƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªä»»æœŸç¼–å·ï¼ˆtermï¼‰ã€‚åœ¨ä»»æœŸé‡Œï¼ŒLeaderä¼šå‘æ‰€æœ‰æˆå‘˜å‘é€å¿ƒè·³åŒ…ä»¥å»¶ç»­è‡ªå·±çš„ä»»æœŸã€‚&lt;/p>
&lt;p>å¦‚æœLeaderå¤±æ•ˆæ— æ³•å‘é€å¿ƒè·³åŒ…çš„è¯ï¼Œæˆå‘˜å°±ä¼šäº§ç”Ÿä¸€ä¸ªâ€œé€‰ä¸¾è¶…æ—¶â€ï¼Œæ­¤æ—¶å°±ä¼šé‡æ–°è§¦å‘ä¸€è½®é€‰ä¸¾ã€‚&lt;/p>
&lt;p>é€‰ä¸¾çš„æµç¨‹å’ŒBasic-Paxosç®—æ³•ç±»ä¼¼ï¼Œproposerå‘æ‰€æœ‰æˆå‘˜å‘é€â€œæˆ‘è¦å½“è€å¤§â€çš„ææ¡ˆï¼Œæˆå‘˜ä»¬ä¼šé…Œæƒ…å›å¤ã€‚å¦‚æœå¾—åˆ°äº†å¤šæ•°æˆå‘˜çš„è‚¯å®šï¼Œè¿™ä¸ªproposerå°±æ˜¯ä¸‹ä¸€ä¸ªä»»æœŸçš„Leaderäº†ã€‚&lt;/p>
&lt;p>ä»æœ¬è´¨ä¸Šè¯´ï¼Œæ¯ä¸€ä¸ªä»»æœŸçš„Leaderé€‰ä¸¾ï¼Œéƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Basic-Paxoså®ä¾‹ã€‚ä»»æœŸå·ç›¸å½“äºPaxosé‡Œé¢çš„ææ¡ˆç¼–å·ã€‚&lt;/p>
&lt;h4 id="leaderèµ„æ ¼çš„è®¤å®š">Leaderèµ„æ ¼çš„è®¤å®š &lt;a href="#leader%e8%b5%84%e6%a0%bc%e7%9a%84%e8%ae%a4%e5%ae%9a" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>Rafté‡‡ç”¨å¼ºä¸€è‡´æ€§çš„æ¨¡å‹ï¼Œå¯¹äºå·²ç»ACKçš„ç”¨æˆ·è¯·æ±‚ï¼Œè¦å°½åŠ›ä¿è¯å…¶çŠ¶æ€ä¸ä¸¢å¤±ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¦‚æœä½ é—®æˆ‘ï¼Œç°åœ¨æ¥ä¸€æ ¸å¼¹æŠŠæœºæˆ¿ç‚¸äº†ï¼Œæ•°æ®éƒ½ä¸¢äº†ï¼Œé‚£ä½ æ€ä¹ˆèƒ½ä¿è¯å¼ºä¸€è‡´æ€§ã€‚ &lt;br>
å…¶å®è¿™ä¸ªé—®é¢˜éå¸¸ç®€å•ã€‚å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬ä¿è¯äº†ä¸¢æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚&lt;/p>&lt;/blockquote>
&lt;p>æ‰€ä»¥æˆ‘ä»¬è¦é€‰å‡ºä¸€ä¸ªLeaderï¼Œä½¿å…¶èƒ½å¤ŸåŒ…å«æ‰€æœ‰å·²ç»ACKçš„ææ¡ˆã€‚å½“ä¸€ä¸ªproposerå‘å…¶å®ƒèŠ‚ç‚¹å‘é€ææ¡ˆæ—¶ï¼Œå°±ä¼šæ”¶åˆ°å…¶å®ƒèŠ‚ç‚¹çš„å“åº”ã€‚å› ä¸ºä¸€ä¸ªå·²ç»ACKçš„ææ¡ˆå¿…ç„¶è¢«å¤šæ•°èŠ‚ç‚¹æ‰€è®¤å¯ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªproposeræ²¡æœ‰åŒ…å«æ‰€æœ‰è¢«ACKçš„ææ¡ˆæ—¶ï¼Œå®ƒçš„ææ¡ˆå°±ä¼šè¢«å…¶å®ƒåŒ…å«æ›´å¤šçŠ¶æ€çš„èŠ‚ç‚¹é©³å›ã€‚æœ€åè¢«é€‰å‡ºæ¥çš„Leaderï¼Œä¸€å®šæ˜¯åŒ…å«æ‰€æœ‰è¢«ACKçš„çŠ¶æ€çš„èŠ‚ç‚¹ã€‚&lt;/p>
&lt;h3 id="æ—¥å¿—å¤åˆ¶">æ—¥å¿—å¤åˆ¶ &lt;a href="#%e6%97%a5%e5%bf%97%e5%a4%8d%e5%88%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å½“Leaderè¢«é€‰å‡ºåï¼ŒLeaderå°±ä¼šå¼€å§‹å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚ç”¨æˆ·çš„è¯·æ±‚å¯ä»¥çœ‹åšä¸€ç³»åˆ—çš„å‘½ä»¤ï¼Œåœ¨æ¥æ”¶åˆ°ææ¡ˆåï¼Œææ¡ˆé¦–å…ˆè¢«åˆ†å‘åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„çŠ¶æ€æœºé¡ºåºæ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚åœ¨å¤šæ•°èŠ‚ç‚¹è¿”å›ACKåï¼Œè¿™ä¸ªå‘½ä»¤å°±è¢«è§†ä¸ºâ€œå·²æäº¤â€ï¼ˆcommitedï¼‰ã€‚&lt;/p>
&lt;p>ä¸Šæ–‡ä¸­å·²ç»æåˆ°äº†ä¸€è‡´æ€§ç®—æ³•ä¸­çš„æ—¥å¿—éå¸¸ç±»ä¼¼äºç½‘ç»œåè®®ä¸­çš„TCPã€‚å³å¦‚æœä¸¤ä¸ªå‘½ä»¤çš„IDä¸€æ ·ï¼Œé‚£ä¹ˆå…¶å†…å®¹å¿…å®šä¹Ÿä¸€æ ·ï¼›å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹éƒ½æœ‰è®¤å¯äº†ç¼–å·ä¸ºpçš„å‘½ä»¤ï¼Œé‚£ä¹ˆæ‰€æœ‰ç¼–å·å°äºpçš„å‘½ä»¤ä¹Ÿå¿…å®šä¿æŒä¸€è‡´ã€‚ï¼ˆè¢«ç§°ä¸ºLog Matching Propertyï¼‰&lt;/p>
&lt;p>Raftä¸ºäº†ç®€åŒ–ç®—æ³•çš„å·¥ç¨‹å®ç°ï¼ŒæŠŠèŠ‚ç‚¹çš„çŠ¶æ€æŠ½è±¡ä¸ºä¸¥æ ¼append onlyçš„æ—¥å¿—ã€‚å³æˆ‘ä»¬å¯ä»¥å°†æ—¥å¿—æŒ‡é’ˆå‘åæˆ–å‘å‰ç§»åŠ¨ï¼Œæ¥â€œå›æ»šâ€æˆ–â€œæ›´æ–°â€çŠ¶æ€ã€‚ä½†æ˜¯ç»å¯¹ä¸å…è®¸åœ¨æ—¥å¿—ä¸­é—´æ·»åŠ æˆ–åˆ é™¤æ—¥å¿—æ¡ç›®ã€‚æ‰€ä»¥ï¼Œåœ¨Leaderå‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚æœleaderå’Œå…¶ä»–followerä¹‹é—´çš„æ—¥å¿—ä¸åŒï¼Œé‚£ä¹ˆfolloweréœ€è¦å›æ»šæ—¥å¿—ä»¥ä¿æŒå’Œleaderæ—¥å¿—çš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;h3 id="å®‰å…¨æ€§">å®‰å…¨æ€§ &lt;a href="#%e5%ae%89%e5%85%a8%e6%80%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="ä¸å½’æˆ‘ç®¡çš„äº‹æˆ‘ä¸æ‹¿ä¸»æ„">ä¸å½’æˆ‘ç®¡çš„äº‹æˆ‘ä¸æ‹¿ä¸»æ„ &lt;a href="#%e4%b8%8d%e5%bd%92%e6%88%91%e7%ae%a1%e7%9a%84%e4%ba%8b%e6%88%91%e4%b8%8d%e6%8b%bf%e4%b8%bb%e6%84%8f" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>å‰æ–‡æˆ‘ä»¬è¯´åˆ°ï¼Œä¸€ä¸ªèŠ‚ç‚¹è¦æˆä¸ºLeaderï¼Œä¸€å®šè¦æ‹¥æœ‰æ‰€æœ‰å·²ç»è¢«ACKçš„çŠ¶æ€ï¼Œå¦åˆ™å°±ä¼šè¢«å…¶å®ƒèŠ‚ç‚¹é©³å›ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ç°å®éƒ½ä¼šå‡ºç°ä¸€äº›å°å°çš„æ„å¤–ã€‚åœ¨ç³»ç»Ÿçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ä¸€äº›ææ¡ˆåªè¢«å°‘æ•°èŠ‚ç‚¹è®¤å¯ï¼Œä¸æ­¤åŒæ—¶å‘èµ·ææ¡ˆçš„Leaderæ„å¤–é€€å‡ºã€‚é‚£ä¹ˆåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šçš„æ—¥å¿—ä¼šäº§ç”Ÿâ€œåˆ†å‰â€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è§£å†³æ—¥å¿—å½“ä¸­çš„å†²çªå‘¢ï¼Ÿ&lt;/p>
&lt;p>å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºè¿™äº›ä»¥å°‘æ•°èŠ‚ç‚¹è®¤å¯çš„ææ¡ˆå¹¶æ²¡æœ‰è¢«ç¡®è®¤ã€‚æ‰€ä»¥æˆ‘ä»¬æ— è®ºæ˜¯æ¥å—ææ¡ˆè¿˜æ˜¯é©³å›ææ¡ˆï¼Œéƒ½ä¸å½±å“æˆ‘ä»¬å¼ºä¸€è‡´æ€§çš„è¦æ±‚ã€‚æ‰€ä»¥å…³é”®æ˜¯å¤„ç†å†²çªï¼Œä½¿å…¶ä¸äº§ç”Ÿå½±å“ç³»ç»Ÿä¸€è‡´æ€§çš„åæ•ˆã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/18-12-02/Snipaste_2018-12-02_17-34-59.png" alt="">&lt;/p>
&lt;p>å‡è®¾åœ¨Term1ï¼Œæœ€åä¸€ä¸ªææ¡ˆæ˜¯&amp;quot;Value:3&amp;quot;ï¼Œè¿™ä¸ªææ¡ˆå¹¶æ²¡æœ‰å¾—åˆ°å¤šæ•°èŠ‚ç‚¹çš„è®¤å¯ï¼ŒLeaderå°±æŒ‚æ‰äº†ã€‚é€‰å‡ºæ¥äº†ä¸€ä¸ªæ–°Leaderï¼ŒTermæ•°åŠ 1ã€‚åœ¨Term2ï¼Œè¢«æå‡ºçš„ç¬¬ä¸€ä¸ªææ¡ˆæ˜¯&amp;quot;Value:1&amp;quot;ï¼Œè¿™ä¸ªææ¡ˆä¹Ÿæ²¡æœ‰å¾—åˆ°å¤šæ•°èŠ‚ç‚¹çš„è®¤å¯ï¼ŒLeaderä¹ŸæŒ‚æ‰äº†ã€‚&lt;/p>
&lt;p>å› ä¸ºè¿™ä¸¤ä¸ªåˆ†å‰çš„ææ¡ˆéƒ½æ²¡æœ‰å¾—åˆ°å¤šæ•°èŠ‚ç‚¹çš„è®¤å¯ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªLeaderå¯èƒ½å·²ç»ç¡®è®¤è¿™ä¸¤ä¸ªææ¡ˆï¼Œæˆ–è€…ä¸¤ä¸ªä¸­çš„ä¸€ä¸ªï¼Œä¹Ÿå¯èƒ½ä¸€ä¸ªéƒ½æ²¡æœ‰ç¡®è®¤ã€‚æ–°çš„Leaderåœ¨è¢«é€‰å‡ºåï¼Œéœ€è¦é¢å¯¹çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å¤„ç†å±äºæ—§Termçš„ææ¡ˆã€‚&lt;/p>
&lt;p>è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š&lt;/p>
&lt;ol>
&lt;li>æ–°Leaderå°†æ—¥å¿—ä¸­ä»æ²¡æœ‰è¢«å¤šæ•°èŠ‚ç‚¹è®¤å¯çš„ææ¡ˆé‡æ–°æå‡ºï¼Œç›´åˆ°è¢«å¤šæ•°èŠ‚ç‚¹è®¤å¯ä¸ºæ­¢&lt;/li>
&lt;li>æ–°Leaderå¿½ç•¥å±äºæ—§çš„Termçš„ææ¡ˆï¼Œåªæäº¤å±äºæœ¬Termçš„ææ¡ˆï¼›å¯¹äºæ—¥å¿—å†²çªï¼Œä½¿ç”¨å¤åˆ¶æ—¥å¿—çš„æ–¹æ³•è§£å†³ï¼Œä½†ä¸ä¼šæ˜¾å¼è®¤å¯æ—§Termçš„ææ¡ˆã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/18-12-02/Snipaste_2018-12-02_22-02-45.png" alt="">&lt;/p>
&lt;p>å¯¹äºæ–¹æ¡ˆ1ï¼Œæœ‰ä¸€ä¸ªéšå«çš„é—®é¢˜ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨æ—¶é—´ç‚¹1ï¼ŒS2ä¸ºLeaderï¼Œæ ‡çº¢çš„ä¸¤ä¸ªææ¡ˆå¹¶æ²¡æœ‰è¢«ç¡®è®¤ã€‚æ­¤æ—¶å¦‚æœLeaderåœ¨æ—¶é—´ç‚¹2é‡æ–°æå‡º&amp;quot;Term1/Value3&amp;quot;ï¼Œå¹¶ä¸”å¾—åˆ°äº†S1å’ŒS2çš„è®¤å¯ï¼Œé‚£ä¹ˆè¿™æ¡ææ¡ˆå·²ç»è¢«å¤šæ•°èŠ‚ç‚¹è®¤å¯ã€‚ä½†æ˜¯åœ¨æ—¶é—´ç‚¹3ï¼ŒS3è¢«é€‰ä¸¾ä¸ºäº†Leaderã€‚S1å’ŒS2éœ€è¦å›æ»šæ—¥å¿—ä»¥ä¿æŒä¸S3æ—¥å¿—çš„ä¸€è‡´ã€‚æ­¤æ—¶å°±å‡ºç°äº†ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯å·²ç»è¢«ç¡®è®¤çš„æ—¥å¿—è¢«å›æ»šæ‰äº†ï¼Œå¼ºä¸€è‡´æ€§å°±ä¸èƒ½æ»¡è¶³äº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/18-12-02/Snipaste_2018-12-02_22-12-50.png" alt="">&lt;/p>
&lt;p>å¦‚æœæˆ‘ä»¬é‡‡ç”¨æ–¹æ¡ˆ2ï¼Œé‚£ä¹ˆè¢«é€‰å‡ºçš„æ–°Leaderæå‡ºçš„ç¬¬ä¸€ä¸ªææ¡ˆçš„Termä¸€å®šä¸º3ã€‚ç¡®è®¤æ–°ææ¡ˆçš„èŠ‚ç‚¹æ¥ä¸‹æ¥ä¼šå¤åˆ¶Leaderçš„æ—¥å¿—ï¼Œå›æ»šæ‰æ²¡æœ‰è¢«è®¤å¯çš„ææ¡ˆ&amp;quot;Term2/Value1&amp;quot;ã€‚å¯¹äºæ ‡ç»¿çš„&amp;quot;Term1/Value3&amp;quot;ï¼Œè™½ç„¶è¢«å¤åˆ¶åˆ°äº†å…¶å®ƒçš„èŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªå€¼å¹¶ä¸ä¼šè¢«ç¡®è®¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬æ—¢ä¿è¯äº†å·²ç»è¢«ç¡®è®¤çš„ææ¡ˆä¸ä¼šè¢«å›æ»šï¼Œåˆä¿è¯äº†æ—¥å¿—çš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>åœ¨å…·ä½“å®ç°ä¸­ï¼Œâ€œT3/V1â€å¾€å¾€æ˜¯ä¸€ä¸ªç©ºå‘½ä»¤(no-op)ã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿æ²¡æœ‰å†™è¯·æ±‚ï¼ŒLeaderå°±å¯ä»¥æ›´å¿«çš„ç¡®è®¤æ–°çš„ä»»æœŸå¹¶åŒæ­¥Logäº†ã€‚&lt;/p>
&lt;h4 id="å¦‚ä½•è¯æ˜">å¦‚ä½•è¯æ˜ &lt;a href="#%e5%a6%82%e4%bd%95%e8%af%81%e6%98%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>é‚£ä¹ˆæ€ä¹ˆä¿è¯ä¸Šé¢çš„ä½œæ³•å®ƒæ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿ&lt;/p>
&lt;p>å‡è®¾å½“å‰ä»»æœŸä¸ºT1ï¼Œæ­¤æ—¶ç”±äºç³»ç»Ÿæ•…éšœï¼Œæˆ‘ä»¬é€‰å‡ºäº†æ–°çš„Leader - S2ï¼Œå¹¶è®°Termä¸ºT2ã€‚å› ä¸ºæˆ‘ä»¬ä¸¥æ ¼éµå®ˆäº†Log Matching Propertyã€‚&lt;/p>
&lt;p>é‚£ä¹ˆï¼Œå¯¹äºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š&lt;/p>
&lt;ol>
&lt;li>T2çš„Leaderå’ŒVoterçš„Logä¸­æœ€åä¸€ä¸ªææ¡ˆçš„ç¼–å·æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ä»–ä»¬æ—¥å¿—ä¸­çš„ææ¡ˆéƒ½æ˜¯å®Œå…¨ä¸€è‡´çš„&lt;/li>
&lt;li>T2ä¸­Leaderçš„Logæ¯”Voteræ›´æ–°ï¼Œé‚£ä¹ˆLeaderä¸€å®šåŒ…å«æ¯”Voteræ›´å¤šçš„ææ¡ˆï¼›å¦åˆ™Voterå°±ä¸ä¼šç»™LeaderæŠ•ç¥¨&lt;/li>
&lt;/ol>
&lt;p>æˆ‘ä»¬éƒ½å¯ä»¥è¯æ˜ï¼Œå¯¹äºå‰ä¸€ä¸ªTermå·²ç»è¢«ç¡®è®¤çš„ææ¡ˆï¼Œä¸€å®šä¼šè¢«åŒ…å«åœ¨åä¸€ä¸ªTermçš„æ—¥å¿—ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªè¢«ç¡®è®¤çš„ææ¡ˆä¸ä¼šä¸­é€”ä¸¢å¤±ã€‚&lt;/p>
&lt;h2 id="æˆå‘˜å˜åŒ–">æˆå‘˜å˜åŒ– &lt;a href="#%e6%88%90%e5%91%98%e5%8f%98%e5%8c%96" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä»¥ä¸Šæˆ‘ä»¬çš„è®¨è®ºéƒ½åŸºäºç³»ç»Ÿçš„èŠ‚ç‚¹ä¸ä¼šå‘ç”Ÿå˜æ›´ï¼Œä½†æ˜¯åœ¨ç°å®å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾å¯¹æ­¤è¿›è¡Œä»»ä½•ä¿è¯ã€‚æ‰€ä»¥ä¸€ä¸ªå®ç”¨çš„ç³»ç»Ÿï¼Œä¸€å®šèƒ½è§£å†³æˆå‘˜å˜åŒ–çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>æˆå‘˜å˜åŒ–é—®é¢˜çš„æœ¬è´¨æ˜¯ç³»ç»Ÿä¸­ä¸èƒ½åŒæ—¶å‡ºç°ä¸¤ä¸ªLeaderã€‚&lt;/p>
&lt;p>åœ¨Raftä¸­ï¼Œæˆ‘ä»¬å°†è¿‡æ¸¡æœŸçš„é…ç½®ç§°ä¸ºâ€œå…±åŒä¸€è‡´â€ï¼ˆjoint consensusï¼‰ï¼Œä¸€ä½†å®ƒè¢«ç¡®è®¤ï¼Œè¯´æ˜ç³»ç»Ÿå·²ç»è¿‡æ¸¡åˆ°äº†æ–°çš„æˆå‘˜é…ç½®ã€‚&lt;/p>
&lt;p>å…·ä½“çš„ç­–ç•¥å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>ç³»ç»Ÿä¸­åªæœ‰æ—§çš„é…ç½®C_oldï¼Œæ–°åŠ å…¥çš„æˆå‘˜ä¸å¯èƒ½æˆä¸ºLeader&lt;/li>
&lt;li>å½“å‰ç³»ç»Ÿçš„Leaderæ¥å—åˆ°æ–°çš„é…ç½®C_newã€‚ç„¶åLeaderå‘æ‰€æœ‰èŠ‚ç‚¹å‘èµ·ä¿®æ”¹é…ç½®ä¸ºC_old+newçš„ææ¡ˆã€‚&lt;/li>
&lt;li>å³ä½¿è¿™ä¸ªæ—¶é—´ç‚¹LeaderæŒ‚æ‰äº†ï¼Œæ–°çš„Leaderä¹Ÿåªä¼šæ‹¥æœ‰æ—§é…ç½®C_oldæˆ–è€…è¿‡æ¸¡æœŸé…ç½®C_old+newã€‚è¿™å–å†³äºLeaderé€‰ä¸¾çš„æ—¶æœºï¼ˆå’Œè¿æ°”ï¼‰ã€‚&lt;/li>
&lt;li>å½“è¿‡æ¸¡æœŸé…ç½®C_old+newè¢«å¤šæ•°èŠ‚ç‚¹ç¡®è®¤åï¼ŒLeaderå‘æ‰€æœ‰èŠ‚ç‚¹å‘èµ·ä¿®æ”¹é…ç½®ä¸ºC_newçš„ææ¡ˆã€‚&lt;/li>
&lt;li>å¦‚æœè¿™ä¸ªæ—¶é—´ç‚¹LeaderæŒ‚æ‰äº†ï¼Œæ–°Leaderä¼šä»æ‹¥æœ‰C_old+newå’ŒC_newçš„èŠ‚ç‚¹ä¸­é€‰å‡ºã€‚æ–°çš„Leaderä»ç„¶å¯ä»¥è¿›è¡Œé…ç½®çš„å˜æ›´ï¼Œè€Œä¸å½±å“æ•´ä¸ªç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚&lt;/li>
&lt;li>ç›´åˆ°C_newè¢«ç¡®è®¤ï¼Œé…ç½®æ›´æ¢å®£å‘Šå®Œæˆã€‚&lt;/li>
&lt;/ol>
&lt;p>â€œå…±åŒä¸€è‡´â€å…è®¸èŠ‚ç‚¹æ— éœ€è€ƒè™‘å®‰å…¨æ€§çš„æƒ…å†µä¸‹ï¼Œåœ¨ä»»æ„æ—¶é—´è¿›è¡Œé…ç½®çš„æ›´æ¢ã€‚é…ç½®çš„æ›´æ¢ä¹Ÿä¸ä¼šå½±å“å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚&lt;/p>
&lt;p>ä»¥ä¸Šæˆ‘ä»¬è§£å†³çš„æ˜¯å®‰å…¨æ€§é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ç¨‹ä¸­æˆ‘ä»¬è¿˜éœ€è¦å…¼é¡¾æ•ˆç‡é—®é¢˜ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚æ–°åŠ å…¥çš„èŠ‚ç‚¹å¯ä»¥è§†ä½œâ€œnon-voting membersâ€ï¼ŒåªåŒæ­¥æ•°æ®ï¼Œä¸èƒ½å¯¹ææ¡ˆè¿›è¡ŒæŠ•ç¥¨ã€‚ç›´åˆ°æ•°æ®åŒæ­¥åŸºæœ¬å®Œæˆï¼Œæ‰è¿›è¡Œé…ç½®å˜æ›´ã€‚è¿™æ ·é¿å…äº†æ–°çš„èŠ‚ç‚¹ç”±äºç¼ºå°‘Logä¸èƒ½åŠæ—¶çš„å¤„ç†ææ¡ˆã€‚&lt;/p>
&lt;p>åˆå¦‚æ–°çš„æˆå‘˜åˆ—è¡¨ä¸­ï¼Œä¸åŒ…å«åŸå…ˆçš„LeaderèŠ‚ç‚¹ã€‚åœ¨æ—§Leaderè®¤å¯äº†æ–°çš„é…ç½®ææ¡ˆä¹‹åï¼Œå°±å¯ä»¥é€€ä½è®©è´¤ï¼Œè®©å…¶å®ƒèŠ‚ç‚¹é€‰ä¸¾å‡ºæ–°çš„Leaderã€‚&lt;/p>
&lt;p>ä»¥åŠè¢«æ¸…é™¤å‡ºæˆå‘˜åˆ—è¡¨çš„èŠ‚ç‚¹ï¼Œä¸ä¼šæ”¶åˆ°åç»­çš„å¿ƒè·³ï¼Œå®ƒä»¬ä¼šè®¤ä¸ºLeaderå·²ç»å¤±æ•ˆï¼Œæ‰€ä»¥è‡ªå·±è·³å‡ºæ¥ç«é€‰Leaderã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¼šè§¦å‘æ–°çš„ï¼ˆæ— æ„ä¹‰ çš„ï¼‰Leaderé€‰ä¸¾ï¼Œå½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…æ”¶åˆ°äº†Leaderçš„å¿ƒè·³ï¼Œé‚£ä¹ˆå°±ä¼šå¿½ç•¥Leaderçš„ç«é€‰è¯·æ±‚ã€‚è¿™æ ·æ—¢ä¸ä¼šå½±å“æ­£å¸¸çš„é€‰ä¸¾ï¼Œåˆå¯ä»¥å±è”½æ— æ•ˆçš„é€‰ä¸¾è¯·æ±‚ã€‚&lt;/p>
&lt;h2 id="å¿«ç…§">å¿«ç…§ &lt;a href="#%e5%bf%ab%e7%85%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æˆ‘ä»¬çš„ææ¡ˆè¶Šæ¥è¶Šå¤šï¼Œæ—¥å¿—ä¹Ÿè¶Šæ¥è¶Šé•¿ã€‚éšä¹‹è€Œæ¥çš„æ˜¯æ¼«é•¿çš„æ¢å¤æ—¶é—´ä»¥åŠç£ç›˜ç©ºé—´çš„æµªè´¹ã€‚å¿«ç…§æŠ€æœ¯å¯ä»¥å¸®æˆ‘ä»¬æ¸…é™¤æ—§çš„æ— ç”¨æ—¥å¿—ï¼Œåªä¿ç•™æœ‰ç”¨çš„çŠ¶æ€ä¿¡æ¯ã€‚&lt;/p>
&lt;p>åœ¨Raftç®—æ³•ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½èƒ½è‡ªä¸»çš„ç”Ÿæˆå¿«ç…§ã€‚å¥½å¤„æ˜¯é¿å…Leaderåˆ†å‘å¿«ç…§é€ æˆçš„æ•ˆç‡é™ä½ï¼Œä¹Ÿç®€åŒ–äº†Leaderçš„åŠŸèƒ½å’ŒèŒè´£ã€‚åˆç”±äºæ—¥å¿—çš„â€œTCPç‰¹æ€§â€ï¼Œæ‰€ä»¥ä¸åŒèŠ‚ç‚¹ä¸Šï¼Œåªè¦ä¿è¯ææ¡ˆç¼–å·ä¸€è‡´ï¼Œé‚£ä¹ˆå…¶å†…å®¹å°±å¯ä»¥ä¿è¯ä¸€è‡´ã€‚&lt;/p>
&lt;h2 id="å®¢æˆ·ç«¯äº¤äº’">å®¢æˆ·ç«¯äº¤äº’ &lt;a href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e4%ba%a4%e4%ba%92" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ç”±äºå®¢æˆ·ç«¯ä¸äº†è§£ç³»ç»Ÿå†…éƒ¨çš„é€‰ä¸¾æƒ…å†µï¼Œæ‰€ä»¥åœ¨å¼€å§‹é€šä¿¡æ—¶ï¼Œä¼šéšæœºé€‰ä¸€å°èŠ‚ç‚¹å‘é€è¯·æ±‚ã€‚å¦‚æœè¿™ä¸ªèŠ‚ç‚¹ä¸æ˜¯Leaderï¼Œå°±ä¼šæ‹’ç»è¿™ä¸ªè¯·æ±‚ï¼Œä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯å“ªä¸ªèŠ‚ç‚¹æ˜¯å½“å‰ä»»æœŸçš„Leaderã€‚å¦‚æœLeaderå¤±æ•ˆï¼Œå®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶ï¼Œå°±ä¼šé‡æ–°éšæœºé€‰æ‹©èŠ‚ç‚¹ï¼Œè·å–æ–°ä»»Leaderä¿¡æ¯ã€‚&lt;/p>
&lt;p>å¯¹äºå®¢æˆ·ç«¯å‘é€çš„å†™è¯·æ±‚ï¼ŒLeaderéœ€è¦è®°å½•å…¶å”¯ä¸€çš„è¯·æ±‚IDï¼Œä»¥é¿å…å®¢æˆ·ç«¯å‘é€çš„é‡å¤è¯·æ±‚ã€‚&lt;/p>
&lt;p>å¯¹äºå®¢æˆ·ç«¯å‘é€çš„è¯»è¯·æ±‚ï¼ŒLeaderéœ€è¦å†æ¬¡ç¡®è®¤å®ƒæ˜¯ä»æ˜¯å½“å‰ä»»æœŸçš„Leaderï¼Œé¿å…å‘å®¢æˆ·ç«¯å‘é€è¿‡æœŸæ•°æ®ã€‚å¦‚æœå¯¹æ•°æ®æ­£ç¡®æ€§å’Œæ—¶æ•ˆæ€§çš„æ•æ„Ÿæ€§ä¸é«˜ï¼Œå°±å¯ä»¥å‘ç³»ç»Ÿä¸­çš„ä»»æ„èŠ‚ç‚¹å‘é€è¯·æ±‚ï¼Œ&lt;/p>
&lt;h2 id="å†™åœ¨åé¢">å†™åœ¨åé¢ &lt;a href="#%e5%86%99%e5%9c%a8%e5%90%8e%e9%9d%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Paxosçš„äº®ç‚¹åœ¨äºæŠŠå¤æ‚çš„ä¸œè¥¿è¯´ç®€å•äº†ã€‚è€ŒRaftçš„äº®ç‚¹æ˜¯æŠŠç®€å•çš„ä¸œè¥¿å…·ä½“åŒ–ï¼Œä½¿ä¹‹æˆä¸ºèƒ½è½åœ°çš„å·¥ç¨‹é¡¹ç›®ã€‚&lt;/p>
&lt;p>ä½†æ˜¯Paxosåšä¸ºä¸€ç§Quorumåè®®ï¼ˆä¿—ç§°P2Pï¼‰ï¼Œå…¶å·¥ç¨‹å¤æ‚æ€§æ˜¯éš¾ä»¥é¿å…çš„ã€‚Raftåœ¨Paxosåè®®ä¸Šé¢åŠ å…¥äº†å¾ˆå¤šé™åˆ¶ä»¥ç®€åŒ–å®ç°ï¼Œä½†æ˜¯æƒ³è¦å®Œæ•´çš„å®ç°å…¶åŠŸèƒ½ä»ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ã€‚ï¼ˆæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥&lt;a href="https://pdos.csail.mit.edu/6.824/labs/lab-raft.html">æŒ‘æˆ˜ä¸€ä¸‹è‡ªå·±&lt;/a>ï¼‰&lt;/p>
&lt;p>ä¸‹é¢ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šæ¢ä¸€ç§æ–°æ€è·¯ï¼Œå­¦ä¹ PecificAç®—æ³•ï¼Œçœ‹ä¸€çœ‹å¦‚ä½•ä½¿ç”¨Paxoså®ç°ä¸€ä¸ªä¸»ä»å¤åˆ¶åè®®ã€‚&lt;/p>
&lt;h2 id="å†™åœ¨æ›´åé¢">å†™åœ¨æ›´åé¢ &lt;a href="#%e5%86%99%e5%9c%a8%e6%9b%b4%e5%90%8e%e9%9d%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¸ªäººè§‰å¾—ï¼ŒRaftè®ºæ–‡çš„ä¸€ä¸ªæ›´å¤§äº®ç‚¹æ˜¯å……åˆ†çš„æ€è€ƒäº†Paxos/Multi-Paxosåœ¨å·¥ç¨‹å®è·µä¸Šçš„ç¼ºé™·ã€‚æ€è€ƒå¹¶æå‡ºæœ‰ä»·å€¼çš„è´¨ç–‘ï¼Œè€Œä¸æ˜¯è¢«ä»–äººçš„è§‚ç‚¹å¸¦ç€èµ°ï¼ŒçœŸçš„æ˜¯æœ€é‡è¦çš„èƒ½åŠ›ä¹‹ä¸€äº†ã€‚&lt;/p>
&lt;p>å¤§èƒ†çŒœæµ‹æ˜¯å› ä¸ºæœ‰è¶³å¤Ÿçš„ç†è§£èƒ½åŠ›ï¼Œæœ‰é¢å¤–çš„å¸¦å®½å»å‘é—®ï¼Ÿè¿™æ˜¯ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜ã€‚&lt;/p></description></item><item><title>ç™½è¯ä¸€è‡´æ€§åè®® - Paxosã€Raftå’ŒPacificA[0]</title><link>https://wizmann.top/posts/paxos-raft-pecifaca0/</link><pubDate>Sun, 25 Nov 2018 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/paxos-raft-pecifaca0/</guid><description>&lt;h2 id="ä¸€è‡´æ€§åè®®---paxos">ä¸€è‡´æ€§åè®® - Paxos &lt;a href="#%e4%b8%80%e8%87%b4%e6%80%a7%e5%8d%8f%e8%ae%ae---paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå½“ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ä¿æŒèŠ‚ç‚¹ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è®©ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹ç›¸äº’åè°ƒé€šåŠ›åˆä½œï¼Œæœ‰å¯èƒ½çš„è®©ç³»ç»Ÿæ­£ç¡®çš„å·¥ä½œã€‚ä½†æ˜¯ï¼Œç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿæœ¬èº«çš„ç‰¹æ€§ï¼Œéœ€è¦æˆ‘ä»¬åœ¨ä¸å¯é çš„ç¡¬ä»¶ä¸Šå°½å¯èƒ½çš„æ„å»ºå¯é çš„ç³»ç»Ÿã€‚æ‰€ä»¥ï¼Œçœ‹ä¼¼ç®€å•çš„ä¸€è‡´æ€§é—®é¢˜æˆä¸ºäº†åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸçš„ä¸€ä¸ªé‡è¦çš„è¯¾é¢˜ã€‚&lt;/p>
&lt;p>Paxosç®—æ³•æ˜¯Leslie Lamportäº1990å¹´æå‡ºçš„ä¸€ç§ä¸€è‡´æ€§ç®—æ³•ã€‚ä¹Ÿæ˜¯ç›®å‰å…¬è®¤è§£å†³åˆ†å¸ƒå¼ä¸€è‡´æ€§é—®é¢˜æœ€æœ‰æ•ˆçš„ç®—æ³•ä¹‹ä¸€ã€‚&lt;/p>
&lt;p>Paxosç®—æ³•çš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªä¸å¯é çš„åˆ†å¸ƒå¼ç³»ç»Ÿå†…ï¼Œåªé€šè¿‡ç½‘ç»œé€šä¿¡ï¼Œèƒ½å¤Ÿå¿«é€Ÿä¸”æ­£ç¡®åœ°åœ¨é›†ç¾¤å†…éƒ¨å¯¹æŸä¸ªæ•°æ®çš„å€¼è¾¾æˆä¸€è‡´ã€‚å¹¶ä¸”ä¿è¯ä¸è®ºå‘ç”Ÿä»»ä½•å¼‚å¸¸ï¼Œéƒ½ä¸ä¼šç ´åç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;h2 id="paxosç®—æ³•">Paxosç®—æ³• &lt;a href="#paxos%e7%ae%97%e6%b3%95" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="å¦ä¸€ç§ç®€åŒ–äº†çš„å½¢è±¡çš„é—®é¢˜æè¿°---ä¹°è½¦ä½">å¦ä¸€ç§ï¼ˆç®€åŒ–äº†çš„ï¼‰å½¢è±¡çš„é—®é¢˜æè¿° - ä¹°è½¦ä½ &lt;a href="#%e5%8f%a6%e4%b8%80%e7%a7%8d%e7%ae%80%e5%8c%96%e4%ba%86%e7%9a%84%e5%bd%a2%e8%b1%a1%e7%9a%84%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0---%e4%b9%b0%e8%bd%a6%e4%bd%8d" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æŸå°åŒºçš„ä¸€äº›å±…æ°‘åœ¨æŠ¢è½¦ä½ï¼Œè€Œè½¦ä½åªæœ‰ä¸€ä¸ªã€‚å±…æ°‘ä»¬è¾¾æˆåè®®ï¼Œåªè¦ä¸€ä¸ªæŠ¥ä»·è·å¾—åŠæ•°ä»¥ä¸Šå±…æ°‘è®¤å¯ï¼Œé‚£ä¹ˆæå‡ºè¿™ä¸ªå‡ºä»·çš„å±…æ°‘åˆ™è·å¾—äº†è½¦ä½çš„æ‰€æœ‰æƒã€‚&lt;/p>
&lt;p>å±…æ°‘ä¹‹é—´éå¸¸å‹å–„ï¼Œå¦‚æœçŸ¥é“äº†è½¦ä½å·²ç»æœ‰äº†ä¹°å®¶ï¼Œå°±ä¸ä¼šç»§ç»­å‡ºä»·è´­ä¹°ï¼Œå¹¶ä¸”ä¼šå¸®å¿™ä¼ æ’­è¿™ä¸ªä¿¡æ¯ã€‚&lt;/p>
&lt;p>å±…æ°‘ä»¬éƒ½æ˜¯éµçºªå®ˆæ³•çš„å¥½å…¬æ°‘ï¼Œåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­éƒ½åªä¼šå¦‚å®çš„ä¸å…¶å®ƒç”¨æˆ·åˆ†äº«ä¿¡æ¯ã€‚ä¿¡æ¯çš„åˆ†äº«æ˜¯åœ¨ç½‘ä¸Šï¼Œé€šè¿‡ä¸€å¯¹ä¸€çš„ç§å¯†èŠå¤©è¿›è¡Œã€‚ä½†æ˜¯å°åŒºçš„æ‰‹æœºä¿¡å·éå¸¸å·®ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯é€šä¿¡çš„è´¨é‡ï¼Œä¸€äº›ä¿¡æ¯å¯èƒ½ä¼šä¸¢å¤±ã€‚ä½†æ˜¯å±…æ°‘ä¸ä¼šæ‰çº¿ã€‚ä¹Ÿä¸ä¼šå¤±å»è®°å¿†ï¼Œå¹¶ä¸”é€šä¿¡çš„å†…å®¹æ˜¯å®Œæ•´çš„ï¼Œä¸ä¼šè¢«ç¯¡æ”¹çš„ã€‚&lt;/p>
&lt;p>åˆ’é‡ç‚¹ï¼š&lt;/p>
&lt;ol>
&lt;li>éœ€è¦åŠæ•°ä»¥ä¸Šå±…æ°‘çš„è®¤å¯ï¼Œæ‰èƒ½å£°ç§°æ‹¥æœ‰è½¦ä½ã€‚è¿™ä¸ªå±…æ°‘è¢«ç§°ä¸ºè½¦ä½çš„â€œå…¬è®¤æ‹¥æœ‰è€…â€&lt;/li>
&lt;li>è½¦ä½æœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸€ä¸ªè½¦ä½ä¸èƒ½åŒæ—¶æœ‰ä¸¤ä¸ªâ€œå…¬è®¤æ‹¥æœ‰è€…â€&lt;/li>
&lt;li>è½¦ä½å¯ä»¥æš‚æ—¶æ²¡æœ‰æ‹¥æœ‰è€…ï¼Œä½†æ˜¯éœ€è¦å°½å¿«é€‰å‡ºä¸€ä¸ª&lt;/li>
&lt;li>é€šä¿¡æ˜¯ä¸å¯é çš„(not-reliable)ï¼Œä½†æ˜¯æ­£ç¡®æ€§(integrity)å’Œå¯æŒä¹…æ€§ï¼ˆdurabilityï¼‰æ˜¯å¯ä»¥ä¿è¯çš„&lt;/li>
&lt;li>æ•´ä¸ªæµç¨‹çš„ç›®æ ‡æ˜¯ç¡®å®šè½¦ä½çš„æ‹¥æœ‰è€…ã€‚æµç¨‹çš„å‚ä¸è€…ä¸ä¼šä»¥è‡ªå·±æ‹¥æœ‰è½¦ä½ä¸ºæœ€ç»ˆç›®æ ‡&lt;/li>
&lt;/ol>
&lt;h3 id="å¦‚ä½•é€‰å‡ºæœ€ç»ˆçš„ä¹°å®¶">å¦‚ä½•é€‰å‡ºæœ€ç»ˆçš„ä¹°å®¶ &lt;a href="#%e5%a6%82%e4%bd%95%e9%80%89%e5%87%ba%e6%9c%80%e7%bb%88%e7%9a%84%e4%b9%b0%e5%ae%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç”±äºé€šä¿¡æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå¯¹äºæ‰€æœ‰å‚ä¸è€…æ¥è¯´ï¼Œä»–ä»¬å¯¹æ•´ä¸ªç³»ç»Ÿçš„äº†è§£éƒ½æ˜¯ç‰‡é¢çš„ã€è¿‡æ—¶çš„ã€‚ä½†æ˜¯å‚ä¸è€…ä¼šé€šè¿‡ä¸å…¶å®ƒå‚ä¸è€…è¿›è¡Œé€šä¿¡ï¼Œä¸æ–­è·å¾—æ›´åŠæ—¶çš„ä¿¡æ¯ï¼Œä»è€Œæœ€ç»ˆè¾¾æˆä¸€è‡´ã€‚&lt;/p>
&lt;p>å¯¹äºæ™®é€šå±…æ°‘ï¼Œä¼šè®°å½•â€œå·²çŸ¥æœ€é«˜æŠ¥ä»·â€å’Œâ€œå·²ç¡®è®¤æŠ¥ä»·â€ä¸¤ä¸ªçŠ¶æ€ã€‚ä¼šå¤„ç†ä¸¤ç§è¯·æ±‚ï¼š&lt;/p>
&lt;ol>
&lt;li>è¯¢ä»·ï¼šå¦‚æœå±…æ°‘å·²ç¡®è®¤äº†æŸä¸ªæŠ¥ä»·ï¼Œåˆ™è¿”å›è¿™ä¸ªæŠ¥ä»·ã€‚å¦åˆ™ä¼šå°è¯•æ›´æ–°å·²çŸ¥æœ€é«˜æŠ¥ä»·ï¼Œå¹¶æŠ¥å‘Šä¹°å®¶å½“å‰çš„æœ€é«˜æŠ¥ä»·&lt;/li>
&lt;li>æŠ¥ä»·ï¼šå±…æ°‘ä¼šå°†è¯·æ±‚ä¸­çš„æŠ¥ä»·ä¸è‡ªå·±å·²çŸ¥çš„æœ€é«˜æŠ¥ä»·è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœé«˜äºæˆ–ç­‰äºæœ¬åœ°å·²ç»æŠ¥ä»·ï¼Œæ— è®ºæ˜¯å¦å·²ç»æœ‰å·²ç¡®è®¤æŠ¥ä»·ï¼Œéƒ½ä¼šç¡®è®¤è¿™ä¸ªæŠ¥ä»·&lt;/li>
&lt;/ol>
&lt;p>è€Œå¯¹äºä¹°å®¶ï¼Œä¼šå‘å‡ºä¸¤ç§ä¸åŒçš„ä¿¡æ¯ï¼š&lt;/p>
&lt;ol>
&lt;li>è¯¢ä»·ï¼šä»¥æŸä¸€ä¸ªæŠ¥ä»·é—®è¯¢å¤šæ•°å±…æ°‘ï¼Œå¦‚æœæœ‰å·²ç¡®è®¤çš„æŠ¥ä»·ï¼Œåˆ™æ”¾å¼ƒè‡ªå·±çš„æŠ¥ä»·ã€‚å¦‚æœè¿™ä¸ªæŠ¥ä»·ä½äºå±…æ°‘å·²çŸ¥çš„æŠ¥ä»·ï¼Œåˆ™æé«˜æŠ¥ä»·ã€‚&lt;/li>
&lt;li>æŠ¥ä»·ï¼šå¦‚æœè¯¢ä»·è¿‡ç¨‹ä¸­æ”¶åˆ°äº†å·²ç¡®è®¤çš„æŠ¥ä»·ï¼Œåˆ™å¸®å¿™è½¬å‘è¿™ä¸ªæŠ¥ä»·ã€‚å¦åˆ™å‘é€è‡ªå·±çš„æŠ¥ä»·ï¼Œå¦‚æœæŠ¥ä»·è·å¾—äº†å¤šæ•°å±…æ°‘çš„è®¤å¯ï¼Œå³å¯ä»¥è®¤ä¸ºæ‰€æœ‰æƒå·²ç»æ›´æ–°&lt;/li>
&lt;/ol>
&lt;h3 id="ä¸€è‡´æ€§çš„ç›´è§‚è¯æ˜">ä¸€è‡´æ€§çš„ç›´è§‚è¯æ˜ &lt;a href="#%e4%b8%80%e8%87%b4%e6%80%a7%e7%9a%84%e7%9b%b4%e8%a7%82%e8%af%81%e6%98%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æŠ¥ä»·é˜¶æ®µï¼Œé™¤äº†ä¿è¯æ­£ç¡®æ€§ä¹‹å¤–ï¼Œå¯¹äºå±…æ°‘å’Œä¹°å®¶å¹¶æ²¡æœ‰ä»»ä½•çº¦æŸã€‚å…¶æœ¬è´¨å‚ä¸è€…ä¹‹é—´åŒæ­¥ä¿¡æ¯çš„è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>è€Œä¸€è‡´æ€§åœ¨æŠ¥ä»·é˜¶æ®µå¯ä»¥è¢«å¾ˆå¥½çš„ä¿è¯&lt;/p>
&lt;ul>
&lt;li>å¦‚æœè½¦ä½è¿˜æ²¡æœ‰ä¸»äººï¼Œé‚£ä¹ˆå¤§å®¶å°±æ‹¼ä¸€æ‹¼è¿æ°”å’Œæ‰‹é€Ÿï¼Œç›´åˆ°æœ‰ä¸€ä¸ªä¹°å®¶è·å¾—äº†åŠæ•°å±…æ°‘çš„è®¤å¯ã€‚&lt;/li>
&lt;li>å¦‚æœç”¨æˆ·Aå·²ç»å£°æ˜ä»¥ä»·æ ¼Pä¹°å…¥è½¦ä½ï¼ˆè®°ä¸º&lt;code>(P, A)&lt;/code>ï¼‰ï¼Œæ­¤æ—¶å¿…æœ‰å¤šæ•°å±…æ°‘å·²ç»è®¤å¯&lt;code>(P, A)&lt;/code>ã€‚å¦‚æœç”¨æˆ·Bæƒ³è¦å£°æ˜ä»¥ä»·æ ¼Q(Q &amp;gt;= P)ä¹°å…¥è½¦ä½ï¼Œé¦–å…ˆéœ€è¦å‘å¤šæ•°å±…æ°‘è¯¢ä»·ï¼Œåœ¨è¯¢ä»·çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šä¼šæ”¶åˆ°ç”¨æˆ·Aå·²ç»æ‹¥æœ‰è½¦ä½çš„ä¿¡æ¯ï¼Œæ­¤æ—¶Båªä¼šå¸®Aæ‰©æ•£ä¿¡æ¯ï¼Œè€Œä¸ä¼šå»äº‰å¤ºæ‹¥æœ‰æƒã€‚ç³»ç»Ÿæœ€ç»ˆä¼šè¾¾åˆ°ä¸€ä¸ªç¨³å®šçš„çŠ¶æ€ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="å¤±å¿†---æ”¾æ¾å¯æŒä¹…æ€§è¦æ±‚">å¤±å¿† - æ”¾æ¾å¯æŒä¹…æ€§è¦æ±‚ &lt;a href="#%e5%a4%b1%e5%bf%86---%e6%94%be%e6%9d%be%e5%8f%af%e6%8c%81%e4%b9%85%e6%80%a7%e8%a6%81%e6%b1%82" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¦‚æœæˆ‘ä»¬æ”¾æ¾å¯æŒä¹…æ€§çš„é™åˆ¶ã€‚å³å±…æ°‘å¯ä»¥æ‰çº¿ï¼Œæˆ–è€…æ¸…ç©ºè‡ªå·±çš„è®°å¿†ã€‚é‚£æ­¤æ—¶æœ€å·®æƒ…å†µæ˜¯å¤šæ•°å·²ç»ç¡®è®¤æŠ¥ä»·çš„å±…æ°‘ä¸å†æ‰¿è®¤æŠ¥ä»·ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±æœ‰å¯èƒ½é€€åŒ–åˆ°â€œä»æ²¡æœ‰äººæ‹¥æœ‰è½¦ä½â€çš„çŠ¶æ€ã€‚æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦å†è¿›è¡Œä¸€è½®é€‰ä¸¾ï¼Œé€‰å‡ºè½¦ä½æ–°çš„ä¸»äººå³å¯ã€‚è¿™å¹¶ä¸ä¼šç ´åæ•´ä¸ªç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;h3 id="æ—è§‚è€…è§†è§’">æ—è§‚è€…è§†è§’ &lt;a href="#%e6%97%81%e8%a7%82%e8%80%85%e8%a7%86%e8%a7%92" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å‡å¦‚æˆ‘ä»¬åšä¸ºæ—è§‚è€…ï¼Œæƒ³è¦è§‚å¯Ÿæ˜¯è°æœ€ç»ˆæ‹¥æœ‰äº†è½¦ä½ã€‚å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š&lt;/p>
&lt;ol>
&lt;li>â€œæ¨â€æ¨¡å‹&lt;/li>
&lt;/ol>
&lt;p>å½“æ–°çš„ä¹°å®¶è¢«é€‰ä¸¾å‡ºæ¥æ—¶ï¼Œæ–°ä¹°å®¶ä¼šé€šçŸ¥æ‰€æœ‰æ—è§‚è€…è½¦ä½çš„æ‹¥æœ‰è€…å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™æ ·è§‚å¯Ÿè€…ä»¬å¯ä»¥å®æ—¶çš„è·å¾—çŠ¶æ€çš„å˜åŒ–ï¼Œä½†æ˜¯ç”±äºé€šä¿¡æ˜¯ä¸å¯é çš„ï¼Œæ—è§‚è€…å¯èƒ½ä¼šé”™è¿‡çŠ¶æ€å˜åŒ–çš„ä¿¡æ¯ã€‚å¦‚æœè¿™ç§æƒ…å†µå‡ºç°ï¼Œè§‚å¯Ÿè€…åªèƒ½ç­‰å¾…ä¸‹æ¬¡çŠ¶æ€å˜åŒ–ï¼Œæ‰èƒ½æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>â€œæ‹‰â€æ¨¡å‹&lt;/li>
&lt;/ol>
&lt;p>æ—è§‚è€…å¯ä»¥å‡è£…è‡ªå·±æ˜¯ä¸€ä¸ªä¹°å®¶ï¼Œå‘å¤šæ•°å±…æ°‘è¿›è¡Œè¯¢ä»·ã€‚å¦‚æœæœ€ç»ˆä¹°å®¶å·²ç»ç¡®å®šï¼Œé‚£ä¹ˆè¯¢ä»·çš„å“åº”ä¸­ä¸€å®šåŒ…å«ç€æœ€æ–°çš„æ‹¥æœ‰è€…ä¿¡æ¯ã€‚&lt;/p>
&lt;h3 id="paxoså¦‚ä½•è§£å†³æ´»é”é—®é¢˜">Paxoså¦‚ä½•è§£å†³æ´»é”é—®é¢˜ &lt;a href="#paxos%e5%a6%82%e4%bd%95%e8%a7%a3%e5%86%b3%e6%b4%bb%e9%94%81%e9%97%ae%e9%a2%98" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å‡è®¾å±…æ°‘é‡Œæœ‰ä¹°å®¶Aã€Bï¼ŒåŒæ—¶å‘å…¶å®ƒå±…æ°‘æå‡ºè¯¢ä»·/æŠ¥ä»·ã€‚å¦‚æœä»–ä»¬çš„è¯¢ä»·/æŠ¥ä»·é¡ºåºæ’åˆ—å¦‚ä¸‹ï¼Œä¼šå‡ºç°ä»€ä¹ˆçŠ¶å†µå‘¢ï¼Ÿ&lt;/p>
&lt;pre tabindex="0">&lt;code>A: è¯¢ä»·ï¼Œ1å—
ä¼—å±…æ°‘ï¼šå¥½çš„ï¼Œæœ€é«˜ä»·ä¸º1å—
Bï¼šåŠ é’±ï¼Œ2å—
ä¼—å±…æ°‘ï¼šæ”¶åˆ°ï¼Œæœ€é«˜ä»·ä¸º2å—
ï¼ˆæ­¤æ—¶Aä»æ—§è®¤ä¸º1å—æ˜¯æœ€é«˜æŠ¥ä»·ï¼‰
Aï¼šæœ€ç»ˆæŠ¥ä»·ï¼Œ1å—
ä¼—å±…æ°‘ï¼šä¸è¡Œä¸è¡Œï¼ŒBå·²ç»åŠ åˆ°ä¸¤å—é’±äº†
Aï¼šï¼ˆå†…å¿ƒmmpï¼‰è¯¢ä»·ï¼Œ3å—
ï¼ˆBå¯¹Aæé«˜äº†æŠ¥ä»·ä¹Ÿæ¯«æ— å‡†å¤‡ï¼‰
Bï¼šæœ€ç»ˆæŠ¥ä»·ï¼Œ2å—
ä¼—å±…æ°‘ï¼šæ»šç²—ï¼ŒAå·²ç»æŠ¥ä»·3å—äº†
Bï¼šæˆ‘åŠ é’±
Aï¼šæˆ‘å†åŠ 
Bï¼šæˆ‘åŠ é’±
Aï¼šæˆ‘å†åŠ 
ä¼—å±…æ°‘ï¼šã€‚ã€‚ã€‚ï¼ˆä½ ä»¬ç©ä¸ªçƒå•Šï¼‰
&lt;/code>&lt;/pre>&lt;p>éœ‡æƒŠï¼Œè¿™å¸®æ— èŠçš„äººå±…ç„¶ä¸ºäº†è¿™å‡ å—é’±å¯ä»¥ç©ä¸€å¤©ï¼&lt;/p>
&lt;p>ä»¥è¿™æ ·çš„æµç¨‹è¿›è¡Œä¸‹å»ï¼Œç³»ç»Ÿä¼šé™·å…¥æ´»é”ï¼Œå‡ ä¹ä¸èƒ½è¾¾æˆä¸€è‡´äº†ã€‚æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†Aå’ŒBçš„è¯¢ä»·é‡è¯•æ—¶é—´åŠ å…¥éšæœºåŒ–å› å­ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æ›´å¿«çš„è®©å±…æ°‘ä»¬è¾¾æˆä¸€è‡´ã€‚&lt;/p>
&lt;h3 id="paxoså¦‚ä½•è§£å†³æŠ•ç¥¨åˆ†è£‚é—®é¢˜">Paxoså¦‚ä½•è§£å†³æŠ•ç¥¨åˆ†è£‚é—®é¢˜ &lt;a href="#paxos%e5%a6%82%e4%bd%95%e8%a7%a3%e5%86%b3%e6%8a%95%e7%a5%a8%e5%88%86%e8%a3%82%e9%97%ae%e9%a2%98" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/18-11-25/split-vots.png" alt="">&lt;/p>
&lt;p>å¦‚å›¾æ‰€ç¤ºï¼Œå±…æ°‘ä»¬çš„æŠ•ç¥¨å¯èƒ½ä¼šå‘ç”Ÿåˆ†è£‚ï¼Œå³æ²¡æœ‰ä¸€ä¸ªå€¼è¾¾åˆ°äº†åŠæ•°ã€‚è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯è®©ä¹°å®¶é‡æ–°è¿›è¡Œè¯¢ä»·ï¼ŒåŒæ—¶åŠ å…¥éšæœºåŒ–å› å­ï¼Œä½¿å¾—æŠ•ç¥¨è¾¾æˆåŠæ•°ä»¥ä¸Šçš„æ¦‚ç‡æ›´å¤§ã€‚&lt;/p>
&lt;h2 id="è¯´æ­£ç»çš„">è¯´æ­£ç»çš„ &lt;a href="#%e8%af%b4%e6%ad%a3%e7%bb%8f%e7%9a%84" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>å¯¹äºPaxosç®—æ³•çš„å®˜æ–¹æè¿°å’Œæ­£ç¡®æ€§çš„è¯¦ç»†è¯æ˜å¯ä»¥å‚è€ƒ&lt;a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf">åŸè®ºæ–‡&lt;/a>ã€‚è¿™é‡Œå°±ä¸æ¬è¿äº†ï¼Œåªæ˜¯æŠŠæˆ‘çš„ä¾‹å­å’Œå®˜æ–¹é€šç”¨æœ¯è¯­è¿›è¡Œä¸€ä¸‹è®²è§£ï¼Œé¿å…æŠŠå¤§å®¶å¸¦è·‘åäº†ã€‚&lt;/p>
&lt;p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œâ€œè½¦ä½â€çš„é€šç”¨æœ¯è¯­è¢«ç§°ä¸ºâ€œå…±è¯†â€ï¼Œæ•´ä¸ªç³»ç»Ÿä¸­æœ€å¤šæœ‰ä¸€ä¸ªå…±è¯†ã€‚è€Œâ€œè¯¢ä»·è¯·æ±‚â€è¢«ç§°ä¸ºâ€œprepareè¯·æ±‚â€ï¼Œâ€œæŠ¥ä»·è¯·æ±‚â€è¢«ç§°ä¸ºâ€œacceptè¯·æ±‚â€ã€‚&lt;/p>
&lt;p>æ¯ä¸ªè¯·æ±‚çš„ä»·æ ¼è¢«ç§°ä¸ºâ€œç¼–å·â€ï¼Œç¼–å·å¤§çš„è¯·æ±‚å¯ä»¥è¦†ç›–ç¼–å·å°çš„è¯·æ±‚ï¼Œå’Œâ€œä»·é«˜è€…å¾—â€æ˜¯ä¸€ä¸ªé“ç†ã€‚è¯·æ±‚ä¸­æ‰€å¸¦çš„ä¿¡æ¯è¢«ç§°ä¸ºâ€œvalueâ€ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä»£è¡¨ç€è´­ä¹°è€…çš„èº«ä»½ä¿¡æ¯ã€‚&lt;/p>
&lt;h2 id="basic-paxoså’Œmulti-paxos">Basic Paxoså’ŒMulti Paxos &lt;a href="#basic-paxos%e5%92%8cmulti-paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¸Šé¢æˆ‘ä»¬æè¿°çš„Paxosç®—æ³•åˆè¢«ç§°ä¸ºBasic Paxosï¼Œå› ä¸ºæ¯ä¸€è½®æµç¨‹æ‰§è¡Œå®Œï¼Œæ‰€æœ‰çš„å‚ä¸è€…éƒ½ä¼šï¼ˆä¸”åªä¼šï¼‰è¾¾æˆä¸€ä¸ªå…±è¯†ã€‚è€Œåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿ç»­ä¸æ–­çš„å¯¹å¤šä¸ªå€¼è¾¾æˆå…±è¯†ã€‚è¿™æ—¶Basic Paxosç®—æ³•å°±åŠ›ä¸èƒ½åŠäº†ï¼Œä¸€æ¥æ¯ä¸€ä¸ªå€¼çš„å…±è¯†éƒ½è‡³å°‘éœ€è¦ä¸¤æ¬¡å¹¿æ’­ç½‘ç»œè¯·æ±‚ï¼Œæ€§èƒ½å¤ªä½ï¼ŒäºŒæ¥åŒæ—¶å­˜åœ¨çš„å¤šä¸ªææ¡ˆä¼šäº’ç›¸ç«äº‰ï¼Œä½¿å¾—é€šä¿¡çš„æ•ˆç‡ä¸‹é™ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMulti Paxosç®—æ³•åº”è¿è€Œç”Ÿï¼Œå³ä¸€ç§å¯ä»¥é«˜æ•ˆçš„ã€è¿ç»­ä¸æ–­çš„å¯¹å¤šä¸ªå€¼è¾¾æˆå…±è¯†çš„ç®—æ³•ã€‚&lt;/p>
&lt;p>ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šä»‹ç»ä¸€ç§è¢«æ™®éè®¤å¯ï¼Œä»¥åŠå·²ç»è¢«å·¥ä¸šç•Œåº”ç”¨çš„Multi Paxosçš„å®ç° â€”â€” Raftç®—æ³•ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ &lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf">Paxos Made Simple&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://book.douban.com/subject/26292004/">ä»Paxosåˆ°Zookeeper&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/31780743">çŸ¥ä¹ï¼šPaxosç®—æ³•è¯¦è§£&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Windows Azure Storage Made Simple</title><link>https://wizmann.top/posts/azure-storage-made-simple/</link><pubDate>Wed, 11 Oct 2017 21:12:15 +0000</pubDate><guid>https://wizmann.top/posts/azure-storage-made-simple/</guid><description>&lt;h2 id="åŠ æœºå™¨å°±æ˜¯ä¸€æŠŠæ¢­">åŠ æœºå™¨å°±æ˜¯ä¸€æŠŠæ¢­ &lt;a href="#%e5%8a%a0%e6%9c%ba%e5%99%a8%e5%b0%b1%e6%98%af%e4%b8%80%e6%8a%8a%e6%a2%ad" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;blockquote>
&lt;p>æ²¡æœ‰ä»€ä¹ˆé—®é¢˜æ˜¯åŠ ä¸€åƒå°æœºå™¨è§£å†³ä¸äº†çš„ï¼Œå¦‚æœæœ‰ï¼Œå°±å†åŠ ä¸€åƒå°ã€‚ &lt;br>
â€”â€” ã€Š21å¤©ç²¾é€šåˆ†å¸ƒå¼ç³»ç»Ÿã€‹&lt;/p>&lt;/blockquote>
&lt;p>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨è®¾è®¡ä¹‹åˆï¼Œæ˜¯ä¸ºäº†è§£å†³å•æœºç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§é—®é¢˜çš„ã€‚&lt;/p>
&lt;p>ä¸¾ä¸ªä¾‹å­ï¼Œå•æœºç³»ç»Ÿå°±æ˜¯é›‡ä¸€ä¸ªå°å¼Ÿæ›¿ä½ å¹²æ´»ï¼Œä½†æ˜¯è¿™ä¸ªå°å¼Ÿä¸å¤ªé è°±ï¼Œå¶å°”æ³¡ä¸ªç—…å·ä¸ä¸Šç­ï¼Œå¶å°”å·¥ä½œå¤ªå¤šä¸€ä¸ªäººå¹²ä¸è¿‡æ¥ã€‚&lt;/p>
&lt;p>åˆ†å¸ƒå¼ç³»ç»Ÿå°±æ˜¯é›‡ä¸€ç¾¤å°å¼Ÿå¸®ä½ å¹²æ´»ï¼Œå¶å°”æœ‰ä¸€ä¸¤ä¸ªå°å¼Ÿæ³¡ç—…å·ï¼Œæˆ‘ä»¬ä¼šæœ‰å¯Œè£•çš„äººåŠ›é¡¶ä¸Šï¼Œå·¥ä½œå¤ªå¤šæˆ‘ä»¬å¯ä»¥ç»§ç»­æ‹‰æ–°çš„å°å¼Ÿå…¥ä¼™ï¼Œç¾æ»‹æ»‹ã€‚&lt;/p>
&lt;p>è¿™ä¸ªæ¯”å–»å¾ˆå¥½çš„æè¿°äº†å•æœºç³»ç»Ÿå’Œåˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´çš„å…³ç³»ã€‚æ‰€ä»¥ä¸€ç§å¯èƒ½çš„åˆ†å¸ƒå¼ç³»ç»Ÿå°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-25/28278606.jpg" alt="">&lt;/p>
&lt;p>æˆ‘ä»¬å°†ç›¸åŒåŠŸèƒ½çš„æœåŠ¡å™¨ç»„æˆä¸€ä¸ªæ•´ä½“ï¼Œé€šè¿‡ä¸€ä¸ªload balancerå¯¹å¤–æä¾›æœåŠ¡ã€‚&lt;/p>
&lt;p>è¿™æ ·çš„ç³»ç»Ÿåˆæ­¥è§£å†³äº†æˆ‘ä»¬çš„é—®é¢˜ï¼Œåœ¨é¢å¯¹å¯æ‰©å±•æ€§å’Œå¯ç”¨æ€§çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¼šï¼š&lt;/p>
&lt;ul>
&lt;li>å®¹é‡ä¸è¶³å°±åŠ æœºå™¨&lt;/li>
&lt;li>å•æœºæŒ‚æ‰äº†å°±æŠŠæµé‡è°ƒåº¦åˆ°å…¶å®ƒçš„èŠ‚ç‚¹ä¸Š&lt;/li>
&lt;/ul>
&lt;p>ä¸è¿‡å•çº¯çš„åŠ æœºå™¨å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ã€‚å¯¹äºCPUå¯†é›†å‹çš„æœåŠ¡ï¼Œå¢åŠ å‰¯æœ¬æ•°å¯ä»¥æœ‰æ•ˆçš„å‡æ‘Šè®¡ç®—å‹åŠ›ï¼Œä½†æ˜¯å¯¹äºå­˜å‚¨å¯†é›†å‹çš„æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ åˆ†åº“é€»è¾‘æ‰èƒ½æœ‰æ•ˆçš„å¢åŠ ç³»ç»Ÿçš„è®¡ç®—èƒ½åŠ›ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚æˆ‘ä»¬æœ‰100Gçš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®åº“çš„å®¹é‡æœ€å¤šåªæ”¯æŒ50Gã€‚è¿™æ ·æ— è®ºæ€ä¹ˆæ ·å¢åŠ å‰¯æœ¬éƒ½ä¸èƒ½è§£å†³é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬å°†100Gçš„æ•°æ®å‡åˆ†ï¼Œå­˜å‚¨åœ¨ä¸¤ä¸ª50Gçš„åˆ†åº“ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¯æŒå•æœºç³»ç»Ÿå®¹çº³ä¸äº†çš„æ•°æ®äº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-22/14141171.jpg" alt="">&lt;/p>
&lt;p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå¤šä¸ªè¿™æ ·çš„åˆ†å¸ƒå¼å­ç³»ç»Ÿç»„åˆèµ·æ¥ï¼Œå°±å¯ä»¥ç»„æˆä¸€ä¸ªå°æœ‰è§„æ¨¡çš„åˆ†å¸ƒå¼ç³»ç»Ÿäº†ã€‚ç°åœ¨æˆ‘ä»¬åœ¨ä½¿ç”¨çš„ä¸€äº›æœåŠ¡ï¼Œä»åœ¨ä½¿ç”¨è¿™ç§æ¨¡å‹ã€‚&lt;/p>
&lt;p>ä¸Šé¢åˆ†å¸ƒå¼æ¨¡å‹è™½ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯å¼•å…¥äº†ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šå› ä¸ºèŠ‚ç‚¹ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ä¸åè°ƒï¼Œæ‰€ä»¥åŸºæœ¬æ— æ³•å®Œå…¨ä¿è¯å‰¯æœ¬ä¹‹é—´ä¿æŒä¸€è‡´çš„å†…éƒ¨çŠ¶æ€ã€‚&lt;/p>
&lt;p>è¿™å°±æ˜¯æ‰€è°“çš„ä¸€è‡´æ€§é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="è¡¥å……ä¸€ç‚¹ç†è®ºçŸ¥è¯†">è¡¥å……ä¸€ç‚¹ç†è®ºçŸ¥è¯† &lt;a href="#%e8%a1%a5%e5%85%85%e4%b8%80%e7%82%b9%e7%90%86%e8%ae%ba%e7%9f%a5%e8%af%86" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="capç†è®º">CAPç†è®º &lt;a href="#cap%e7%90%86%e8%ae%ba" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>CAPç†è®ºæŒ‡çš„æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰è¿™ä¸‰ä¸ªåŸºæœ¬è¦æ±‚ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­çš„ä¸¤é¡¹ã€‚&lt;/p>&lt;/blockquote>
&lt;p>CAPç†è®ºç”±Eric Breweråœ¨2000å¹´é¦–æ¬¡æå‡ºï¼Œå¹¶ä¸”2å¹´åè¢«Seth Gilbertå’ŒNancy Lynchä»ç†è®ºä¸Šè¯æ˜è¿™ä¸ªç†è®ºã€‚&lt;/p>
&lt;ul>
&lt;li>ä¸€è‡´æ€§æ˜¯æŒ‡æ•°æ®çš„å¤šä¸ªå‰¯æœ¬ä¹‹é—´ä¿æŒä¸€è‡´çš„ç‰¹æ€§ï¼›&lt;/li>
&lt;li>å¯ç”¨æ€§æ˜¯æŒ‡ç³»ç»Ÿçš„æœåŠ¡å¿…é¡»ä¸€ç›´å¤„äºå¯ç”¨çš„çŠ¶æ€;&lt;/li>
&lt;li>è€Œåˆ†åŒºå®¹é”™æ€§æ˜¯æŒ‡ç³»ç»Ÿåœ¨é­é‡ä»»ä½•ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ä»ç„¶èƒ½å¤Ÿä¿è¯å¯¹å¤–æä¾›æ»¡è¶³ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„æœåŠ¡ï¼Œé™¤éæ˜¯æ•´ä¸ªç½‘ç»œç¯å¢ƒéƒ½å‘ç”Ÿäº†æ•…éšœ;&lt;/li>
&lt;/ul>
&lt;p>æŠ›å¼€ä¸€è‡´æ€§é—®é¢˜ä¸è°ˆï¼Œâ€œå¯ç”¨æ€§â€å’Œâ€œåˆ†åŒºå®¹é”™æ€§â€ä»æŸç§æ„ä¹‰ä¸Šè®²æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œæ ‡é…â€ï¼šå•æœºå’Œç½‘ç»œè¿æ¥å¹¶ä¸å¯é ï¼Œä»ä¸€å †ä¸å¯é çš„ç¡¬ä»¶ä¸Šå±‚å»ºç«‹ä¸€ä¸ªä¸å¯é çš„ç³»ç»Ÿå¹¶æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ä¸€è‡´æ€§å¸¸å¸¸è¢«ç‰ºç‰²ï¼Œæ¥ä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ã€‚&lt;/p>
&lt;h3 id="paxosç®—æ³•">Paxosç®—æ³• &lt;a href="#paxos%e7%ae%97%e6%b3%95" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>Paxosæ˜¯Leslie Lamportåœ¨1990å¹´æå‡ºçš„ä¸€ç§åŸºäºæ¶ˆæ¯ä¼ é€’ä¸”å…·æœ‰é«˜åº¦å®¹é”™æ€§çš„ä¸€è‡´æ€§ç®—æ³•ã€‚&lt;/p>
&lt;p>Paxosè§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•åœ¨ä¸€ä¸ªå¯èƒ½å‘ç”Ÿä¸Šè¿°å¼‚å¸¸çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¿«é€Ÿä¸”æ­£ç¡®åœ°åœ¨é›†ç¾¤å†…éƒ¨å¯¹æŸä¸ªæ•°æ®çš„å€¼è¾¾æˆä¸€è‡´ï¼Œå¹¶ä¸”ä¿è¯ä¸è®ºå‘ç”Ÿä»»ä½•å¼‚å¸¸ï¼Œéƒ½ä¸ä¼šç ´åæ•´ä¸ªç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>Paxosçš„æè¿°å’Œè¯æ˜æœ‰ä¸€äº›å¤æ‚ï¼Œè¿™é‡Œä¸åšå±•å¼€ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç³»ç»Ÿä¸­çš„å„ä¸ªèŠ‚ç‚¹ä½¿ç”¨ç±»ä¼¼äºé€‰ä¸¾æŠ•ç¥¨çš„ç®—æ³•æ¥è¾¾æˆä¸€è‡´ï¼Œé€‰ä¸¾è¿‡ç¨‹ä¸­ä¼šæœ‰çŸ­æš‚çš„æ•°æ®ä¸å¯ç”¨ä¸­é—´çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="æˆ‘æœ€è®¨åŒæˆ‘æƒ³åšçš„äº‹æƒ…åšä¸æˆ">â€œæˆ‘æœ€è®¨åŒæˆ‘æƒ³åšçš„äº‹æƒ…åšä¸æˆâ€ &lt;a href="#%e6%88%91%e6%9c%80%e8%ae%a8%e5%8e%8c%e6%88%91%e6%83%b3%e5%81%9a%e7%9a%84%e4%ba%8b%e6%83%85%e5%81%9a%e4%b8%8d%e6%88%90" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;blockquote>
&lt;p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œä¸€è‡´æ€§æ˜¯æŒ‡æ•°æ®åœ¨å¤šä¸ªå‰¯æœ¬ä¹‹é—´æ˜¯å¦èƒ½å¤Ÿä¿æŒä¸€è‡´çš„ç‰¹æ€§ã€‚åœ¨ä¸€è‡´æ€§çš„éœ€æ±‚ä¸‹ï¼Œå½“ä¸€ä¸ªç³»ç»Ÿåœ¨æ•°æ®ä¸€è‡´çš„çŠ¶æ€ä¸‹æ‰§è¡Œæ›´æ–°æ“ä½œåï¼Œåº”è¯¥ä¿è¯ç³»ç»Ÿçš„æ•°æ®ä»ç„¶å¤„äºä¸€è‡´çš„çŠ¶æ€ã€‚ &lt;br>
â€”â€” ã€Šä»Paxosåˆ°ZooKeeperã€‹&lt;/p>&lt;/blockquote>
&lt;p>æ— æ•°çš„ç†è®ºå’Œå®è·µè¯æ˜ï¼Œè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€è‡´æ€§é—®é¢˜æ˜¯éå¸¸å›°éš¾çš„ã€‚ä»æœ€ç›´è§‚ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬æ‰¾ä¸åˆ°ä¸¤ç‰‡ä¸€æ ·çš„æ ‘å¶ï¼Œä¹Ÿæ‰¾ä¸åˆ°ä¸¤å°çŠ¶æ€å®Œå…¨ä¸€è‡´çš„åˆ†å¸ƒå¼èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å‰äººçš„æ™ºæ…§æ˜¯æ— ç©·çš„ï¼Œæˆ‘ä»¬ä»ç„¶æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ¡ˆæ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼š&lt;/p>
&lt;h3 id="2pc-and-3pc">2PC and 3PC &lt;a href="#2pc-and-3pc" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>2PCï¼ˆTwo-phase Commitï¼Œä¸¤é˜¶æ®µæäº¤ï¼‰æ˜¯ç”¨æ¥ä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸€è‡´æ€§çš„ä¸€ä¸ªåè®®ã€‚å…¶æµç¨‹å¯ä»¥ç”±è¿™ä¸ªä¾‹å­æ¥è¡¨ç¤ºï¼š&lt;/p>
&lt;blockquote>
&lt;p>PMï¼ˆåè°ƒè€…ï¼‰: æˆ‘è¦åŠ ä¸ªéœ€æ±‚ï¼ï¼ˆé˜¶æ®µ1ï¼Œæäº¤äº‹åŠ¡è¯·æ±‚ï¼‰ &lt;br>
Dev1ï¼ˆå‚ä¸è€…ï¼‰ï¼šä½ åŠ å§ &lt;br>
Dev2ï¼ˆå‚ä¸è€…ï¼‰ï¼šä½ åŠ å§ &lt;br>
PMï¼ˆåè°ƒè€…ï¼‰ï¼šæˆ‘çœŸåŠ äº†ï¼ï¼ˆé˜¶æ®µ2ï¼Œæ‰§è¡Œäº‹åŠ¡æäº¤ï¼‰ &lt;br>
Dev1ï¼ˆå‚ä¸è€…ï¼‰ï¼šåŠ å®Œäº† &lt;br>
Dev2ï¼ˆå‚ä¸è€…ï¼‰ï¼šåŠ å®Œäº†&lt;/p>&lt;/blockquote>
&lt;blockquote>
&lt;p>æ³¨ï¼šPMå’ŒDevæ˜¯ç¨‹åºå‘˜è€æ¢—è€Œå·²ã€‚å„ä¸ªèŒä¸šåªæ˜¯åˆ†å·¥ä¸åŒï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ä¸ºäººæ°‘æœåŠ¡ã€‚&lt;/p>&lt;/blockquote>
&lt;p>æ•´ä¸ªæµç¨‹çœ‹èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šé‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>åŒæ­¥é˜»å¡ &lt;br>
åœ¨æäº¤è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿéœ€è¦ç­‰å¾…æ‰€æœ‰å‚ä¸è€…çš„å“åº”ï¼Œæ‰€ä»¥ç³»ç»Ÿæ•´ä½“å¤„äºä¸€ç§é˜»å¡çŠ¶æ€ï¼Œå½±å“æ•ˆç‡ã€‚&lt;/li>
&lt;li>å•ç‚¹é—®é¢˜ &lt;br>
åè°ƒè€…æ˜¯ç³»ç»Ÿçš„å•ç‚¹ï¼Œå¦‚æœå½“æ‰ï¼Œæ•´ä¸ªç³»ç»Ÿå°±å¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚&lt;/li>
&lt;li>æ•°æ®ä¸ä¸€è‡´ &lt;br>
ä¸€ä¸ªæ•°æ®ä¸€è‡´æ€§åè®®ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œç¡®å®æ˜¯éå¸¸è®½åˆºçš„äº‹æƒ…ã€‚åœ¨æ‰§è¡Œäº‹åŠ¡æäº¤é˜¶æ®µï¼Œå¦‚æœåè°ƒè€…ä¸å‚ä¸è€…çš„é€šä¿¡ä¸­æ–­ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ï¼š
&lt;ul>
&lt;li>å½“åè°ƒè€…å‘å¾€éƒ¨åˆ†å‚ä¸è€…çš„Commitæ¶ˆæ¯ä¸¢å¤±ï¼Œæ²¡æœ‰æ”¶åˆ°Commitçš„å‚ä¸è€…ä¼šå› ä¸ºè¶…æ—¶è€Œè®¤ä¸ºè¿™æ¬¡è¯·æ±‚å¤±è´¥è€Œè¿›è¡Œå›æ»š&lt;/li>
&lt;li>å½“å‚ä¸è€…å‘å¾€åè°ƒè€…çš„ACKæ¶ˆæ¯ä¸¢å¤±ï¼Œåè°ƒè€…ä¼šè®¤ä¸ºè¿™æ¬¡è¯·æ±‚å¤±è´¥ï¼Œä½†æ˜¯å‚ä¸è€…ç¡®å®å·²ç»Commitäº†æ•°æ®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>3PCï¼ˆThree-phace Commitï¼Œä¸‰é˜¶æ®µæäº¤ï¼‰æ˜¯2PCåè®®çš„æ”¹è¿›ç‰ˆï¼Œå°†æ•´ä¸ªè¯·æ±‚åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>äº‹åŠ¡è¯¢é—®&lt;/li>
&lt;li>é¢„æäº¤&lt;/li>
&lt;li>æ‰§è¡Œæäº¤&lt;/li>
&lt;/ul>
&lt;p>è¿™æ ·çš„æ”¹è¿›å‡å°‘äº†åŒæ­¥é˜»å¡çš„ç²’åº¦ï¼Œä½†æ˜¯ä»ç„¶æ²¡æœ‰è§£å†³å•ç‚¹é—®é¢˜å’Œæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚æ‰€ä»¥2PCå’Œ3PCéƒ½ä¸æ˜¯éå¸¸ç†æƒ³çš„æ•°æ®ä¸€è‡´æ€§åè®®ã€‚&lt;/p>
&lt;h3 id="paxos">Paxos &lt;a href="#paxos" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä¸Šæ–‡ä¸­æˆ‘ä»¬æåˆ°Paxosæ˜¯ä¸€ç§è¢«æ•°å­¦è¯æ˜è¿‡çš„ï¼Œå…·æœ‰é«˜åº¦å®¹é”™æ€§çš„ä¸€è‡´æ€§ç®—æ³•ã€‚ä½†æ˜¯å…¶æµç¨‹å¤æ‚ï¼Œé€šä¿¡æ¬¡æ•°è¾ƒå¤šï¼Œå¹¶ä¸”åœ¨ææ¡ˆæœªè¢«é€‰ä¸­ä¹‹å‰ä¸èƒ½ä¿è¯æ•°æ®çš„å¯ç”¨æ€§ã€‚&lt;/p>
&lt;p>æ‰€ä»¥Paxosçš„åº”ç”¨åœºæ™¯å¤šä¸ºå‘½åæœåŠ¡ã€é…ç½®ç®¡ç†ã€åˆ†å¸ƒå¼é”ç­‰è½»é‡çº§ä½†æ˜¯è€Œåˆéå¸¸æ ¸å¿ƒçš„æœåŠ¡ï¼Œä»è€Œæ‰¬é•¿é¿çŸ­ï¼Œæ›´å¥½çš„ä¸ºäººæ°‘æœåŠ¡ï¼Œ&lt;del>æ›´å¥½çš„åä¸‰ä¿—&lt;/del>ã€‚ã€‚&lt;/p>
&lt;h3 id="quorum-like-algorithm-amazon-dynamo">Quorum-like Algorithm (Amazon Dynamo) &lt;a href="#quorum-like-algorithm-amazon-dynamo" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¯¹äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€è‡´æ€§ï¼Œæœ€ç›´è§‚çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨ä¿®æ”¹èŠ‚ç‚¹çŠ¶æ€æ—¶ï¼Œå°†ä¿®æ”¹å¹¿æ’­åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚è¿™æ ·ä»ç†è®ºä¸Šè®²ï¼Œå°±å¯ä»¥ä¿æŒèŠ‚ç‚¹çš„ä¸€è‡´æ€§äº†ã€‚&lt;/p>
&lt;p>ä½†æ˜¯åœ¨ç°å®å·¥ç¨‹å½“ä¸­ï¼Œå¹¿æ’­ä¿®æ”¹æ˜¯æœ€ä¸å¯é çš„æ–¹æ¡ˆï¼Œå› ä¸ºé€šä¿¡å¯èƒ½å¤±è´¥ï¼ŒèŠ‚ç‚¹å¯èƒ½å¤±æ•ˆï¼Œæˆ‘ä»¬çš„ä¿®æ”¹å¾ˆæœ‰å¯èƒ½ä¸ä¼šåŒæ­¥åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šï¼ˆå‡è®¾æ¯ä¸ªèŠ‚ç‚¹çš„å¯é æ€§ä¸º99.9%ï¼Œé‚£ä¹ˆ10ä¸ªèŠ‚ç‚¹åŒæ—¶å¯é æ¦‚ç‡åªæœ‰99%ï¼Œ100ä¸ªèŠ‚ç‚¹åŒæ—¶å¯é çš„æ¦‚ç‡ä¸º90%ï¼‰ã€‚&lt;/p>
&lt;p>ä¸è¿‡ï¼Œè®©æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¿æŒå®Œå…¨ä¸€è‡´è™½ç„¶å¾ˆå®Œç¾ï¼Œä½†æ˜¯å…¶ä»˜å‡ºçš„ä»£ä»·ä¹Ÿè®¸æ˜¯ç°æœ‰ çš„ç³»ç»Ÿéš¾ä»¥æ‰¿å—çš„ã€‚Amazon Dynamoä½¿ç”¨äº†ä¸€ç§ç±»ä¼¼é€‰ä¸¾çš„ç®—æ³•æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>è®¾æˆ‘ä»¬æœ‰Nä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å†æŒ‡å®šä¸¤ä¸ªæ•°Rå’ŒWï¼Œä½¿å¾— R + W &amp;gt; Nã€‚åœ¨å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŒæ—¶å‘Nä¸ªèŠ‚ç‚¹å†™å…¥ï¼Œå½“æœ‰Wä¸ªï¼ˆåŠä»¥ä¸Šï¼‰èŠ‚ç‚¹å†™å…¥æˆåŠŸï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›æˆåŠŸï¼›åœ¨è¯»å–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘Rä¸ªèŠ‚ç‚¹è¯·æ±‚æ•°æ®ï¼Œæ­¤æ—¶ä¸€å®šä¼šè¯»åˆ°åˆšåˆšå†™å…¥æ–°æ•°æ®çš„èŠ‚ç‚¹ï¼Œç„¶åæˆ‘ä»¬å°†æœ€æ–°çš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>ä¸è¿‡è¿™ç§è®¾è®¡å¹¶ä¸å®Œå–„ï¼Œå½“å‡ºç°ç½‘ç»œé”™è¯¯æˆ–è€…å¤§è§„æ¨¡èŠ‚ç‚¹å¤±æ•ˆçš„æ—¶å€™ï¼Œæ•°æ®ä¸€è‡´æ€§å°±å¾ˆéš¾ä¿è¯äº†ã€‚&lt;/p>
&lt;p>æˆ‘ç§°è¿™ç§ä¸€è‡´æ€§æ¨¡å‹ä¸º â€”â€” â€œå°½åŠ›ä¸€è‡´æ€§â€ã€‚&lt;/p>
&lt;h3 id="event-stream-for-eventual-consistency-apache-kafka">Event Stream for Eventual Consistency (Apache Kafka) &lt;a href="#event-stream-for-eventual-consistency-apache-kafka" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä»Dynamoçš„ç»éªŒä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç›´æ¥å°†çŠ¶æ€çš„ä¿®æ”¹å¹¿æ’­åˆ°ä¸åŒçš„èŠ‚ç‚¹æ˜¯ä¸å¯é çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;/p>
&lt;p>Apache Kafkaä½¿ç”¨äº†ç±»ä¼¼â€œé¢„å†™å¼æ—¥å¿—â€çš„æ–¹æ³•æ¥ä¿è¯ä¸€è‡´æ€§ã€‚å½“çŠ¶æ€ä¿®æ”¹è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå…ˆå†™å…¥ä¸€æ¡å…¬å…±çš„æ•°æ®æµï¼Œè¿™æ¡æ•°æ®æµå¾€å¾€æ˜¯æŒä¹…åŒ–åˆ°ç£ç›˜çš„ã€‚ç„¶åä¸åŒçš„èŠ‚ç‚¹å†è®¿é—®æ•°æ®æµï¼Œæ‰§è¡ŒåŒæ ·çš„çŠ¶æ€ä¿®æ”¹è¯·æ±‚ï¼Œä¿è¯èŠ‚ç‚¹çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-27/17974300.jpg" alt="">&lt;/p>
&lt;p>è¿™ç§è®¾è®¡çš„ç¼ºé™·æ˜¯è™½ç„¶æœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šä¾æ¬¡æ‰§è¡Œç›¸åŒçš„å‘½ä»¤ï¼Œä½†æ˜¯èŠ‚ç‚¹æ‰§è¡Œå‘½ä»¤çš„é€Ÿåº¦æœ‰å¿«æœ‰æ…¢ï¼Œæ‰€ä»¥åœ¨ç¬æ—¶ä¼šæœ‰ä¸ä¸€è‡´çš„æƒ…å†µã€‚&lt;/p>
&lt;p>è¿™ç§ä¸€è‡´æ€§æ¨¡å‹è¢«ç§°ä¸º â€”â€” â€œæœ€ç»ˆä¸€è‡´æ€§â€ã€‚&lt;/p>
&lt;h2 id="ä¸»è§’ç™»åœºwindows-azure-storage">ä¸»è§’ç™»åœºï¼šWindows Azure Storage &lt;a href="#%e4%b8%bb%e8%a7%92%e7%99%bb%e5%9c%bawindows-azure-storage" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Windows Azure Storageï¼ˆä»¥ä¸‹ç®€ç§°WASï¼‰é‡‡ç”¨äº†å¤šç§ä¸€è‡´æ€§ç®—æ³•ï¼Œåœ¨æä¾›è¾ƒé«˜æ€§èƒ½æœåŠ¡çš„åŒæ—¶ï¼Œæ¥åŠªåŠ›ä¿è¯å­˜å‚¨ç³»ç»Ÿçš„CAPæ€§è´¨ã€‚&lt;/p>
&lt;p>å…¶ä¸­WASä½¿ç”¨äº†ä¸€äº›åˆ›æ–°æ€§çš„ç®—æ³•ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯å…ˆä»å®ƒçš„æ•´ä½“æ¶æ„è°ˆèµ·ã€‚&lt;/p>
&lt;ul>
&lt;li>Windows Azure Storageçš„æ¶æ„&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-19/98830090.jpg" alt="">&lt;/p>
&lt;p>WASä»æ¶æ„ä¸Šåˆ†ä¸ºä¸‰å±‚ï¼Œåˆ†åˆ«æ˜¯å‰ç«¯ï¼ˆFE Layerï¼‰ï¼Œåˆ†åŒºå±‚ï¼ˆPartition Layerï¼‰å’Œæ•°æ®æµå±‚ï¼ˆStream Layerï¼‰ã€‚è¿™ä¸‰å±‚ä»åŠŸèƒ½ä¸Šå„æœ‰åˆ†å·¥ï¼Œä½†æ˜¯åˆåˆ†åˆ«è§£è€¦ï¼Œå¯ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€‚&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬è‡ªåº•å‘ä¸Šçš„è®¨è®ºä¸€ä¸‹å„å±‚ä¹‹é—´çš„åŠŸèƒ½ä¸è”ç³»ã€‚&lt;/p>
&lt;h2 id="was---æ•°æ®æµå±‚">WAS - æ•°æ®æµå±‚ &lt;a href="#was---%e6%95%b0%e6%8d%ae%e6%b5%81%e5%b1%82" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æ•°æ®æµåŒ…å«ç€å„ç§æ•°æ®æ“ä½œï¼Œæ“ä½œåŒ…å«æ’å…¥ã€ä¿®æ”¹ã€åˆ é™¤ç­‰åŸºæœ¬æ“ä½œï¼Œâ€œæµâ€åˆ™å¯ä»¥çœ‹åšæ˜¯ä¸€æ¡æ— é™é•¿çš„é˜Ÿåˆ—ã€‚&lt;/p>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æµç»“æ„">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æµç»“æ„ï¼Ÿ &lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e4%bd%bf%e7%94%a8%e6%b5%81%e7%bb%93%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä¸ºä»€ä¹ˆè¦ç”¨æµç»“æ„å‘¢ï¼ŒåŸå› éå¸¸ç®€å•ï¼Œå› ä¸ºæµä¸­çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼Œå¦åˆ™ä¼šé€ æˆä¸ç¡®å®šçš„ç»“æœã€‚&lt;/p>
&lt;p>ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ªæ“ä½œï¼š&lt;/p>
&lt;p>æ“ä½œ1ï¼šæ’å…¥å€¼x=1 &lt;br>
æ“ä½œ2ï¼šä¿®æ”¹è¯¥å€¼ä¸ºx=2 &lt;br>
æ“ä½œ3ï¼šä¿®æ”¹è¯¥å€¼ä¸ºx=5&lt;/p>
&lt;p>å¦‚æœæ“ä½œæ˜¯æŒ‰ç…§é¡ºåºæ¥åšçš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬è·å¾—çš„å€¼ä¸ºx=5ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†æ“ä½œ2å’Œæ“ä½œ3è°ƒæ¢ä¹‹åï¼Œé‚£ä¹ˆæˆ‘ä»¬è·å¾—çš„å€¼ä¸ºx=2ï¼›å¦‚æœæˆ‘ä»¬å°†æ“ä½œ1æ”¾ç½®åœ¨æ“ä½œ2æˆ–æ“ä½œ3ä¹‹åï¼Œæˆ‘ä»¬å°±åœ¨ä¿®æ”¹ä¸€ä¸ªä¸å­˜åœ¨çš„å€¼ï¼Œè¿™åŠ¿å¿…ä¼šé€ æˆé”™è¯¯ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ï¼Œæ•°æ®æµçš„æœ‰åºæ€§ä¿è¯äº†æ“ä½œçš„â€œå›æ”¾ä¸€è‡´æ€§â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸åŒçš„æ•°æ®æµåº”ç”¨åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œè·å¾—çš„æœ€ç»ˆçŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚&lt;/p>
&lt;p>åŒæ—¶ï¼Œç”±äºHDDçš„é¡ºåºè¯»å†™æ€§èƒ½ä¼˜äºéšæœºè¯»å†™æ€§èƒ½ã€‚ä½¿ç”¨æµæ•°æ®ç»“æ„å¯ä»¥å°†å†™å…¥è¯·æ±‚é¡ºåºåŒ–ï¼Œè¿½åŠ å†™å…¥ç£ç›˜ï¼Œåœ¨å»‰ä»·çš„ç¡¬ä»¶ä¸Šè·å¾—æœ€å¥½çš„æ€§èƒ½ã€‚&lt;/p>
&lt;h5 id="ç§‘æ™®æ—¶é—´hddä¸ssd">ç§‘æ™®æ—¶é—´ï¼šHDDä¸SSD &lt;a href="#%e7%a7%91%e6%99%ae%e6%97%b6%e9%97%b4hdd%e4%b8%8essd" class="anchor">ğŸ”—&lt;/a>&lt;/h5>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-10/63227271.jpg" alt="image">&lt;/p>
&lt;p>HDDæŒ‡çš„æ˜¯Hard Disk Driveï¼Œåˆç§°Spinning Diskï¼Œæ˜¯è®¡ç®—æœºä½¿ç”¨çš„ä¸€ç§ä»¥ç£æ€§ç¢Ÿç‰‡å­˜å‚¨æ•°æ®çš„ä¸€ç§éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡ï¼ˆäººè¯å°±æ˜¯ï¼šæ–­ç”µåä¸ä¸¢æ•°æ®ï¼‰ã€‚æ•°æ®å­˜å‚¨åœ¨åŒå¿ƒåœ†ç£é“ä¸Šï¼Œå·¥ä½œæ—¶ç¢Ÿç‰‡ä¼šæ—‹è½¬ï¼ˆå’ŒCDæœºä¸€æ ·ï¼‰ï¼Œç£å¤´ä¼šç§»åŠ¨åˆ°ç›¸åº”çš„ç£é“ä¸Šè¿›è¡Œæ•°æ®çš„è¯»å†™ï¼ˆCDæœºç”¨çš„æ˜¯å…‰å¤´ï¼‰ã€‚æ‰€ä»¥ï¼Œé¡ºåºè¯»å†™æ—¶ï¼ŒHDDçš„æ€§èƒ½ä¼šæ¯”éšæœºè¯»å†™è¦å¥½ï¼Œå› ä¸ºéšæœºè¯»å†™å¸¦æ¥çš„å¤§é‡ç£ç›˜å¯»å€ä¼šè®©ç£å¤´ä¸æ–­ç§»åŠ¨ï¼Œä»è€Œæ‹–æ…¢æ€§èƒ½ã€‚&lt;/p>
&lt;p>ä¸æ­¤åŒæ—¶ï¼Œç”±äºç¢Ÿç‰‡å†…å¼§çš„æ—‹è½¬&lt;strong>çº¿é€Ÿåº¦&lt;/strong>è¦å°äºå¤–å¼§ï¼Œæ‰€ä»¥å¤–å¼§çš„è¯»å†™æ€§èƒ½ä¼šä¼˜äºå†…å¼§ã€‚&lt;/p>
&lt;p>SSDæŒ‡çš„æ˜¯Solid State Diskï¼Œå³å›ºæ€ç¡¬ç›˜ï¼Œä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡ã€‚å…¶ä½¿ç”¨é—ªå­˜èŠ¯ç‰‡æ¥å­˜å‚¨æ•°æ®ã€‚ç”±äºå…¶å¹¶ä¸åƒHDDä¸€æ ·éœ€è¦ç‰©ç†ä¸Šç§»åŠ¨ç£å¤´æ¥è¿›è¡Œå¯»å€ï¼Œåœ¨é¡ºåºå†™å…¥ä¸HDDæˆ–ç•¥å¼ºäºHDDç£ç›˜çš„åŒæ—¶ï¼Œéšæœºå†™å…¥æ€§èƒ½è¦è¿œè¿œå¼ºäºHDDï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è£…ç”µè„‘éƒ½å–œæ¬¢æŠŠç³»ç»Ÿè£…åˆ°SSDç›˜ä¸Šï¼‰ã€‚&lt;/p>
&lt;p>ä½†æ˜¯SSDåœ¨æˆæœ¬å’Œè´¨é‡ä¸Šå¼±äºHDDç£ç›˜ã€‚1TBçš„SSDçš„ä»·æ ¼çº¦ä¸º400åˆ€ï¼Œè€Œ1TBçš„HHDä»·æ ¼ä»…ä¸º80~100åˆ€ï¼ˆ2017å¹´10æœˆ&lt;a href="https://pcpartpicker.com/trends/internal-hard-drive/">æ•°æ®&lt;/a>ï¼‰ï¼›SSDæœ‰å†™å…¥æ¬¡æ•°çš„é™åˆ¶ï¼Œå½“é—ªå­˜èŠ¯ç‰‡æŸåæ—¶ï¼Œä¼šå½±å“SSDçš„æ€§èƒ½ã€‚ç›¸æ¯”è€Œè¨€ï¼ŒHDDçš„æŠ€æœ¯çš„æ€§èƒ½æ›´ç¨³å®šï¼ŒæŠ€æœ¯æ›´ä¸ºæˆç†Ÿï¼Œè´¨é‡ä¼šæ›´å¥½ä¸€äº›ã€‚&lt;/p>
&lt;h3 id="æ•°æ®æµçš„ä¸€è‡´æ€§ç®—æ³•">æ•°æ®æµçš„ä¸€è‡´æ€§ç®—æ³• &lt;a href="#%e6%95%b0%e6%8d%ae%e6%b5%81%e7%9a%84%e4%b8%80%e8%87%b4%e6%80%a7%e7%ae%97%e6%b3%95" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å› ä¸ºè¦ä¿è¯å¯ç”¨æ€§ï¼Œæ‰€ä»¥æ•°æ®æµå¿…é¡»è¦æ˜¯å¤šæœºçš„ï¼Œè€Œå¤šæœºç³»ç»Ÿå°±è¦é¢ä¸´ä¸€è‡´æ€§é—®é¢˜ã€‚WASæå‡ºäº†ä¸€ç§â€œé“¾å¼æäº¤â€æ–¹æ³•æ¥ä¿è¯äº†åˆ†å¸ƒå¼æ•°æ®æµçš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-7/32688212.jpg" alt="">&lt;/p>
&lt;p>ä¸ä¹‹å‰æåˆ°çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§çš„å¤šæœºå¹¶è¡Œçš„ç®—æ³•ä¸åŒï¼ŒWASåœ¨æ•°æ®æµå±‚é‡‡ç”¨äº†ä¸€ç§â€œé“¾å¼â€çš„æäº¤ç®—æ³•ï¼š&lt;/p>
&lt;ol>
&lt;li>å½“å‰¯æœ¬1æ¥å—åˆ°æ•°æ®åï¼Œä¼šé¦–å…ˆå°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¹‹åå†å°†ç›¸åŒçš„è¯·æ±‚è½¬å‘ç»™å‰¯æœ¬2ï¼›&lt;/li>
&lt;li>å‰¯æœ¬2è·å¾—æ•°æ®åï¼ŒæŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå†è¯·è¯·æ±‚è½¬å‘ç»™å‰¯æœ¬3ï¼›&lt;/li>
&lt;li>å‰¯æœ¬3å°†æ•°æ®æˆåŠŸæŒä¹…åŒ–åï¼Œè¿”å›ACKï¼›&lt;/li>
&lt;li>å‰¯æœ¬2æ¥æ”¶åˆ°å‰¯æœ¬3çš„ACKæ¶ˆæ¯åï¼ŒåŒæ ·è¿”å›ACKï¼›&lt;/li>
&lt;li>å‰¯æœ¬1æ¥æ”¶åˆ°å‰¯æœ¬2çš„ACKæ¶ˆæ¯åï¼Œå‘è¯·æ±‚æ–¹è¿”å›ACKã€‚&lt;/li>
&lt;/ol>
&lt;p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå½“æ•°æ®è¯·æ±‚è¿”å›ACKåï¼Œä¸€å®šæœ‰ä¸‰ä¸ªï¼ˆæˆ–ä»¥ä¸Šï¼Œæ ¹æ®ç³»ç»Ÿçš„å‚æ•°è€Œå®šï¼‰å‰¯æœ¬åŒæ—¶å†™å…¥å¹¶æŒä¹…åŒ–è¿™æ¡è¯·æ±‚ã€‚æ­¤æ—¶ä¸‰ä¸ªå‰¯æœ¬ä¸€å®šæ˜¯â€œå¼ºä¸€è‡´â€çš„ã€‚&lt;/p>
&lt;p>ä¸è¿‡ï¼Œå¦‚æœé“¾å¼æäº¤å½“ä¸­æœ‰ä»»ä½•ä¸€ä¸ªç¯èŠ‚å‡ºç°äº†é—®é¢˜ï¼Œæ¯”å¦‚æœºå™¨å¤±æ•ˆã€ç½‘ç»œè¶…æ—¶ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦é¢ä¸´æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚WASä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†è¢«ç§°ä¸ºâ€œå°å­˜â€çš„æœºåˆ¶ã€‚&lt;/p>
&lt;h3 id="å°å­˜sealingæœºåˆ¶">å°å­˜ï¼ˆsealingï¼‰æœºåˆ¶ &lt;a href="#%e5%b0%81%e5%ad%98sealing%e6%9c%ba%e5%88%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä¸Šæ–‡è¯´åˆ°ï¼Œæ•°æ®æµæ˜¯ä¸€ä¸ªæ— é™é•¿çš„é˜Ÿåˆ—ï¼Œåªèƒ½åœ¨å°¾éƒ¨è¿½åŠ å†™å…¥ã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚æœæƒ³è¦å­˜å‚¨è¿™æ¡æ•°æ®æµï¼Œå°±åŠ¿å¿…è¦æŠŠè¿™æ¡æ•°æ®æµåˆ†ä¸ºå¤šä¸ªèŠ‚ï¼Œå¹¶æŠŠå®ƒä»¬åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€‚å¦åˆ™æ•°æ®æµçš„å¤§å°å°±è¦å—é™äºå•æœºçš„å­˜å‚¨å®¹é‡ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çœ‹åˆ°çš„ã€‚&lt;/p>
&lt;p>åˆç”±äºæ•°æ®æµçš„å°¾éƒ¨è¿½åŠ å†™å…¥ç‰¹æ€§ï¼Œæ‰€ä»¥æ•°æ®æµè¢«åˆ†ä¸ºå¤šä¸ªèŠ‚ä¹‹åï¼Œåªæœ‰æœ€åä¸€ä¸ªèŠ‚æ˜¯å¯è¯»å†™çš„ï¼Œå…¶å®ƒçš„æ‰€æœ‰èŠ‚éƒ½æ˜¯åªè¯»çš„ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-7/46032879.jpg" alt="">&lt;/p>
&lt;p>æˆ‘ä»¬å°†æŠŠå¯è¯»å¯è¿½åŠ çš„æ•°æ®æµè½¬åŒ–ä¸ºåªè¯»çš„æ•°æ®æµçš„æ“ä½œç§°ä¸ºâ€œå°å­˜â€ã€‚&lt;/p>
&lt;p>å°å­˜çš„ä½œç”¨ä¹‹ä¸€ï¼Œå°±æ˜¯åœ¨æ•°æ®æµçš„ä¸€èŠ‚è¿‡å¤§çš„æ—¶å€™ï¼Œåœæ­¢å†™å…¥è¯¥èŠ‚ï¼Œä½¿å¾—æ•°æ®èŠ‚çš„å¤§å°å¯æ§ã€‚&lt;/p>
&lt;p>ç¬¬äºŒä¸ªä½œç”¨ï¼Œæ˜¯ä¸Šé¢æˆ‘ä»¬æåˆ°çš„ï¼Œåœ¨â€œé“¾å¼æäº¤â€å¤±è´¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå°†æ‰€æœ‰çš„æ•°æ®æµå‰¯æœ¬å°å­˜ï¼Œå°å­˜çš„æ—¶å€™å–æ‰€æœ‰å‰¯æœ¬çš„æ•°æ®çš„äº¤é›†ã€‚è¿™æ ·å°±èƒ½æ’é™¤å› ä¸ºå†™å…¥å¤±è´¥è€Œä¸ä¸€è‡´çš„æ•°æ®ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-12/93804080.jpg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>æ­¤æ—¶æœ‰åŒå­¦ä¼šé—®ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»æˆåŠŸçš„å†™å…¥äº†ä¸‰ä¸ªå‰¯æœ¬ï¼Œä½†æ˜¯ç”±äºç½‘ç»œåŸå› å¹¶æ²¡èƒ½å‘è¯·æ±‚æ–¹è¿”å›ACKã€‚è¯·æ±‚æ–¹ä¼šè®¤ä¸ºè¿™æ®µæ•°æ®å†™å…¥å¤±è´¥ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨å°å­˜çš„æ—¶å€™ï¼Œä»ç„¶ä¼šå°†è¿™éƒ¨åˆ†æ•°æ®å°å­˜åœ¨æ•°æ®èŠ‚ä¸­ã€‚è¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ &lt;br>
è¿™ä¸ªé—®é¢˜åé¢ä¼šæœ‰è§£ç­”ï¼Œè¯·è€å¿ƒé˜…è¯»å“¦~&lt;/p>&lt;/blockquote>
&lt;h3 id="æ•°æ®æµå±‚çš„æ¶æ„">æ•°æ®æµå±‚çš„æ¶æ„ &lt;a href="#%e6%95%b0%e6%8d%ae%e6%b5%81%e5%b1%82%e7%9a%84%e6%9e%b6%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-8/29641653.jpg" alt="">&lt;/p>
&lt;p>åœ¨å‰é¢çš„æ–‡ç« é‡Œï¼Œæ²¡æœ‰æåˆ°â€œæ•°æ®æµç®¡ç†å™¨â€ï¼ˆStream Managerï¼Œç®€ç§°SMï¼‰è¿™ä¸ªè§’è‰²ã€‚è¿™ä¸ªè§’è‰²åœ¨æ•´ä¸ªæ•°æ®æµå±‚æ‰®æ¼”äº†ä¸€ä¸ªå¾ˆé‡è¦çš„è§’è‰²ã€‚&lt;/p>
&lt;p>SMæ˜¯ç”±ä¸€ä¸ªå°å‹é›†ç¾¤ä½¿ç”¨paxosé€‰ä¸¾å‡ºæ¥çš„masterèŠ‚ç‚¹ï¼Œå…¶å®ƒèŠ‚ç‚¹å¤‡ç”¨ã€‚SMåªç”¨æ¥ç®¡ç†æ•´ä¸ªæ•°æ®æµçš„çŠ¶æ€ï¼Œå¹¶ä¸è´Ÿè´£å…·ä½“çš„è¯»å†™æ“ä½œã€‚&lt;/p>
&lt;p>SMçš„ä¸»è¦åŠŸèƒ½æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>ç»Ÿè®¡èŠ‚ç‚¹çŠ¶æ€&lt;/li>
&lt;li>ç›‘æ§èŠ‚ç‚¹å¥åº·çŠ¶å†µ&lt;/li>
&lt;li>è´Ÿè½½å‡è¡¡&lt;/li>
&lt;li>å°å­˜ã€åˆ›å»ºæ–°çš„æ•°æ®èŠ‚&lt;/li>
&lt;li>å¤‡ä»½ä¸åƒåœ¾å›æ”¶&lt;/li>
&lt;/ol>
&lt;p>SMç®¡ç†ç€ä¸€æ‰¹å­˜å‚¨ç€æ•°æ®èŠ‚çš„èŠ‚ç‚¹ï¼ˆExtent Nodeï¼Œç®€ç§°ENï¼‰ï¼Œè¿™äº›èŠ‚ç‚¹å­˜å‚¨ç€æ•°æ®æµä¸­çš„èŠ‚ã€‚è¿™äº›èŠ‚ç‚¹ç›¸äº’é€šä¿¡ï¼Œä»¥å®Œæˆæäº¤ã€å¤‡ä»½ç­‰åŠŸèƒ½ã€‚&lt;/p>
&lt;p>ENèŠ‚ç‚¹ä¸­é‡‡ç”¨äº†é¢„å†™å…¥æ—¥å¿—ã€‚æ¯ä¸€æ¬¡å†™å…¥æ“ä½œï¼ŒENä¼šå¹¶å‘çš„&lt;/p>
&lt;ol>
&lt;li>è¿½åŠ å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å°†æ–°æ•°æ®å†™å…¥å†…å­˜ç¼“å­˜&lt;/li>
&lt;li>å†™å…¥æŒä¹…åŒ–å­˜å‚¨&lt;/li>
&lt;/ol>
&lt;p>å½“äºŒè€…æœ‰ä¸€ä¸ªå®Œæˆï¼Œå°±è¿”å›æˆåŠŸæ ‡è®°ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œç”±äºHDDè¿½åŠ å†™å…¥çš„æ€§èƒ½éå¸¸å¥½å¹¶ä¸”ç¨³å®šï¼Œæ‰€ä»¥æ­¥éª¤1çš„å“åº”æ—¶é—´æ˜¯ç¨³å®šçš„å¹¶ä¸”å¯ä»¥ä¼°è®¡çš„ã€‚ä¿è¯äº†ç³»ç»Ÿæ•´ä½“çš„å“åº”æ—¶é—´ä¸å‡ºç°å¤§çš„é¢ ç°¸ã€‚&lt;/p>
&lt;h2 id="was---åˆ†åŒºå±‚">WAS - åˆ†åŒºå±‚ &lt;a href="#was---%e5%88%86%e5%8c%ba%e5%b1%82" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åˆ†åŒºå±‚ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¢«ç§°ä¸ºâ€œå¯¹è±¡è¡¨â€ï¼ˆObject Tableï¼‰çš„æŠ½è±¡ã€‚å¯¹è±¡è¡¨æä¾›äº†æ’å…¥ã€æ›´æ–°ã€åˆ é™¤åŠŸèƒ½ã€‚&lt;/p>
&lt;p>ä¸ºäº†æä¾›å®¹é‡æ”¯æŒï¼Œä¸€ä¸ªå¯¹è±¡è¡¨ä¼šè¢«åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼ˆè¿™å°±æ˜¯â€œåˆ†åŒºå±‚â€åå­—çš„æ¥æºï¼‰ã€‚åˆ†åŒºä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¼šäº’ç›¸å½±å“ã€‚&lt;/p>
&lt;p>å¯¹è±¡è¡¨æ„å»ºåœ¨æ•°æ®æµå±‚ä¹‹ä¸Šã€‚ä½†æ˜¯ä»ç›´è§‚ä¸Šæ¥è®²ï¼Œè¡¨ç»“æ„å’Œæµç»“æ„æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œé‚£ä¹ˆåˆ†åŒºå±‚æ˜¯å¦‚ä½•å°†è¡¨å­˜å‚¨åœ¨æ•°æ®æµå±‚çš„å‘¢ï¼Ÿ&lt;/p>
&lt;h3 id="lsm-treelog-structed-merge-tree">LSM Treeï¼ˆLog-Structed Merge-Treeï¼‰ &lt;a href="#lsm-treelog-structed-merge-tree" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;blockquote>
&lt;p>æ®µå­ï¼š &lt;br>
ä¸€ä¸ªå­¦ç”ŸèƒŒç€æ»¡ä¹¦åŒ…çš„ä¹¦è¿›å…¥å›¾ä¹¦é¦†ï¼Œå®å®å®ï¼Œå›¾ä¹¦é¦†çš„æŠ¥è­¦å™¨å“äº†ï¼Œå­¦ç”Ÿèµ¶ç´§æŠŠä¹¦ä»ä¹¦åŒ…å€’å‡ºæ¥ï¼Œå‡†å¤‡ä¸€æœ¬ä¸€æœ¬çš„éªŒè¯ï¼Œçœ‹æ˜¯å“ªæœ¬ä¹¦æœ‰é—®é¢˜ã€‚ &lt;br>
ä¸€æ—æ‰«åœ°çš„é˜¿å§¨çœ‹ä¸ä¸‹å»äº†ï¼Œè¿‡æ¥æŠŠä¹¦åˆ†æˆäº†ä¸¤æŒªï¼Œå…ˆæ£€æŸ¥ç¬¬ä¸€æŒªï¼Œå®å®å®ï¼ŒæŠ¥è­¦å™¨å“äº†ï¼Œè¯´æ˜è¿™ä¸€æŒªæœ‰é—®é¢˜ï¼ŒåˆæŠŠè¿™ä¸€æŒªåˆ†æˆä¸¤æŒªï¼Œå…ˆæ£€æŸ¥å…¶ä¸­ä¸€æŒªï¼Œè¦æ˜¯å“ªä¸€æŒªå“äº†ï¼Œå°±æŠŠè¿™ä¸€æŒªç»§ç»­åˆ†æˆä¸¤æŒªï¼Œç»§ç»­æ£€æŸ¥ï¼Œä¸åˆ°ä¸‰å›åˆï¼Œå¤§å¦ˆå°±æŠŠæœ‰é—®é¢˜çš„å“ªæœ¬ä¹¦æ‰¾å‡ºæ¥äº†ã€‚ &lt;br>
å¤§å¦ˆç”¨é„™è§†çš„çœ¼ç¥çœ‹ç€é‚£å­¦ç”Ÿï¼Œä»¿ä½›åœ¨è¯´è¿Oï¼ˆnï¼‰è·ŸOï¼ˆlog nï¼‰éƒ½åˆ†ä¸æ¸…æ¥šã€‚&lt;/p>&lt;/blockquote>
&lt;p>æˆ‘ä»¬ä¸Šæ–‡ä¸­æåˆ°ï¼ŒHDDç£ç›˜å¯ä»¥åœ¨è¾ƒä½æˆæœ¬ä¸‹æä¾›å¾ˆå¥½çš„è¿½åŠ å†™å…¥æ€§èƒ½ï¼Œä½†æ˜¯å¯¹äºéšæœºè¯»å†™çš„æ€§èƒ½ä¸ä½³ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å¯¹äºè¡¨ç»“æ„æ¥è¯´ï¼Œå¿…ç„¶æ¶‰åŠåˆ°å¤§é‡çš„éšæœºè¯»å†™ã€‚å› ä¸ºè¾“å…¥æ•°æ®å°±åƒæ‰“ä¹±è¿‡çš„æ‰‘å…‹ç‰Œï¼Œå¾ˆéš¾ä¿è¯è§„å¾‹æ€§ï¼›è€Œæˆ‘ä»¬åˆè¦æŠŠç‰¹å®šçš„è¾“å…¥æ•°æ®æ”¾åˆ°ç‰¹å®šçš„è¡Œä¸Šï¼Œæ‰€ä»¥æ•°æ®çš„å†™å…¥ä½ç½®å¿…ç„¶æ˜¯éšæœºçš„ã€‚æ‰€ä»¥ï¼Œç›´æ¥åœ¨ç£ç›˜ä¸­å­˜å‚¨è¡¨ç»“æ„æ˜¯éå¸¸ä½æ•ˆçš„ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆLSM Treeæ˜¯æ€ä¹ˆè§£å†³é—®é¢˜çš„å‘¢ï¼Ÿ&lt;/p>
&lt;p>é¦–å…ˆæˆ‘ä»¬æŠŠå·²æœ‰çš„æ•°æ®æ ¹æ®keyè¿›è¡Œæ’åºï¼Œå­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œæ ‡è®°ç¬¬0ä»£ã€‚æ‰€æœ‰å†™å…¥ç£ç›˜çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ã€åªè¯»çš„ã€‚&lt;/p>
&lt;p>å½“æœ‰æ–°çš„æ•°æ®å†™å…¥æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆå°†å…¶ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚å½“æ•°æ®è¾¾åˆ°ä¸€ä¸ªé˜ˆå€¼æ—¶ï¼Œæˆ‘ä»¬å°†å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ’åºï¼Œå¹¶å†™å…¥ç£ç›˜ã€‚è¿™ä¸€éƒ¨åˆ†æ•°æ®è¢«æ ‡è®°ä¸ºç¬¬1ä»£ã€‚&lt;/p>
&lt;p>ä¹‹åçš„æ•°æ®ä¾æ¬¡ç±»æ¨ï¼Œè¢«æ ‡è®°ä¸ºç¬¬2ä»£ï¼Œç¬¬3ä»£&amp;hellip;ç¬¬nä»£ã€‚ä»£æ•°è¶Šé«˜ï¼Œè¡¨ç¤ºæ•°æ®è¶Šæ–°ã€‚å¹¶ä¸”ä»£æ•°é«˜çš„æ•°æ®åœ¨é€»è¾‘ä¸Šå¯ä»¥è¦†ç›–ä»£æ•°ä½çš„æ•°æ®ã€‚&lt;/p>
&lt;p>åœ¨æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€ç´¢å†…å­˜ä¸­çš„ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¾æ¬¡ä»ç¬¬nä»£çš„æ•°æ®æŸ¥è¯¢åˆ°ç¬¬0ä»£ã€‚å¦‚æœä»ç„¶æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±è¿”å›æœªæ‰¾åˆ°ã€‚ç”±äºæ‰€æœ‰çš„æŸ¥è¯¢éƒ½ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨[å¸ƒéš†è¿‡æ»¤å™¨][6]ï¼Œå¿«é€Ÿåˆ¤å®šä¸€ä¸ªkeyæ˜¯å¦åœ¨LSM Treeä¸­ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼ŒæŒ‰ç…§ä¸Šé¢æè¿°çš„ç®—æ³•ï¼ŒLSM Treeçš„ä»£æ•°ä¼šæ— é™è†¨èƒ€ä¸‹å»ï¼Œæœ€ç»ˆå¯¼è‡´éå¸¸å·®çš„çš„æ£€ç´¢æ•ˆæœã€‚åœ¨è®ºæ–‡ä¸­æ²¡æœ‰æ˜ç¡®æåˆ°LSM Treeçš„è°ƒæ•™å‚æ•°ï¼Œä½†æ˜¯æˆ‘çŒœæµ‹å…¶ä»£æ•°ä¸ä¼šå¤ªå¤šã€‚å¹¶ä¸”åœ¨å†—ä½™æ•°æ®è¿‡å¤šæ—¶ï¼Œä¼šè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¿è¯æ£€ç´¢çš„æ•ˆç‡ã€‚ &lt;br>
åŒæ—¶è¿™ä¹Ÿæé†’æˆ‘ä»¬åœ¨ä½¿ç”¨WASçš„æ—¶å€™ï¼Œå°½é‡ä¸è¦å‘æŸä¸€ä¸ªæˆ–æŸä¸€äº›è¿ç»­çš„åˆ†åŒºè¿ç»­å†™å…¥å¤§é‡æ•°æ®ï¼Œå¦åˆ™ä¼šå¯¼è‡´åˆ†åŒºå±‚çš„æ€§èƒ½é€€åŒ–ã€‚&lt;/p>&lt;/blockquote>
&lt;h3 id="åˆ†åŒºå±‚ä½¿ç”¨çš„æ•°æ®æµ">åˆ†åŒºå±‚ä½¿ç”¨çš„æ•°æ®æµ &lt;a href="#%e5%88%86%e5%8c%ba%e5%b1%82%e4%bd%bf%e7%94%a8%e7%9a%84%e6%95%b0%e6%8d%ae%e6%b5%81" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åˆ†åŒºå±‚ä½¿ç”¨æ•°æ®æµæ¥ä¿å­˜LSM Treeï¼Œä½¿ç”¨é¡ºåºå†™å…¥ä»£æ›¿éšæœºå†™å…¥ä»¥è·å¾—æ€§èƒ½æå‡ï¼Œè¿™æ¡æµè¢«ç§°ä¸ºâ€œè¡Œæ•°æ®æµâ€ï¼ˆRow Data Streamï¼‰ã€‚&lt;/p>
&lt;p>ä¸æ­¤åŒæ—¶ï¼Œåˆ†åŒºå±‚è¿˜ä½¿ç”¨äº†â€œäºŒè¿›åˆ¶æ•°æ®æµâ€ï¼ˆBlob Data Streamï¼‰æ¥ä¿å­˜äºŒè¿›åˆ¶æ•°æ®ã€‚ä»¥åŠâ€œæäº¤æ—¥å¿—æµâ€ï¼ˆCommit Log Streamï¼‰æ¥æŒä¹…åŒ–é¢„å†™å…¥æ—¥å¿—ã€‚&lt;/p>
&lt;p>åˆ†åŒºå±‚å‘æ•°æ®æµå±‚å†™å…¥æ—¶ï¼Œåªæœ‰å½“æ•°æ®æµå±‚è¿”å›ACKåï¼Œæ‰è®¤ä¸ºå†™å…¥æˆåŠŸã€‚æ‰€ä»¥ï¼Œåœ¨æ•°æ®æµå±‚å†™å…¥æˆåŠŸï¼Œä½†æœªèƒ½è¿”å›ACKæ—¶ï¼Œè™½ç„¶æ•°æ®æµå±‚ä¿ç•™äº†æ•°æ®ï¼Œä½†æ˜¯åˆ†åŒºå±‚å¹¶ä¸èƒ½è®¿é—®è¿™éƒ¨åˆ†æ•°æ®ï¼Œæˆ‘ä»¬å°±åœ¨åˆ†åŒºå±‚ä¿è¯äº†æ•°æ®çš„æ­£ç¡®æ€§ã€‚&lt;/p>
&lt;h3 id="åˆ†åŒºå±‚çš„ä¸€è‡´æ€§ä¿è¯">åˆ†åŒºå±‚çš„ä¸€è‡´æ€§ä¿è¯ &lt;a href="#%e5%88%86%e5%8c%ba%e5%b1%82%e7%9a%84%e4%b8%80%e8%87%b4%e6%80%a7%e4%bf%9d%e8%af%81" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åˆ†åŒºå±‚çš„æŒä¹…åŒ–ä¿¡æ¯ä¾èµ–äºæ•°æ®æµå±‚ï¼Œæ‰€ä»¥å¦‚æœåˆ†åŒºå±‚ä½¿ç”¨åœ¨çº¿å¤šå‰¯æœ¬ï¼Œå°±ä¼šé‡åˆ°èŠ‚ç‚¹çŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶ä¸åŒçš„èŠ‚ç‚¹åŠ è½½äº†ç›¸åŒçš„æ•°æ®ï¼Œä½†æ˜¯åŠ è½½é€Ÿåº¦æœ‰å¿«æœ‰æ…¢ï¼Œå¾ˆéš¾ä¿è¯èŠ‚ç‚¹ä¹‹é—´ä»¥ä¸€ä¸ªåŒæ ·çš„çŠ¶æ€å¯¹å¤–æœåŠ¡ã€‚åŒæ—¶ï¼Œåœ¨çº¿å¤šå‰¯æœ¬çš„å†™å…¥ä¼šå¼•å…¥ç«æ€ï¼Œå¦‚æœå†åŠ é”ï¼Œå°±ä¼šå¤§å¤§çš„å½±å“ç³»ç»Ÿçš„æ•ˆç‡ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆWASæ˜¯æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ&lt;/p>
&lt;p>ç­”ï¼šä¸èƒ½ä¿è¯ä¸€è‡´æ€§å°±ä¸è¦ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;p>è¿™æ ·çš„ä¸è¦ä¸€è‡´æ€§å¹¶ä¸æ˜¯æ”¾ä»»èŠ‚ç‚¹é—´çš„çŠ¶æ€ä¸åŒæ­¥ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªåˆ†åŒºåªä½¿ç”¨ä¸€ä¸ªåœ¨çº¿æœåŠ¡èŠ‚ç‚¹ã€‚å¯¹äºå”¯ä¸€ä¸€ä¸ªèŠ‚ç‚¹æ¥è¯´ï¼Œä¸€è‡´æ€§å°±æ˜¯ä¸å­˜åœ¨çš„ã€‚ï¼ˆæ˜¯ä¸æ˜¯éå¸¸æš´åŠ›ï¼‰&lt;/p>
&lt;p>æ‰€ä»¥ï¼Œåœ¨åŒä¸€æ—¶é—´åªæœ‰ä¸€å°æœºå™¨å¯¹å¤–æä¾›æœåŠ¡ï¼ˆè¯»+å†™ï¼‰ã€‚å…¶å®ƒçš„å‰¯æœ¬æ˜¯åœ¨çº¿å¤‡ä»½ï¼Œåœ¨å¯¹å¤–æä¾›æœåŠ¡çš„æœºå™¨åœ¨è®¡åˆ’å†…ä¸‹çº¿æˆ–æ„å¤–å½“æ‰æ—¶ï¼Œå°±ä¼šå¯ç”¨å¦ä¸€å°å‰¯æœ¬å¯¹å¤–æä¾›æœåŠ¡ã€‚å½“ç„¶è¿™ä¹Ÿä¼šé€ æˆä¸€è‡´æ€§é—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œç‰ºç‰²äº†ä¸€ç‚¹å¯ç”¨æ€§ï¼Œä¹Ÿå°±æ˜¯åœ¨æ—§èŠ‚ç‚¹ä¸‹çº¿åï¼Œæ–°èŠ‚ç‚¹å¿…é¡»åŠ è½½å®Œæ‰€æœ‰çš„æ•°æ®æ‰å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚ä¸­é—´çš„ä¸€æ®µæ—¶é—´è¿™ä¸ªåˆ†åŒºæ˜¯ä¸å¯ç”¨çš„ã€‚&lt;/p>
&lt;h3 id="åˆ†åŒºå±‚çš„æ¶æ„">åˆ†åŒºå±‚çš„æ¶æ„ &lt;a href="#%e5%88%86%e5%8c%ba%e5%b1%82%e7%9a%84%e6%9e%b6%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-10/51400577.jpg" alt="">&lt;/p>
&lt;p>å›¾ä¸­çš„PSæŒ‡çš„å°±æ˜¯ä¸Šæ–‡æåˆ°çš„åˆ†åŒºæœåŠ¡ï¼Œæ¯ä¸ªPSç»´æŠ¤ç€å¯¹è±¡è¡¨çš„ä¸€ä¸ªåˆ†åŒºï¼Œå…¶æŒä¹…åŒ–ä¿¡æ¯éƒ½å‚¨å­˜åœ¨æ•°æ®æµå±‚ä¸Šã€‚&lt;/p>
&lt;p>PMï¼ˆPartition Managerï¼‰ä¹Ÿæ˜¯ä½¿ç”¨paxosç®—æ³•é€‰ä¸¾å‡ºæ¥çš„masterèŠ‚ç‚¹ï¼Œç”¨æ¥ç®¡ç†åˆ†åŒºæœåŠ¡çš„è´Ÿè½½å‡è¡¡ã€ç¾å¤‡ç­‰æ“ä½œã€‚&lt;/p>
&lt;p>Lock Serviceç”¨æ¥å¯¹åˆ†åŒºèŠ‚ç‚¹è¿›è¡Œé€‰ä¸¾ï¼Œé€‰å‡ºçš„å”¯ä¸€masterèŠ‚ç‚¹å¯¹å¤–æä¾›æœåŠ¡ã€‚&lt;/p>
&lt;p>Partion Map Tableç”¨æ¥å­˜å‚¨ä¸æ£€ç´¢åˆ†åŒºæ‰€å¯¹åº”çš„èŠ‚ç‚¹ã€‚&lt;/p>
&lt;h2 id="was---å‰ç«¯å±‚">WAS - å‰ç«¯å±‚ &lt;a href="#was---%e5%89%8d%e7%ab%af%e5%b1%82" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>å‰ç«¯å±‚åªæ˜¯è–„è–„çš„ä¸€å±‚REST APIå°è£…ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆå…¶å®ƒç‰¹æ®ŠåŠŸèƒ½ã€‚è¿™é‡Œä¸€ç¬”å¸¦è¿‡ã€‚&lt;/p>
&lt;h2 id="æˆ˜èƒœcapç†è®ºä½ ä»–å¨˜çš„çœŸæ˜¯ä¸ªå¤©æ‰">æˆ˜èƒœCAPç†è®ºï¼Ÿä½ ä»–å¨˜çš„çœŸæ˜¯ä¸ªå¤©æ‰ï¼ &lt;a href="#%e6%88%98%e8%83%9ccap%e7%90%86%e8%ae%ba%e4%bd%a0%e4%bb%96%e5%a8%98%e7%9a%84%e7%9c%9f%e6%98%af%e4%b8%aa%e5%a4%a9%e6%89%8d" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-9-20/10049124.jpg" alt="">&lt;/p>
&lt;p>WASå®£ç§°è‡ªå·±æˆ˜èƒœäº†CAPç†è®ºï¼Œæä¾›äº†é«˜å¯ç”¨æ€§å’Œå¼ºä¸€è‡´æ€§ã€‚WASèƒ½åšåˆ°è¿™ç‚¹ä¸»è¦æ˜¯å› ä¸ºæ•°æ®æµå±‚è®¾è®¡çš„å¥½ã€‚&lt;/p>
&lt;p>æ•°æ®æµå±‚ä½¿ç”¨äº†åªè¿½åŠ å†™çš„æ•°æ®æ¨¡å‹ï¼ŒåŠ ä¸Šé“¾å¼æäº¤æä¾›çš„é«˜ä¸€è‡´æ€§ï¼Œæ‰€ä»¥èƒ½åº”å¯¹èŠ‚ç‚¹å¤±æ•ˆï¼ˆå¯ç”¨æ€§ï¼‰å’Œç½‘ç»œå¤±æ•ˆï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰çš„æ•…éšœã€‚&lt;/p>
&lt;p>æ•°æ®æµå±‚ä¹‹ä¸Šçš„åˆ†åŒºå±‚åˆ©ç”¨äº†å…¶ç‰¹æ€§ï¼Œå¾ˆå®¹æ˜“çš„å®ç°äº†é«˜å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ã€‚åŒæ—¶ï¼Œåˆç”±äºå…¶ä½¿ç”¨å•ç‚¹å‘å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä»¥ä¸€è‡´æ€§ä¹Ÿæœ‰äº†ä¿éšœã€‚&lt;/p>
&lt;p>æ‰€ä»¥WASå®£ç§°è‡ªå·±æˆ˜èƒœäº†CAPç†è®ºï¼Œä¹Ÿä¸æ˜¯æ²¡æœ‰é“ç†ã€‚ä½†æ˜¯ä¸ªäººæ„Ÿè§‰WASåœ¨åˆ†åŒºå±‚çš„å•ç‚¹è®¾å®šï¼Œæ˜¯ä»¥ç‰ºç‰²å¯ç”¨æ€§ï¼ˆAï¼‰æ¢å–ä¸€è‡´æ€§ï¼ˆCï¼‰çš„ä¸€ç§å¦¥åï¼Œåªæ˜¯ç”±äºæœºå™¨æ•…éšœå¹¶éå¤šå‘ï¼Œè§¦å‘é—®é¢˜çš„æœºç‡æ¯”è¾ƒå°ã€‚&lt;/p>
&lt;h2 id="å†™åœ¨åé¢">å†™åœ¨åé¢ &lt;a href="#%e5%86%99%e5%9c%a8%e5%90%8e%e9%9d%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æœ¬æ–‡æ˜¯ã€ŠWindows Azure Storage: A Highly Available Cloud Storage Service with Strong Consistencyã€‹ä¸€æ–‡çš„è¯»åæ„Ÿï¼Œåˆ èŠ‚äº†ä¸€éƒ¨åˆ†ä¸å®¹æ˜“ç†è§£çš„ç»†èŠ‚ã€‚æƒ³è¦æ›´è¯¦å°½çš„ç†è§£WASçš„è®¾è®¡æ€æƒ³ï¼Œè¯·é˜…è¯»è®ºæ–‡åŸæ–‡ä»¥åŠå®˜æ–¹æ–‡æ¡£ã€‚ä¸€åˆ‡å†…å®¹å’Œç†è§£ä¸Šçš„å†²çªï¼Œä»¥åŸæ–‡å’Œå®˜æ–¹æ–‡æ¡£ä¸ºå‡†ã€‚&lt;/p>
&lt;p>æ’°å†™æœ¬æ–‡æ—¶ï¼Œæˆ‘ä½¿ç”¨Atreus2tapè¿·ä¹‹å°é”®ç›˜ï¼Œåœ¨å­¦ä¹ å‰äººç»éªŒæ•™è®­çš„åŒæ—¶ï¼Œé‡æ–°å­¦ä¹ äº†æ‰“å­—ã€‚&lt;/p>
&lt;p>å°é”®ç›˜çš„å¥½å¤„æ˜¯ä¾¿æºï¼Œä»¥åŠé¿å…æ‰‹æŒ‡ç§»åŠ¨å¸¦æ¥çš„åŠ³æŸã€‚ç¼ºç‚¹æ˜¯éœ€è¦ç²¾å¿ƒè®¾è®¡å¹¶ç»ƒä¹ å¤§é‡çš„ç»„åˆé”®ï¼ŒåŒæ—¶æˆå¥—çš„é”®å¸½çœŸæ˜¯ä¸å¥½ä¹°ã€‚&lt;/p>
&lt;p>ä¸Šä¸€å¼ å›¾ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-10-10/71011744.jpg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>å¬è¯´ç”¨è¿™ç§å¥‡æ€ªé”®ç›˜çš„äººéƒ½æ³¨å­¤äº†ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ &lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="http://wetest.qq.com/lab/view/105.html">åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡çš„æ±‚ç”Ÿä¹‹è·¯&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://waylau.com/talk-about-distributed-system/">ç”¨å¤§ç™½è¯èŠèŠåˆ†å¸ƒå¼ç³»ç»Ÿ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://book.douban.com/subject/26292004/">ã€Šä»Paxosåˆ°Zookeeperã€‹&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf">Dynamo: Amazonâ€™s Highly Available Key-value Store&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>