<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Protobuf on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/protobuf/</link><description>Recent content in Protobuf on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Mon, 17 Nov 2014 00:25:42 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/protobuf/index.xml" rel="self" type="application/rss+xml"/><item><title>ç±»å‹-é•¿åº¦-å€¼ï¼ˆTLVï¼‰åè®®</title><link>https://wizmann.top/posts/tlv-protocol/</link><pubDate>Mon, 17 Nov 2014 00:25:42 +0000</pubDate><guid>https://wizmann.top/posts/tlv-protocol/</guid><description>&lt;p>åœ¨æ•°æ®é€šä¿¡åè®®ä¸­ï¼Œå¯é€‰çš„ä¿¡æ¯æˆ–å­—æ®µé€šå¸¸ä½¿ç”¨type-length-valueï¼ˆa.k.a TLVï¼‰å…ƒç´ æ¥è¿›è¡Œç¼–ç ã€‚&lt;/p>
&lt;ul>
&lt;li>Type - ç±»å‹&lt;/li>
&lt;/ul>
&lt;p>ç”¨æ¥æ ‡ç¤ºå­—æ®µç±»å‹çš„å€¼ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼æˆ–ç®€å•çš„å­—æ¯&lt;/p>
&lt;ul>
&lt;li>Length - é•¿åº¦&lt;/li>
&lt;/ul>
&lt;p>å­—æ®µé•¿åº¦ï¼Œå•ä½é€šå¸¸ä¸ºByte&lt;/p>
&lt;ul>
&lt;li>Value - å€¼&lt;/li>
&lt;/ul>
&lt;p>ä¸€ä¸ªå˜é•¿çš„æ¯”ç‰¹æ•°ç»„ç”¨æ¥å­˜å‚¨è¿™ä¸ªå­—æ®µçš„å€¼&lt;/p>
&lt;h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿ &lt;a href="#%e4%bc%98%e5%8a%bf" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>TLVåºåˆ—æ–¹ä¾¿éå†æŸ¥æ‰¾&lt;/li>
&lt;li>æ–°çš„å­—æ®µå¯ä»¥æ— ç—›çš„åŠ å…¥ç°æœ‰çš„åè®®ä¸­ã€‚è§£æçš„æ—¶å€™ï¼Œå¯¹äºæœªçŸ¥çš„å­—æ®µï¼Œå¯ä»¥è½»æ¾çš„è·³è¿‡ã€‚è¿™ç‚¹ä¸XMLç±»ä¼¼&lt;/li>
&lt;li>TLVå…ƒç´ çš„é¡ºåºå¯ä»¥æ˜¯éšæ„çš„&lt;/li>
&lt;li>TLVå…ƒç´ é€šå¸¸ä½¿ç”¨äºŒè¿›åˆ¶å­˜å‚¨ï¼Œå¯ä»¥ä½¿è§£æé€Ÿåº¦åŠ å¿«å¹¶ä¸”ä½¿æ•°æ®æ›´å°&lt;/li>
&lt;li>TLVå¯ä»¥ä¸XMLæ•°æ®ç›¸äº’è½¬æ¢ï¼Œæ˜“äºäººç±»é˜…è¯»&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾‹å­">ä¾‹å­ &lt;a href="#%e4%be%8b%e5%ad%90" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»¥protobufçš„å¯é€‰å’Œå˜é•¿å­—æ®µä¸ºä¾‹ã€‚&lt;/p>
&lt;h3 id="field_number--wire_type">field_number ++ wire_type &lt;a href="#field_number--wire_type" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æ¯ä¸€ä¸ªprotobufçš„å­—æ®µåœ¨ä¼ è¾“æ—¶ï¼Œéƒ½ä¼šåŠ ä¸Š&lt;code>field_number&lt;/code>å’Œ&lt;code>wire_type&lt;/code>è¿™ä¸¤ä¸ªå€¼ï¼Œè¿™ä¸¤ä¸ªå€¼ç»„æˆè¿™ä¸ªå­—æ®µçš„keyã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>key = (field_number &amp;lt;&amp;lt; 3) | wire_type
&lt;/code>&lt;/pre>&lt;p>&lt;code>field_number&lt;/code>æ ‡æ˜äº†å­—æ®µçš„ç¼–å·ï¼Œæ–¹ä¾¿åè®®å‘å‰å‘åçš„å…¼å®¹ã€‚è€Œ&lt;code>wire_type&lt;/code>æ ‡æ˜å­—æ®µçš„ç±»å‹ï¼Œæ–¹ä¾¿è§£æç¨‹åºä½¿ç”¨ç›¸åº”çš„æ–¹æ³•æ¥è¿›è¡Œååºåˆ—åŒ–ã€‚&lt;/p>
&lt;h3 id="varint-å˜é•¿æ•´å‹">Varint å˜é•¿æ•´å‹ &lt;a href="#varint-%e5%8f%98%e9%95%bf%e6%95%b4%e5%9e%8b" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¯¹äºä¸€ä¸ªå˜é•¿æ•´å‹å­—æ®µï¼Œprotobufä¸­ä½¿ç”¨Type(0)æ¥æ ‡ç¤ºï¼Œè€Œé•¿åº¦å¹¶æ²¡æœ‰æ˜¾å¼çš„æ ‡å‡ºã€‚&lt;/p>
&lt;p>Varintçš„å€¼ä½¿ç”¨å¦‚ä¸‹ç¼–ç æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>Varintä½¿ç”¨åˆ†æ®µå­˜å‚¨æ–¹æ³•ï¼Œæ¯ä¸ªByteä¸ºä¸€æ®µ&lt;/li>
&lt;li>Varintæ¯æ®µçš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯æ ‡ç¤ºä½ï¼Œå¦‚æœè¿™ä¸€ä½æ˜¯1ï¼Œåˆ™ä¸‹ä¸€ä¸ªByteä¹Ÿæ˜¯è¿™ä¸ªæ•°çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè¿™ä¸€ä½æ˜¯0ï¼Œåˆ™åœ¨è¿™ä¸ªByteæ˜¯è¿™ä¸ªVarintçš„æœ€åä¸€ä¸ªByte&lt;/li>
&lt;/ul>
&lt;h3 id="string-å˜é•¿å­—ç¬¦ä¸²">String å˜é•¿å­—ç¬¦ä¸² &lt;a href="#string-%e5%8f%98%e9%95%bf%e5%ad%97%e7%ac%a6%e4%b8%b2" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å­—ç¬¦ä¸²è¢«æ ‡ç¤ºä¸ºType(2)ï¼Œé•¿åº¦ä½¿ç”¨Varintç±»å‹æ˜¾å¼æ ‡å‡ºã€‚&lt;/p>
&lt;p>ä¸€ä¸ªstringåœ¨protobufä¸­è¢«ç¼–ç ä¸ºï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>encoded_string = key ++ length ++ string
&lt;/code>&lt;/pre>&lt;h2 id="å…¶å®ƒæ–¹æ³•">å…¶å®ƒæ–¹æ³• &lt;a href="#%e5%85%b6%e5%ae%83%e6%96%b9%e6%b3%95" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>TLVåŒæ ·ä¹Ÿå¯ä»¥è¡¨ç¤ºtag-length valueï¼Œä¾‹å¦‚HTTPã€FTPã€POP3ç­‰åè®®éƒ½æ˜¯ä½¿ç”¨è¿™ç§åŸºäºå¯è¯»æ–‡æœ¬çš„&amp;quot;Field: Value&amp;quot;åè®®ã€‚è¿™æ ·è®¾è®¡çš„åŸå› å¤§æ¦‚æ˜¯ç”±äºåœ¨â€œä¸Šå¤æ—¶ä»£â€ï¼Œäº’è”ç½‘é€Ÿåº¦è¿œå°äºCPUå¤„ç†çš„é€Ÿç‡ï¼ˆç°åœ¨æ›´åº”è¯¥æ˜¯&lt;strong>è¿œè¿œå°äº&lt;/strong>ï¼ŒCPUå·²ç»çˆ†äº†IOä¸€æ¡è¡—äº†ï¼‰ï¼Œè®¾è®¡ä¸€äº›æ›´å¯è¯»çš„åè®®å¯¹äººç±»æ¥è¯´ç¡®å®æ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;/p>
&lt;p>è€ŒTCP/IPæ ¸å¿ƒåè®®éƒ½ä½¿ç”¨çš„å®šé•¿ä¸å¯å˜çš„åè®®ï¼Œè¿™æ ·å¯ä»¥ä½¿ç¼–ç ã€è§£æé€Ÿç‡è¾¾åˆ°æœ€å¿«ã€‚&lt;/p>
&lt;p>å¯¹äºXMLå’Œjsonè¿™ç§å¥‡è¡Œç§ï¼Œæˆ‘ä»¬å°±ä¸è¯´äº†å§ :)&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ &lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="http://en.wikipedia.org/wiki/Type-length-value">Type-length-value&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.cnblogs.com/shitouer/archive/2013/04/12/google-protocol-buffers-encoding.html">Google Protocol Buffers ç¼–ç (Encoding)&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>