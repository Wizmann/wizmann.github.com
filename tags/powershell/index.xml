<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Powershell on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/powershell/</link><description>Recent content in Powershell on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Fri, 04 Jan 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/powershell/index.xml" rel="self" type="application/rss+xml"/><item><title>åœ¨WSLä¸­è·å–Windowså‰ªè´´æ¿ä¸­çš„å›¾ç‰‡</title><link>https://wizmann.top/posts/get-image-from-clipboard-in-wsl.md/</link><pubDate>Fri, 04 Jan 2019 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/get-image-from-clipboard-in-wsl.md/</guid><description>&lt;h2 id="èƒŒæ™¯">èƒŒæ™¯ &lt;a href="#%e8%83%8c%e6%99%af" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Win10é‡Œé¢çš„WSLï¼ˆWindows Subsystem For Linux)ç®—æ˜¯ä¸€ä¸ªå¼€å‘ç¥å™¨äº†ï¼Œè™½ç„¶åŠŸèƒ½ä¸æ˜¯100%å®Œå–„ï¼Œä½†æ˜¯å¯¹äºè½»åº¦å¼€å‘å·²ç»è¶³å¤Ÿäº†ã€‚ç°åœ¨æˆ‘çš„æ—¥å¸¸å¼€å‘ï¼Œå°±æ˜¯ä¸€ä¸ªå…¨å±CMDè·‘å†…éƒ¨å·¥å…·ï¼Œä¸€ä¸ªå…¨å±WSLè·‘tmux+vimã€‚&lt;/p>
&lt;p>ï¼ˆè·‘é¢˜äº†ï¼‰&lt;/p>
&lt;h2 id="é—®é¢˜">é—®é¢˜ &lt;a href="#%e9%97%ae%e9%a2%98" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ä¹‹å‰çš„æ–‡ç« é‡Œï¼Œæˆ‘æœ‰å†™åˆ°ä½¿ç”¨githubåšä¸ºå›¾åºŠï¼Œå¹¶ä¸”ä½¿ç”¨pythonè„šæœ¬è¿›è¡Œå›¾ç‰‡ä¸Šä¼ ã€‚ä½†æ˜¯ä»æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œå°±æ˜¯ä¹‹å‰çš„è„šæœ¬åªèƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥ä¸Šä¼ å‰ªè´´æ¿é‡Œçš„å›¾ç‰‡ã€‚&lt;/p>
&lt;h2 id="è§£å†³">è§£å†³ &lt;a href="#%e8%a7%a3%e5%86%b3" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>å‘ç°Windowsé‡Œé¢æœ‰å†…ç½®çš„è®¿é—®å‰ªè´´æ¿å·¥å…·ï¼Œä½†æ˜¯åªåœ¨powershellä¸‹å¯ç”¨ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥åœ¨WSLé‡Œç›´æ¥è°ƒç”¨exeæ–‡ä»¶ï¼ˆè¿™ç‚¹éå¸¸ç¥å¥‡ï¼‰ï¼Œç„¶åè¯»å‡ºå›¾ç‰‡æ–‡ä»¶æ”¾å…¥ä¸´æ—¶æ–‡ä»¶å¤¹ã€‚ç„¶åæˆ‘ä»¬å†è¯»å‡ºè¿™ä¸ªæ–‡ä»¶è¿›è¡Œä¸Šä¼ ã€‚&lt;/p>
&lt;p>æ€»çš„æµç¨‹ä»ç„¶æ˜¯ä¸Šä¼ å·²æœ‰çš„å›¾ç‰‡æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹å¹¶éšè—äº†èµ·æ¥ã€‚çœ‹èµ·æ¥å°±æ˜¯å®ç°äº†WSLå’ŒWindowså‰ªè´´æ¿çš„äº’æ“ä½œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TMP&lt;span style="color:#f92672">=&lt;/span>/mnt/c/Users/me/AppData/Local/Temp/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TMPWIN&lt;span style="color:#f92672">=&lt;/span>C:&lt;span style="color:#ae81ff">\\&lt;/span>Users&lt;span style="color:#ae81ff">\\&lt;/span>me&lt;span style="color:#ae81ff">\\&lt;/span>AppData&lt;span style="color:#ae81ff">\\&lt;/span>Local&lt;span style="color:#ae81ff">\\&lt;/span>Temp&lt;span style="color:#ae81ff">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ts&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>date +&lt;span style="color:#e6db74">&amp;#34;%Y-%m-%d_%H-%M-%S&amp;#34;&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;(Get-Clipboard -Format Image).Save(\&amp;#34;&lt;/span>$TMPWIN&lt;span style="color:#e6db74">\\&lt;/span>$ts&lt;span style="color:#e6db74">.png\&amp;#34;)&amp;#34;&lt;/span> | /mnt/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe &amp;amp;&amp;gt; /dev/null
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> $? -ne &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;no image in clipboard&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python upload.py $TMP/$ts.png
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>