<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Storage on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/storage/</link><description>Recent content in Storage on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Sun, 15 Aug 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/storage/index.xml" rel="self" type="application/rss+xml"/><item><title>è®ºæ–‡é˜…è¯»-WiscKeyï¼šSSDå‹å¥½çš„KVåˆ†ç¦»å­˜å‚¨å¼•æ“</title><link>https://wizmann.top/posts/paper-wisckey/</link><pubDate>Sun, 15 Aug 2021 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/paper-wisckey/</guid><description>&lt;h2 id="èƒŒæ™¯">èƒŒæ™¯ &lt;a href="#%e8%83%8c%e6%99%af" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="åŸºäºlsm-treeçš„å­˜å‚¨å¼•æ“">åŸºäºLSM-Treeçš„å­˜å‚¨å¼•æ“ &lt;a href="#%e5%9f%ba%e4%ba%8elsm-tree%e7%9a%84%e5%ad%98%e5%82%a8%e5%bc%95%e6%93%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>Log-Structed Merge-Tree (a.k.a. LSM-Tree)æ˜¯å½“ä¸‹å¸¸ç”¨çš„ä¸€ç§åŸºäºç£ç›˜çš„å­˜å‚¨å¼•æ“ã€‚ä¸Hashç´¢å¼•å’ŒB-TreeåŒä¸ºæ•°æ®åº“æ ¸å¿ƒçš„æ•°æ®ç»“æ„ã€‚&lt;/p>
&lt;p>LSM-Treeçš„ä¼˜åŠ¿åœ¨äºï¼š&lt;/p>
&lt;ol>
&lt;li>æ— éœ€å°†æ‰€æœ‰çš„Keyç´¢å¼•åœ¨å†…å­˜ä¸­ã€‚å¯ä»¥é€šè¿‡åˆ†çº§æŸ¥æ‰¾çš„æ–¹å¼ï¼ŒæŸ¥è¯¢åˆ°ç‰¹å®šKVåœ¨ç£ç›˜ä¸­çš„åç§»é‡&lt;/li>
&lt;li>æ•°æ®å†™å…¥ä¸åˆå¹¶ä½¿ç”¨é¡ºåºè¿½åŠ å†™ï¼Œæœ€å¤§ç¨‹åº¦çš„åˆ©ç”¨ç£ç›˜çš„é¡ºåºå†™æ€§èƒ½&lt;/li>
&lt;li>å¯¹äºæ•°æ®å†™å…¥ï¼Œä¼šä½¿ç”¨batchæ–¹å¼å†™å…¥ç£ç›˜&lt;/li>
&lt;li>æ”¯æŒèŒƒå›´æŸ¥è¯¢&lt;/li>
&lt;/ol>
&lt;p>LSM-Treeçš„åŠ£åŠ¿åœ¨äºï¼š&lt;/p>
&lt;ol>
&lt;li>è¯»æ”¾å¤§ä¸å†™æ”¾å¤§&lt;/li>
&lt;li>æ— æ³•å¯¹å•æ¡æ•°æ®åŠ é”ï¼ˆäº‹åŠ¡æ”¯æŒï¼‰&lt;/li>
&lt;/ol>
&lt;p>ç°åœ¨å¸¸ç”¨çš„LevelDBå’ŒRocksDBï¼Œéƒ½æ˜¯åŸºäºLSM-Treeçš„å­˜å‚¨å¼•æ“ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-14/2021-08-14_18-00-50.png" alt="LSM-Tree-Architecture">&lt;/p>
&lt;h3 id="wisckeyä¸»è¦è§£å†³çš„é—®é¢˜">WiscKeyä¸»è¦è§£å†³çš„é—®é¢˜ &lt;a href="#wisckey%e4%b8%bb%e8%a6%81%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>LSM-Treeåœ¨æ€§èƒ½ä¸Šé¢çš„ç“¶é¢ˆä¸»è¦åœ¨äºè¯»å†™çš„æ”¾å¤§ã€‚ç®€å•è¯´æ¥ï¼Œå‡è®¾ä½ çš„ç£ç›˜æœ€å¤§å¸¦å®½ä¸º4GB/sï¼Œè¯»å†™æ”¾å¤§å€æ•°ä¸º10ï¼Œé‚£ä¹ˆåœ¨åº”ç”¨å±‚çš„æœ‰æ•ˆååé‡ï¼ˆ&lt;a href="https://en.wikipedia.org/wiki/Goodput">Goodput&lt;/a>ï¼‰æœ€å¤šåªèƒ½è¾¾åˆ°400MB/sã€‚å¹¶ä¸”ï¼Œå¯¹äºä¸€äº›å¤§æ•°æ®é›†ï¼Œè¯»å†™æ”¾å¤§çš„å€¼æœ‰å¯èƒ½ä¼šéå¸¸å¤§ï¼ˆå¤§äº100ï¼‰ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„è¯»å†™æ”¾å¤§å‘¢ï¼Ÿæˆ‘ä»¬ä¸‹é¢åˆ†å¼€è®¨è®ºã€‚&lt;/p>
&lt;h4 id="è¯»æ”¾å¤§">è¯»æ”¾å¤§ &lt;a href="#%e8%af%bb%e6%94%be%e5%a4%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æˆ‘ä»¬é‡æ¸©ä¸€ä¸‹LSM-Treeçš„æŸ¥è¯¢æœºåˆ¶ï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆåœ¨mutable memtableä¸­è¿›è¡ŒæŸ¥æ‰¾&lt;/li>
&lt;li>ç„¶ååœ¨immutable memtableä¸­è¿›è¡ŒæŸ¥æ‰¾&lt;/li>
&lt;li>æœ€ååœ¨ä¸åŒçš„LSM-Treeå±‚çº§ä¸­çš„SST fileä¸­è¿›è¡ŒæŸ¥æ‰¾&lt;/li>
&lt;/ol>
&lt;p>å¯¹äº1å’Œ2ï¼Œéƒ½æ˜¯å†…å­˜æ“ä½œï¼Œå…¶è€—æ—¶ä¸è¯»å–ç£ç›˜ç›¸æ¯”å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚
å¯¹äº3ï¼ŒSST fileæ–‡ä»¶çš„æŸ¥æ‰¾ä¼šå…ˆä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®šä½ç‰¹å®šKVä½äºè¯¥å±‚çš„å“ªä¸€ä¸ªSSTæ–‡ä»¶ä¸­ã€‚&lt;/p>
&lt;p>å¦‚æœç‰¹å®šçš„KVä¸å­˜åœ¨äºæ­¤SSTæ–‡ä»¶ä¸­ï¼Œä¼šè¢«å¸¸é©»å†…å­˜çš„bloom filterè¿‡æ»¤æ‰ï¼Œä¸ä¼šçœŸæ­£çš„è¯»å–æ–‡ä»¶ã€‚ï¼ˆå¤§æ¦‚ç‡ï¼Œbloom filterçš„åŸç†äº†è§£ä¸€ä¸‹ï¼‰&lt;/p>
&lt;p>å¦‚æœç‰¹å®šçš„KVåœ¨æ­¤SSTæ–‡ä»¶ä¸­ï¼Œä¼šé€šè¿‡index blockè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œç¡®å®šKVä½äºå“ªä¸ªblockã€‚ç„¶åè¿™ä¸ªblockä¼šè¢«ä»ç£ç›˜ä¸Šè¯»å–åˆ°å†…å­˜è¿›è¡Œè§£å‹ï¼Œæœ€åé€šè¿‡äºŒåˆ†+éå†æ‰¾åˆ°å¯¹åº”çš„KVã€‚&lt;/p>
&lt;blockquote>
&lt;p>è®ºæ–‡é‡Œå¯¹äºè¯»æ”¾å¤§çš„è®¡ç®—æ–¹æ³•æœ‰ç‚¹å¤¸å¤§äº†ã€‚å¯¹äºRocksDBæ¥è¯´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹index blockå’Œbloom filteréƒ½æ˜¯å¸¸é©»å†…å­˜çš„ã€‚é™¤éæ˜¯å†…å­˜éå¸¸ç´§å¼ çš„åœºæ™¯ï¼Œå¦åˆ™å¹¶ä¸ä¼šäº§ç”Ÿè®ºæ–‡ä¸­å¦‚æ­¤å¤¸å¼ çš„ç£ç›˜è¯»æ”¾å¤§çš„ã€‚&lt;/p>&lt;/blockquote>
&lt;p>æ‰€ä»¥è¯»æ”¾å¤§ä¸»è¦å› ä¸ºè¯»å–ä¸€ä¸ªKVï¼Œéœ€è¦è¯»å–+è§£å‹æ•´ä¸ªblockã€‚å½“KVå¤§å°è¿œå°äºblock sizeçš„æ—¶å€™ï¼Œé—®é¢˜ä¼šæ›´åŠ ä¸¥é‡ã€‚&lt;/p>
&lt;h4 id="å†™æ”¾å¤§">å†™æ”¾å¤§ &lt;a href="#%e5%86%99%e6%94%be%e5%a4%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æˆ‘ä»¬å†é‡æ¸©ä¸€ä¸ªLSM-Treeçš„å†™å…¥æœºåˆ¶ï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆå†™å…¥mutable memtable&lt;/li>
&lt;li>mutable memtableåç»­ä¼šè¢«sealedï¼Œæˆä¸ºimmutable memtable&lt;/li>
&lt;li>immutable memtableä¼šè¢«flushåˆ°ç£ç›˜ï¼Œæˆä¸ºL0&lt;/li>
&lt;li>L0ä¸­çš„æ•°æ®ä¼šåœ¨åå°ï¼Œé€å±‚å‘ä¸‹åˆå¹¶ï¼Œç›´åˆ°åˆå¹¶åˆ°æœ€åº•å±‚&lt;/li>
&lt;/ol>
&lt;p>å±‚æ¬¡æ•°æ®é€å±‚å‘ä¸‹åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œå¿…ç„¶ä¼šäº§ç”Ÿå†™æ”¾å¤§ã€‚ï¼ˆå…·ä½“åŸç†è¿™é‡Œä¸å±•å¼€äº†ï¼‰&lt;/p>
&lt;p>å†™æ”¾å¤§å€¼å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¼°ç®—ã€‚å·²çŸ¥&lt;code>options.max_bytes_for_level_multiplier&lt;/code>ä»£è¡¨æ¯ä¸€å±‚å¤§å°çš„å€æ•°kï¼Œå¹¶ä¸”å‡è®¾L0ä¸L1çš„å¤§å°ç›¸ç­‰ï¼Œæ€»å…±æœ‰Nå±‚ã€‚é‚£ä¹ˆå†™æ”¾å¤§çº¦ä¸º&lt;code>(N - 1) * k + 1&lt;/code>ã€‚&lt;/p>
&lt;h2 id="æ­£æ–‡">æ­£æ–‡ &lt;a href="#%e6%ad%a3%e6%96%87" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;blockquote>
&lt;p>å…¥æ´»äº†å…¥æ´»äº†ï¼&lt;/p>&lt;/blockquote>
&lt;h3 id="wisckeyçš„è®¾è®¡ç›®æ ‡">WiscKeyçš„è®¾è®¡ç›®æ ‡ &lt;a href="#wisckey%e7%9a%84%e8%ae%be%e8%ae%a1%e7%9b%ae%e6%a0%87" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;ul>
&lt;li>é™ä½å†™æ”¾å¤§&lt;/li>
&lt;li>é™ä½è¯»æ”¾å¤§&lt;/li>
&lt;li>å¯¹SSDè¿›è¡Œä¼˜åŒ–&lt;/li>
&lt;li>æä¾›LSM-Treeå…¼å®¹çš„API&lt;/li>
&lt;li>é’ˆå¯¹ç°å®åœºæ™¯çš„KV size&lt;/li>
&lt;/ul>
&lt;h3 id="wisckeyçš„è®¾è®¡æ€è·¯kvåˆ†ç¦»">WiscKeyçš„è®¾è®¡æ€è·¯â€”â€”KVåˆ†ç¦» &lt;a href="#wisckey%e7%9a%84%e8%ae%be%e8%ae%a1%e6%80%9d%e8%b7%afkv%e5%88%86%e7%a6%bb" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨ä¸€èˆ¬çš„åœºæ™¯ä¸­ï¼Œåœ¨ä¸€å¯¹KVä¸­ï¼ŒKeyçš„å¤§å°è¿œæ¯”Valueçš„è¦å°ã€‚å¦‚æœæˆ‘ä»¬åœ¨LSM-Treeä¸­åªä¿ç•™Keyï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¬¡è¯»å†™ï¼Œæˆ‘ä»¬æ‰€è¦å¤„ç†çš„æ•°æ®å°±ä¼šå°‘å¾ˆå¤šï¼Œä»è€Œé™ä½äº†è¯»å†™æ”¾å¤§ã€‚&lt;/p>
&lt;p>å¯¹äºValueï¼Œæˆ‘ä»¬ä¼šå°†å…¶å­˜å‚¨åœ¨å¦å¤–ä¸€ä¸ªæ•°æ®ç»“æ„vLogä¸­ã€‚æ¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œä¼šåœ¨LSM-Treeä¸­è®°å½•å…¶åœ¨vLogä¸­çš„&lt;code>&amp;lt;offset, length&amp;gt;&lt;/code> ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¯»å–Valueçš„æ“ä½œä¹Ÿåªæœ‰ä¸€æ¬¡ç£ç›˜è®¿é—®ï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿå†™æ”¾å¤§ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-14/2021-08-14_23-08-54.png" alt="WiscKey-data-layout">&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œå¦‚æœæŒ‰è®ºæ–‡é‡Œé¢çš„è®¾è®¡ï¼ŒvLogé‡Œé¢çš„æ•°æ®æ˜¯ä¸ä¼šæ‰“åŒ…çš„blockè¿›è¡Œå‹ç¼©çš„ï¼Œå¿…ç„¶ä¼šæŸå¤±capacityã€‚å¦‚æœæ‰“åŒ…å‹ç¼©äº†ï¼Œé‚£ä¹ˆè¯»æ”¾å¤§å¹¶æ²¡æœ‰æ˜¾è‘—ä¼˜åŒ–ã€‚åˆå¦‚æœvalue size â‰ˆ block sizeï¼Œé‚£ä¹ˆå…¶å®åœ¨è¯»æ”¾å¤§ä¸Šé¢çš„ä¼˜åŒ–ä¹Ÿå°±æ¯”è¾ƒå¾®å¼±äº†ã€‚&lt;/p>&lt;/blockquote>
&lt;h3 id="wisckeyçš„è®¾è®¡æŒ‘æˆ˜">WiscKeyçš„è®¾è®¡æŒ‘æˆ˜ &lt;a href="#wisckey%e7%9a%84%e8%ae%be%e8%ae%a1%e6%8c%91%e6%88%98" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="å¹¶å‘èŒƒå›´æŸ¥æ‰¾">å¹¶å‘èŒƒå›´æŸ¥æ‰¾ &lt;a href="#%e5%b9%b6%e5%8f%91%e8%8c%83%e5%9b%b4%e6%9f%a5%e6%89%be" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>å› ä¸ºä½¿ç”¨äº†KVåˆ†ç¦»çš„å­˜å‚¨æ–¹å¼ï¼Œæ‰€ä»¥èŒƒå›´æŸ¥æ‰¾ï¼ˆrange queryï¼‰å¯¹äºvalueå°±ä¼šé€€åŒ–æˆå¾ˆå¤šæ¬¡éšæœºè¯»å–ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ç”±äºSSDçš„å¹¶å‘è¯»å–ç‰¹æ€§ï¼ŒWiscKeyä¼šå°†æ‰€éœ€è¦è¯»å–çš„valueçš„&lt;code>&amp;lt;offset, length&amp;gt;&lt;/code>æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¤šçº¿ç¨‹å¹¶å‘è¯»å–æ‰€éœ€è¦çš„valueã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-14/2021-08-14_23-42-44.png" alt="seq-rand-reads-on-ssd">&lt;/p>
&lt;p>å¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äºè¾ƒå¤§çš„value sizeï¼Œé¡ºåºè¯»ä¸å¹¶å‘è¯»çš„throughputåŸºæœ¬ä¿æŒä¸€è‡´ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å¤šçº¿ç¨‹å¹¶å‘è¯»ä¼šæ¶ˆè€—æ›´å¤šçš„CPUã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-15/2021-08-15_16-02-21.png" alt="CPU-usage">&lt;/p>
&lt;blockquote>
&lt;p>ä¸è¿‡å¯¹äºä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿæ¥è¯´ï¼ŒCPUå¤§æ¦‚æ˜¯æœ€ä¸é‡è¦çš„èµ„æºäº†å§ï¼ˆè§ä»è§æ™ºå’¯ï¼‰&lt;/p>&lt;/blockquote>
&lt;h4 id="åƒåœ¾å›æ”¶">åƒåœ¾å›æ”¶ &lt;a href="#%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>å¯¹äºé‡å¤å†™å…¥çš„KVï¼ŒLSM-Treeä¼šé€šè¿‡å±‚æ¬¡åˆå¹¶æ¥å°†æ—§å€¼æ¢å‡ºã€‚è€ŒWiscKeyä¼šä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶æ¥å°†æ—§å€¼æ¢å‡ºã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-15/2021-08-15_00-11-06.png" alt="vlog-data-layout">&lt;/p>
&lt;p>vLogå¯ä»¥è§†ä½œä¸€ä¸ªå¾ªç¯æ•°ç»„ï¼ŒheadæŒ‡é’ˆè¡¨ç¤ºæ•°æ®çš„å¼€å¤´ï¼ˆè¾ƒæ–°çš„æ•°æ®ï¼‰ï¼ŒtailæŒ‡é’ˆè¡¨ç¤ºæ•°æ®çš„ç»“å°¾ï¼ˆè¾ƒæ—§çš„æ•°æ®ï¼‰ã€‚åœ¨headå’ŒtailæŒ‡é’ˆä¹‹å¤–çš„ç©ºé—´éƒ½è§†ä½œfree spaceã€‚&lt;/p>
&lt;p>å½“ç©ºé—²æ•°æ®å°äºä¸€å®šé˜ˆå€¼ä¹‹åï¼Œä¼šè§¦å‘GCã€‚WiscKeyä¼šä»tailä¾æ¬¡è¯»å‡ºä¸€éƒ¨åˆ†æ—§æ•°æ®ï¼ˆbatch readï¼‰ï¼ŒæŸ¥è¯¢LSM-Treeï¼Œå¦‚æœè¿™æ¡æ•°æ®å·²ç»è¢«è¦†ç›–æˆ–åˆ é™¤ï¼Œé‚£ä¹ˆå°±ä¸¢å¼ƒæ­¤æ•°æ®ï¼›å¦åˆ™ä»headæŒ‡é’ˆå¤„å†™å…¥æ­¤æ¡æ•°æ®ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¿è¯åœ¨GCè¿‡ç¨‹ä¸­çš„crashä¸äº§ç”Ÿæ•°æ®çš„ä¸¢å¤±ï¼ŒGCçš„æµç¨‹ä¸ºï¼š&lt;/p>
&lt;ol>
&lt;li>å°†tailå¤„çš„KVå†™å…¥åˆ°headå¤„ï¼Œå¹¶è°ƒç”¨&lt;code>fsync()&lt;/code>å°†å…¶æŒä¹…åŒ–&lt;/li>
&lt;li>åŒæ­¥çš„å°†KVçš„æ–°ä½ç½®ï¼Œå’Œhead/tailæŒ‡é’ˆçš„æœ€æ–°ä½ç½®å†™å…¥LSM-Tree&lt;/li>
&lt;/ol>
&lt;p>ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†LSM-Treeçš„WALï¼Œå¯ä»¥ä¿è¯æ‰€æœ‰åœ¨LSM-Treeé‡Œçš„æ•°æ®éƒ½æ˜¯å¯ç”¨çš„ã€‚&lt;/p>
&lt;h4 id="å´©æºƒä¸€è‡´æ€§crash-consistency">å´©æºƒä¸€è‡´æ€§ï¼ˆCrash Consistencyï¼‰ &lt;a href="#%e5%b4%a9%e6%ba%83%e4%b8%80%e8%87%b4%e6%80%a7crash-consistency" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åœ¨åƒåœ¾å›æ”¶ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å…¶å®å·²ç»é‡åˆ°äº†ä¸€è‡´æ€§çš„é—®é¢˜ã€‚å…¶æ ¹æœ¬åŸå› ï¼Œåœ¨äºLSM-Treeå’ŒvLogæ˜¯ä¸¤ä¸ªä¸åŒçš„æ¨¡å—ï¼Œåœ¨å…¶é—´ä¿æŒä¸€è‡´æ€§å¿…ç„¶æ˜¯å›°éš¾çš„ã€‚&lt;/p>
&lt;p>WiscKeyä½¿ç”¨äº†ç°ä»£æ–‡ä»¶ç³»ç»Ÿï¼ˆext4ï¼Œbtrfså’Œxfsï¼‰çš„ä¸€ä¸ªæœ‰è¶£ç‰¹æ€§ï¼Œå³å¯¹äºä¸€ä¸ªï¼ˆå°†è¦ï¼‰å†™å…¥æ–‡ä»¶çš„æ•°æ®æµï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šä¿è¯è¿™ä¸ªæ•°æ®æµçš„ä¸€ä¸ªå‰ç¼€ï¼ˆæˆ–è€…æ•´ä¸ªæ•°æ®æµï¼‰æˆåŠŸå†™å…¥æ–‡ä»¶ã€‚&lt;/p>
&lt;h3 id="wisckeyçš„ä¼˜åŒ–">WiscKeyçš„ä¼˜åŒ– &lt;a href="#wisckey%e7%9a%84%e4%bc%98%e5%8c%96" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="vlogå†™å…¥buffer">vLogå†™å…¥Buffer &lt;a href="#vlog%e5%86%99%e5%85%a5buffer" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/21-08-15/2021-08-15_12-20-02.png" alt="impact-of-write-unit-size">&lt;/p>
&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œç£ç›˜çš„åŒæ­¥å†™å…¥å¿…ç„¶ä¼šå¸¦æ¥ä¸€äº›overheadã€‚å¯¹äºå°æ•°æ®æ¥è¯´ï¼Œè¿™åœ¨æ€§èƒ½ä¸Šä¼šäº§ç”Ÿä¸¥é‡çš„æŸè€—ã€‚&lt;/p>
&lt;p>è¿™é‡Œçš„ä¼˜åŒ–ç±»ä¼¼äºå°†vLogä¹Ÿæ·»åŠ ä¸€ä¸ªmemory tableï¼Œæ‰€æœ‰å†™å…¥vLogçš„æ•°æ®éƒ½å…ˆå†™å…¥è¿™ä¸ªmemory tableï¼Œç„¶åä¾æ¬¡flushåˆ°ç£ç›˜ä¸Šã€‚&lt;/p>
&lt;p>è¿™æ ·çš„ä¼˜åŠ¿åœ¨äºå°†å†™å…¥batchåŒ–ï¼Œå¯ä»¥å‡å°‘overheadï¼Œæå‡æ€§èƒ½ã€‚åŠ£åŠ¿åœ¨äºï¼Œåœ¨ç³»ç»Ÿå´©æºƒæ—¶ï¼Œå¯èƒ½ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚ä½†ä¸¢å¤±æ•°æ®æ—¶ï¼Œä»èƒ½æŠ±è¯ä¸Šæ–‡æåˆ°çš„å´©æºƒä¸€è‡´æ€§ã€‚&lt;/p>
&lt;h4 id="ä¼˜åŒ–lsm-tree-wal">ä¼˜åŒ–LSM-Tree WAL &lt;a href="#%e4%bc%98%e5%8c%96lsm-tree-wal" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>LSM-Treeçš„WALè™½ç„¶ä¿è¯äº†å†™å…¥çš„æ•°æ®çš„æŒä¹…æ€§ï¼Œä½†æ˜¯ä¸å¯é¿å…çš„ï¼Œå®ƒä¹Ÿä¼šæ¶ˆè€—ç£ç›˜çš„ä¸€éƒ¨åˆ†å¸¦å®½ã€‚&lt;/p>
&lt;p>å…³é—­WALï¼Œæ„å‘³ç€LSM-Tree memtableåœ¨è¿›ç¨‹é‡å¯æ—¶ä¸€å®šä¼šä¸¢å¤±æ•°æ®ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥åˆ©ç”¨vLogé‡å»ºLSM-Treeï¼ˆçš„memtableéƒ¨åˆ†ï¼‰ã€‚&lt;/p>
&lt;p>ç”±äºvLogä¹‹ä¸­å·²ç»åŒ…æ‹¬äº†æ‰€æœ‰çš„KVå¯¹ï¼Œæ‰€ä»¥åœ¨WiscKeyé‡å¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»headæŒ‡é’ˆå¤„æ‰«ævLogçš„æ•°æ®ï¼Œç”±äºå´©æºƒä¸€è‡´æ€§çš„ä¿è¯ï¼Œå½“æŒ‡é’ˆæ‰«æåˆ°å·²ç»å­˜åœ¨äºLSM-Treeçš„æ•°æ®æ—¶ï¼Œå¯ä»¥è®¤ä¸ºLSM-Treeå·²ç»é‡å»ºæˆåŠŸã€‚&lt;/p>
&lt;h4 id="æ–‡ä»¶ç³»ç»Ÿçš„ä¼˜åŒ–">æ–‡ä»¶ç³»ç»Ÿçš„ä¼˜åŒ– &lt;a href="#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%bc%98%e5%8c%96" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>WiscKeyä½¿ç”¨&lt;code>posix_fadvice()&lt;/code>å‘OSå±‚é¢„å£°æ˜æ¥ä¸‹æ¥vLogçš„æ“ä½œç±»å‹ä»¥é€‚åº”ä¸åŒåœºæ™¯çš„ç£ç›˜è®¿é—®æ¨¡å¼ã€‚ä½¿ç”¨&lt;code>fallocate()&lt;/code>ï¼Œé€šè¿‡&amp;quot;hole-punching&amp;quot;åŠŸèƒ½è¿›è¡ŒGCï¼Œä»¥å‡å°‘æ•°æ®çš„ç§»åŠ¨ã€‚&lt;/p>
&lt;h3 id="wisckeyçš„æ€§èƒ½">WiscKeyçš„æ€§èƒ½ &lt;a href="#wisckey%e7%9a%84%e6%80%a7%e8%83%bd" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>è®ºæ–‡çš„æœ€åç»™å‡ºäº†ä¸€ç³»åˆ—æ•°å­—ã€‚ç”±äºWiscKeyçš„è¯»å†™æ”¾å¤§å¾ˆå°ï¼Œæ‰€ä»¥åœ¨value sizeæ¯”è¾ƒå¤§çš„åœºæ™¯ä¸‹ï¼ˆ&amp;gt;= 1KBï¼‰ï¼Œæ€§èƒ½è¿œä¼˜äºä¼ ç»ŸLSM-Treeã€‚åŒæ—¶ï¼Œç£ç›˜ç©ºé—´çš„ä½¿ç”¨ä¹Ÿæ›´å‹å¥½ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œè®ºæ–‡é‡Œåšmicrobenchmarkçš„æ—¶å€™ï¼Œå¯¹äºLevelDBå’ŒRocksDBï¼Œæ˜¯ä¸æ˜¯è¿˜å¼€ç€å‹ç¼©ã€‚ã€‚ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="åè®°">åè®° &lt;a href="#%e5%90%8e%e8%ae%b0" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>WiscKeyåº”è¯¥æ˜¯â€œLSM-Tree + KVåˆ†ç¦»â€æ€è·¯çš„æ¯”è¾ƒæ—©æœŸçš„è®ºæ–‡ï¼Œå…¶ä¸­ä»æœ‰å¾ˆå¤šä¸æ˜ç¡®çš„ç»†èŠ‚ã€‚ä½†æ˜¯æ•´ä½“æ€è·¯æ˜¯å¯è¡Œçš„ã€‚&lt;/p>
&lt;p>PingCAPçš„&lt;a href="https://pingcap.com/zh/blog/titan-design-and-implementation">Titan&lt;/a>æ˜¯ä¸€ä¸ªåŸºäºWiscKeyæ€æƒ³çš„RocksDB KVåˆ†ç¦»å­˜å‚¨å¼•æ“ã€‚åç»­å¯ä»¥å‚è€ƒå…¶å®ç°å†äº†è§£æ›´å¤šçš„å®ç°æ€è·¯ä¸ç»†èŠ‚ã€‚&lt;/p></description></item><item><title>Introduction to Ceph</title><link>https://wizmann.top/posts/introduction-to-ceph/</link><pubDate>Sun, 29 Nov 2020 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/introduction-to-ceph/</guid><description>&lt;h2 id="ä»€ä¹ˆæ˜¯ceph">ä»€ä¹ˆæ˜¯Ceph &lt;a href="#%e4%bb%80%e4%b9%88%e6%98%afceph" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Cephæ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„ï¼Œé«˜æ€§èƒ½çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿã€‚æä¾›äº†ä¸‰ç§ä¸åŒç±»å‹çš„æ¥å£ä»¥é€‚åº”ä¸åŒçš„åº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>block-based: å—å­˜å‚¨ï¼Œå¯ä»¥ç”¨åšVMçš„è™šæ‹Ÿç£ç›˜&lt;/li>
&lt;li>object-based: å¯¹è±¡å­˜å‚¨ï¼Œä¸Amazon S3ç­‰å¸¸ç”¨å¯¹è±¡å­˜å‚¨å…¼å®¹&lt;/li>
&lt;li>file system: POSIXå…¼å®¹çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥è¢«æœ¬åœ°ç³»ç»ŸæŒ‚è½½ï¼Œå¹¶ä¸”èƒ½è¢«å¤šä¸ªå®¢æˆ·ç«¯å…±äº«&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-11-28/2020-11-28_22-04-49.png" alt="">&lt;/p>
&lt;h3 id="cephçš„ç‰¹æ€§">Cephçš„ç‰¹æ€§ &lt;a href="#ceph%e7%9a%84%e7%89%b9%e6%80%a7" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç”±äºé‡‡ç”¨äº†CRUSHç®—æ³•ï¼ŒCephæœ‰ç€ä¼˜å¼‚çš„å¯æ‰©å±•æ€§ï¼ˆå®£ç§°å¯ä»¥æ— é™æ‰©å±•ï¼‰ã€‚å¹¶ä¸”å€ŸåŠ©å¯æ‰©å±•æ€§ï¼Œè¿›è€Œå®ç°é«˜æ€§èƒ½ã€é«˜å¯é æ€§å’Œé«˜å¯ç”¨æ€§ã€‚&lt;/p>
&lt;p>Cephæ˜¯ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„å­˜å‚¨ç³»ç»Ÿï¼Œæ— éœ€ä¸­å¿ƒèŠ‚ç‚¹è¿›è¡Œèµ„æºçš„ç®¡ç†ä¸è°ƒåº¦ï¼Œå…¨éƒ¨çš„ç®¡ç†åŠŸèƒ½ç”±å­˜å‚¨èŠ‚ç‚¹è‡ªæ²»å®Œæˆã€‚ä½¿å¾—æ•´ä¸ªç³»ç»Ÿå¯ä»¥è‡ªæˆ‘ç®¡ç†ä¸è‡ªæˆ‘æ¢å¤ï¼Œå‡å°‘è¿ç»´æˆæœ¬ä¸ç®¡ç†æˆæœ¬ã€‚&lt;/p>
&lt;h2 id="rados---cephçš„å­˜å‚¨å¼•æ“">RADOS - Cephçš„å­˜å‚¨å¼•æ“ &lt;a href="#rados---ceph%e7%9a%84%e5%ad%98%e5%82%a8%e5%bc%95%e6%93%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>RADOS=Reliable Autonomic Distributed Object Storeã€‚RADOSæ˜¯Cephåº•å±‚çš„å­˜å‚¨å¼•æ“ï¼Œæ‰€æœ‰çš„æ¥å£éƒ½å»ºç«‹åœ¨RADOSçš„åŠŸèƒ½ä¹‹ä¸Šã€‚&lt;/p>
&lt;h3 id="radosä¸­çš„å­˜å‚¨ç»“æ„">RADOSä¸­çš„å­˜å‚¨ç»“æ„ &lt;a href="#rados%e4%b8%ad%e7%9a%84%e5%ad%98%e5%82%a8%e7%bb%93%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-11-28/2020-11-28_22-24-56.png" alt="">&lt;/p>
&lt;ul>
&lt;li>å­˜å‚¨æ± ï¼ˆpoolï¼‰ï¼šé€»è¾‘å±‚ï¼Œæ¯ä¸€ä¸ªpoolé‡Œéƒ½åŒ…å«ä¸€äº›æ”¾ç½®ç»„&lt;/li>
&lt;li>æ”¾ç½®ç»„ï¼ˆplacement-group, PG)ï¼šé€»è¾‘å±‚ï¼Œä¸€ä»½æ•°æ®ä¼šåœ¨PGå½“ä¸­è¿›è¡Œç¾å¤‡å¤åˆ¶ã€‚æ¯ä¸€ä¸ªPGéƒ½å¯¹åº”ç€ä¸€ç³»åˆ—çš„å­˜å‚¨èŠ‚ç‚¹&lt;/li>
&lt;li>å­˜å‚¨èŠ‚ç‚¹ï¼ˆOSDï¼‰ï¼šç”¨ä»¥å­˜å‚¨æ•°æ®çš„ç‰©ç†èŠ‚ç‚¹ã€‚ä¸PGä¹‹é—´å½¢æˆå¤šå¯¹å¤šçš„å…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸€ä»½æ•°æ®åœ¨å†™å…¥RADOSæ—¶ï¼Œä¼šå…ˆé€‰ä¸­ä¸€ä¸ªpoolã€‚Poolä¸­å†ä½¿ç”¨ä¸€å®šçš„hashè§„åˆ™ï¼Œä¼ªéšæœºçš„é€‰ä¸­æŸä¸€ä¸ªPGã€‚PGä¼šå°†æ•°æ®å†™å…¥å¤šä¸ªOSDä¸­ã€‚è¯»å–æ•°æ®æ—¶ï¼Œä¹Ÿæ˜¯ç±»ä¼¼çš„è§„åˆ™ã€‚&lt;/p>
&lt;p>Poolæ˜¯ç”¨æˆ·å¯è§çš„ç®¡ç†æ•°æ®çš„åŸºæœ¬å•ä½ï¼Œç”¨æˆ·å¯ä»¥å¯¹Poolè¿›è¡Œä¸€ç³»åˆ—çš„é…ç½®ï¼ˆæƒé™æ§åˆ¶ã€ä½¿ç”¨SSD or HDDã€ä½¿ç”¨æ•°æ®æ‹·è´ or çº åˆ ç ï¼Œetc.ï¼‰ã€‚è€ŒPGä¸OSDå¯¹äºç”¨æˆ·æ˜¯ä¸å¯è§çš„ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-11-28/2020-11-28_23-00-51.png" alt="">&lt;/p>
&lt;h4 id="pgçš„ç»„ç»‡">PGçš„ç»„ç»‡ &lt;a href="#pg%e7%9a%84%e7%bb%84%e7%bb%87" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åœ¨ä¸€è‡´æ€§å“ˆå¸Œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨èŠ‚ç‚¹æ¥åˆ’åˆ†å“ˆå¸Œå€¼åŸŸã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœäº§ç”Ÿäº†æ•°æ®ä¸å¹³è¡¡ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°è¿›è¡Œåˆ’åˆ†å€¼åŸŸæ¥è¿›è¡Œå†å¹³è¡¡ã€‚è¿™ä¼šé€ æˆå¤§é‡çš„æ•°æ®è¿ç§»ã€‚&lt;/p>
&lt;p>CRUSHé‡‡ç”¨äº†è™šæ‹ŸèŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯PGï¼‰å°†å“ˆå¸Œå€¼åŸŸåˆ’åˆ†æˆäº†å›ºå®šçš„ç­‰é•¿åŒºåŸŸã€‚è¿™ç§æ–¹æ³•åœ¨å•æ¡æ•°æ®ä¸ç‰©ç†èŠ‚ç‚¹ä¹‹é—´åŠ å…¥äº†ä¸€ä¸ªè™šæ‹Ÿå±‚ã€‚ä¹‹åï¼Œå†ä½¿ç”¨å“ˆå¸Œå–æ¨¡çš„ç®—æ³•ç¡®å®šæ•°æ®å±äºå“ªä¸ªPGã€‚ä½¿å¾—æ•°æ®çš„è¿ç§»æ˜¯ä»¥è™šæ‹ŸèŠ‚ç‚¹ä¸ºå•ä½ï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸€æ¡æ•°æ®éƒ½é‡æ–°è®¡ç®—ã€‚Cephå®˜æ–¹çš„å»ºè®®æ˜¯ï¼Œæ¯1ä¸ªOSDå¯¹åº”ç€100ä¸ªPGã€‚&lt;/p>
&lt;p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨è§„åˆ’çš„åˆæœŸéœ€è¦ç¡®å®šPGçš„æ•°ç›®ï¼Œå¦‚æœåæœŸéœ€è¦è°ƒæ•´PGï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„æ•°æ®è¿ç§»ï¼Œç”šè‡³éœ€è¦æœåŠ¡æš‚æ—¶åœæ­¢æœåŠ¡ã€‚&lt;/p>
&lt;h3 id="ç›‘æ§å­é›†ç¾¤monä¸cluster-map">ç›‘æ§å­é›†ç¾¤ï¼ˆMONï¼‰ä¸Cluster Map &lt;a href="#%e7%9b%91%e6%8e%a7%e5%ad%90%e9%9b%86%e7%be%a4mon%e4%b8%8ecluster-map" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-11-28/2020-11-28_22-48-10.png" alt="">&lt;/p>
&lt;p>RADOSé›†ç¾¤ä¸­é™¤äº†OSDå­˜å‚¨èŠ‚ç‚¹ä¹‹å¤–ï¼Œè¿˜æœ‰ç›‘æ§å­é›†ç¾¤ï¼ˆMONï¼‰ï¼Œç”¨äºå­˜å‚¨ç³»ç»Ÿçš„æ‹“æ‰‘ç»“æ„â€”â€”Cluster Mapã€‚&lt;/p>
&lt;blockquote>
&lt;p>å…ƒæ•°ç»„ç®¡ç†ï¼ˆMDSï¼‰èŠ‚ç‚¹ç”¨äºç®¡ç†CephFSä¸­çš„æ–‡ä»¶å…ƒä¿¡æ¯ï¼Œåæ–‡ä¼šæœ‰ä»‹ç»ã€‚&lt;/p>&lt;/blockquote>
&lt;p>ä¸åŒäºä¼ ç»Ÿçš„ä¸­å¿ƒåŒ–ç®¡ç†èŠ‚ç‚¹ï¼ŒMONå¹¶ä¸ä¼šå¯¹èµ„æºè¿›è¡Œè°ƒé…ä¸è°ƒåº¦ï¼Œè€Œä»…ä»…æ˜¯ä¸€ä¸ªè§‚æµ‹è€…ï¼Œç”¨ä»¥å­˜å‚¨ç³»ç»Ÿå½“å‰çš„æ‹“æ‰‘ä¸çŠ¶æ€ã€‚&lt;/p>
&lt;p>MONä¸OSDã€OSDä¸OSDä¹‹é—´ä¼šå®šæ—¶å‘é€å¿ƒè·³åŒ…ï¼Œæ£€æµ‹OSDæ˜¯å¦å¥åº·ã€‚å¦‚æœæŸä¸ªèŠ‚ç‚¹å¤±æ•ˆï¼ŒMONä¼šæ›´æ–°å†…éƒ¨å­˜å‚¨çš„æ‹“æ‰‘ç»“æ„ä¿¡æ¯ï¼ˆClusterMapï¼‰ï¼Œå¹¶ä¸”é€šè¿‡P2Påè®®å¹¿æ’­å‡ºå»ï¼Œä»è€Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿéƒ½æœ‰ç€ï¼ˆæœ€ç»ˆï¼‰ä¸€è‡´çš„æ‹“æ‰‘ä¿¡æ¯ã€‚&lt;/p>
&lt;h3 id="ä¸»ä»åŒæ­¥ä¸èŠ‚ç‚¹è‡ªæ²»">ä¸»ä»åŒæ­¥ä¸èŠ‚ç‚¹è‡ªæ²» &lt;a href="#%e4%b8%bb%e4%bb%8e%e5%90%8c%e6%ad%a5%e4%b8%8e%e8%8a%82%e7%82%b9%e8%87%aa%e6%b2%bb" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨ä¸€ä¸ªPGä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼ˆPrimaryï¼‰å’Œä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆSecondaryï¼‰ã€‚ä¸»èŠ‚ç‚¹è´Ÿè´£ç»´æŠ¤ä»èŠ‚ç‚¹çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬æ•°æ®å¤åˆ¶ï¼ˆreplicationï¼‰ã€å¤±æ•ˆæ£€æµ‹ï¼ˆfailure detectionï¼‰å’Œå¤±æ•ˆæ¢å¤ï¼ˆfailure recoveryï¼‰ã€‚&lt;/p>
&lt;h2 id="crush---cephçš‡å† ä¸Šçš„æ˜ç ">CRUSH - Cephçš‡å† ä¸Šçš„æ˜ç  &lt;a href="#crush---ceph%e7%9a%87%e5%86%a0%e4%b8%8a%e7%9a%84%e6%98%8e%e7%8f%a0" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>CRUSHæ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„ï¼Œä¼ªéšæœºçš„æ•°æ®æ”¾ç½®ç®—æ³•ã€‚ä»¥å»ä¸­å¿ƒåŒ–æ–¹æ³•ï¼Œå°†PGæŒ‰è§„åˆ™æ˜ å°„åˆ°ç›¸åº”çš„å­˜å‚¨è®¾å¤‡ä¸Šã€‚å¹¶ä¸”ç³»ç»Ÿçš„æ‹“æ‰‘ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°½å¯èƒ½çš„å‡å°‘æ•°æ®çš„è¿ç§»ã€‚&lt;/p>
&lt;h3 id="crushçš„ä¼˜åŠ¿">CRUSHçš„ä¼˜åŠ¿ &lt;a href="#crush%e7%9a%84%e4%bc%98%e5%8a%bf" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>CRUSHå¯¹äºæ¯ä¸€ä¸ªæ•°æ®å…ƒç´ ä½¿ç”¨ä¸€ä¸ªä¼ªéšæœºç®—æ³•ï¼Œå†³å®šå…¶æ”¾ç½®çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œåªè¦æ‰€æœ‰å‚ä¸è€…éƒ½æ‹¥æœ‰ç›¸åŒçš„ç³»ç»Ÿæ‹“æ‰‘ç»“æ„ä¿¡æ¯ï¼Œé‚£ä¹ˆæ•°æ®çš„ä½ç½®å°±æ˜¯ä¸€å®šçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ‰ä¸­å¿ƒèŠ‚ç‚¹ï¼Œé‡‡ç”¨P2Pçš„æ–¹æ³•æ¥è¿›è¡Œæ•°æ®çš„å­˜å‚¨ä¸æ£€ç´¢ã€‚&lt;/p>
&lt;p>å¹¶ä¸”ï¼Œç”±äºä¼ªéšæœºç®—æ³•åªä¸å•ä¸ªPGç›¸å…³ï¼Œå¦‚æœæˆ‘ä»¬æ“ä½œå¾—å½“ï¼ŒèŠ‚ç‚¹æ•°é‡çš„å˜åŒ–å¹¶ä¸ä¼šå¼•èµ·å¤§é‡çš„æ•°æ®è¿ç§»ï¼Œè€Œæ˜¯ä¼šæ¥è¿‘ç†è®ºæœ€ä¼˜å€¼ã€‚&lt;/p>
&lt;h3 id="æ•°æ®æ”¾ç½®data-placement">æ•°æ®æ”¾ç½®ï¼ˆData Placementï¼‰ &lt;a href="#%e6%95%b0%e6%8d%ae%e6%94%be%e7%bd%aedata-placement" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>CRUSHçš„æ•°æ®æ”¾ç½®ç®—æ³•æœ‰å¾ˆå¤šä¸åŒçš„å®ç°ï¼Œè¿™é‡Œåªä»‹ç»æœ€å¸¸ç”¨çš„strawç®—æ³•ã€‚&lt;/p>
&lt;p>Cephä¸­ï¼Œæ¯ä¸€ä¸ªOSDèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼wï¼Œä»£è¡¨ç€æŸä¸ªèŠ‚ç‚¹èƒ½æ”¯æŒå¤šå°‘æ•°æ®çš„å­˜å‚¨ä¸æ£€ç´¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæƒå€¼ä¸èŠ‚ç‚¹çš„å®¹é‡æˆæ­£æ¯”ã€‚&lt;/p>
&lt;p>å‡è®¾ä¸€ä¸ªpoolé‡Œé¢æœ‰nä¸ªPGï¼Œåœ¨ä¸€æ¡æ–°çš„æ•°æ®å†™å…¥æ—¶ï¼Œæˆ‘ä»¬åˆ†åˆ«ä¼šè®¡ç®—è¿™nä¸ªPGçš„lengthå€¼ã€‚&lt;/p>
&lt;p>$$ length_{i} = f(w_{i}) * hash(x) $$&lt;/p>
&lt;p>$f(w_{i})$æ˜¯ä¸€ä¸ªåªäºå½“å‰OSDèŠ‚ç‚¹æƒå€¼æœ‰å…³çš„å‡½æ•°ã€‚$hash(x)$ä»£è¡¨å½“å‰PGçš„å“ˆå¸Œå€¼ã€‚æ‰€ä»¥ï¼ŒPGä¼šæ”¾ç½®åœ¨å“ªä¸ªOSDä¸Šï¼Œä»…ä¸å…¶æƒå€¼ç›¸å…³ã€‚&lt;/p>
&lt;p>å‡è®¾æŸä¸ªOSDèŠ‚ç‚¹å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆæ–°åŠ ã€åˆ é™¤ã€æƒå€¼å˜åŒ–ï¼‰ï¼Œåœ¨æ­¤å—å½±å“èŠ‚ç‚¹çš„æ•°æ®ä¼šè¿ç§»åˆ°å…¶å®ƒçš„OSDèŠ‚ç‚¹ã€‚å…¶å®ƒOSDèŠ‚ç‚¹çš„åŸæœ‰æ•°æ®å¹¶ä¸ä¼šå—åˆ°å½±å“ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Cephå½“ä¸­çš„strawç®—æ³•æœ‰&lt;code>straw1&lt;/code>å’Œ&lt;code>straw2&lt;/code>ã€‚&lt;code>straw1&lt;/code>çš„å®ç°é‡‡ç”¨äº†æœ‰ç¼ºé™·f(w)å‡½æ•°ï¼Œä¼šå¯¼è‡´æ„å¤–çš„æ•°æ®è¿ç§»ã€‚&lt;code>straw2&lt;/code>è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚
è¯¦æƒ…è¯·æˆ³&lt;a href="https://www.spinics.net/lists/ceph-devel/msg21635.html">è¿™é‡Œ&lt;/a>&lt;/p>&lt;/blockquote>
&lt;h4 id="ä¸»ä»æ¶æ„">ä¸»ä»æ¶æ„ &lt;a href="#%e4%b8%bb%e4%bb%8e%e6%9e%b6%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>æ¯ä¸ªPGæ‰€åŒ…å«çš„OSDéƒ½ç”±CRUSHç®—æ³•è®¡ç®—å¾—å‡ºï¼Œå¹¶æ ¹æ®é…ç½®é€‰å‡ºå‰rä¸ªOSDè¿›è¡Œä¸»ä»é…å¯¹ã€‚åˆ—è¡¨ä¸­çš„ç¬¬1ä¸ªOSDåšä¸ºä¸»èŠ‚ç‚¹ï¼ˆPrimaryï¼‰ï¼Œå…¶å®ƒçš„èŠ‚ç‚¹ä¸ºä»èŠ‚ç‚¹ï¼ˆSecondaryï¼‰ã€‚&lt;/p>
&lt;p>ä¸»ä»èŠ‚ç‚¹çš„åˆ†é…ä¸ç®¡ç†ç”±PGå†…éƒ¨è¿›è¡Œè‡ªæ²»ï¼Œä¸éœ€è¦é¢å¤–çš„å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œç®¡ç†ã€‚&lt;/p>
&lt;h2 id="cephfs">CephFS &lt;a href="#cephfs" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>CephFSæ˜¯ä¸€ä¸ªPOSIXå…¼å®¹çš„ï¼ˆå…±äº«ï¼‰æ–‡ä»¶ç³»ç»Ÿã€‚CephFSåˆ©ç”¨æ–‡ä»¶å…ƒæ•°æ®å­ç³»ç»Ÿï¼ˆMDSï¼‰æ¥ç»´æŠ¤ç›®å½•æ ‘ç»“æ„å’Œæ–‡ä»¶å’Œç›®å½•çš„å…ƒä¿¡æ¯ï¼ˆowner, timestamps, inodes, etc.)ç­‰ã€‚&lt;/p>
&lt;p>MDSå­ç³»ç»Ÿä¼šåœ¨å†…å­˜é‡Œé¢ç»´æŠ¤ä¸€ä»½Cacheï¼Œå¯¹äºéœ€è¦æŒä¹…åŒ–çš„ä¿¡æ¯ï¼Œä¼šä½¿ç”¨WALçš„æ–¹å¼å†™å…¥RADOSé‡Œä¸€ä¸ªä¸“ç”¨çš„Poolå½“ä¸­ã€‚&lt;/p>
&lt;h3 id="åŠ¨æ€æ ‘åˆ’åˆ†dynamic-tree-partitioningdtp">åŠ¨æ€æ ‘åˆ’åˆ†ï¼ˆDynamic Tree Partitioningï¼ŒDTPï¼‰ &lt;a href="#%e5%8a%a8%e6%80%81%e6%a0%91%e5%88%92%e5%88%86dynamic-tree-partitioningdtp" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>CephFSçš„æ‰©å±•æ€§çš„å…³é”®ä¹‹ä¸€ï¼Œåœ¨äºå…ƒä¿¡æ¯å­ç³»ç»Ÿçš„æ‰©å±•æ€§ã€‚CephFSå®ç°äº†åŠ¨æ€æ ‘åˆ’åˆ†çš„ç®—æ³•ï¼Œå°†ç›®å½•æ ‘ç»“æ„æ ¹æ®å½“å‰ç³»ç»Ÿçš„è´Ÿè½½ï¼Œå°†å…¶åˆ’åˆ†åˆ°ä¸åŒçš„MDSèŠ‚ç‚¹ä¸Šå»ã€‚&lt;/p>
&lt;p>ç»´æŠ¤ç›®å½•æ ‘ç»“æ„çš„ä¼˜åŠ¿åœ¨äºåˆ©ç”¨äº†æ–‡ä»¶ç³»ç»Ÿçš„å±€éƒ¨æ€§ï¼ˆlocalityï¼‰ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œé¢„å–ï¼ˆprefetchï¼‰ã€‚åŠ¨æ€çš„æ ‘åˆ’åˆ†ï¼Œå¯ä»¥ä¿è¯å…ƒä¿¡æ¯å¯ä»¥çº¿æ€§å¢é•¿ï¼Œä»¥ä¿æŒé«˜å¯æ‰©å±•æ€§ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-11-29/2020-11-29_18-53-09.png" alt="">&lt;/p>
&lt;h2 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å &lt;a href="#%e5%86%99%e5%9c%a8%e6%9c%80%e5%90%8e" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>æœ¬æ–‡åŸºäºCephçš„ä¸‰ç¯‡è®ºæ–‡ç»¼åˆè€Œæˆï¼ˆCephFSã€RADOSã€CRUSHï¼‰ã€‚å…¶ä¸­åŠ å…¥äº†ä¸€äº›è‡ªå·±çš„çœ‹æ³•ï¼Œä½¿å…¶é€»è¾‘é€šé¡ºï¼Œå¹¶ä¸ä¿è¯ä¸è®ºæ–‡çš„æ€è·¯å®Œå…¨ä¸€è‡´ã€‚&lt;/p>
&lt;p>è¿™ä¸‰ç¯‡è®ºæ–‡å¹¶æ²¡æœ‰æ˜ç¡®çš„ä¾èµ–å…³ç³»ï¼Œæ¢å¥è¯è¯´ï¼Œéœ€è¦ç»¼åˆé˜…è¯»ï¼Œæ‰èƒ½æœ‰æ¯”è¾ƒæ˜ç¡®çš„ç†è§£ã€‚&lt;/p>
&lt;p>å»ºè®®åœ¨é€šè¯»è®ºæ–‡åï¼Œå»å­¦ä¹ ä¸€ä¸‹&lt;a href="https://www.youtube.com/watch?v=PmLPbrf-x9g&amp;amp;ab_channel=Ceph">è¿™ä¸ªè§†é¢‘&lt;/a>ï¼Œä¼šå¯¹ç†è§£Cephæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚Youtubeä¸Šé¢è¿˜æœ‰å¾ˆå¤šCephçš„tech talkï¼Œå¯ä»¥ä¸€å¹¶çš„äº†è§£ä¸€ä¸‹ã€‚&lt;/p>
&lt;p>Cephç›¸å…³çš„ä¹¦ç±ä»¥å®è·µå±…å¤šï¼Œåªæ¨è&lt;a href="https://www.oreilly.com/library/view/learning-ceph-/9781787127913/">Learning Ceph&lt;/a>ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥ &lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://crossoverjie.top/2018/01/08/Consistent-Hash/">ä¸€è‡´æ€§ Hash ç®—æ³•åˆ†æ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/60963885">ä»ä¸€è‡´æ€§ hash åˆ° ceph crush&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ceph.io/publications/">Ceph Publications&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Bw-Treeï¼šåœ¨æ–°ç¡¬ä»¶å¹³å°ä¸Šçš„æ–°B-Tree</title><link>https://wizmann.top/posts/bw-tree/</link><pubDate>Mon, 18 Dec 2017 00:49:00 +0000</pubDate><guid>https://wizmann.top/posts/bw-tree/</guid><description>&lt;h2 id="ars-ä¸-bw-tree">ARS ä¸ Bw-Tree &lt;a href="#ars-%e4%b8%8e-bw-tree" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>nosqlæ•°æ®åº“ä»æœ¬è´¨ä¸Šè¯´ï¼Œéƒ½å±äºARSï¼ˆAtomic Record Storesï¼Œâ€œåŸå­è®°å½•å­˜å‚¨â€ï¼‰ã€‚&lt;/p>
&lt;p>æœ€å¸¸è§çš„â€œåŸå­è®°å½•å­˜å‚¨â€ä¸€ç§å®ç°å°±æ˜¯æœ´ç´ çš„Hashè¡¨ï¼šé€šè¿‡ä¸€ä¸ªç‰¹å®šçš„keyï¼Œæ¥è¯»å†™ä¸€æ¡ç‹¬ç«‹çš„æ•°æ®è®°å½•ã€‚&lt;/p>
&lt;p>ä¸€äº›åŸºäºkey-valueï¼ˆé”®-å€¼ï¼‰æ¨¡å‹çš„nosqlçš„å†…éƒ¨å®ç°æ­£æ˜¯ä½¿ç”¨äº†Hashè¡¨ï¼Œä¾‹å¦‚Redis&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ã€memcacheã€Riakç­‰ã€‚&lt;/p>
&lt;p>è€Œæœ‰ä¸€äº›nosqlæ•°æ®åº“ä¸ºäº†æ”¯æŒé«˜æ•ˆçš„key-sequentialï¼ˆé”®-åºåˆ—ï¼‰æŸ¥æ‰¾ï¼Œé‡‡ç”¨äº†tree-based&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>æ•°æ®ç»“æ„è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œæ‰€ä»¥B-Treeæˆä¸ºäº†ä¸€äº›æ•°æ®åº“ï¼ˆboth nosql and sqlï¼‰çš„é¦–é€‰ã€‚&lt;/p>
&lt;p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åŸºäºæ–°å‹ç¡¬ä»¶çš„é«˜æ€§èƒ½ARSå®ç°ï¼Œå…¶æ ¸å¿ƒæŠ€æœ¯æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>é¡µå¼å†…å­˜ç®¡ç†&lt;/li>
&lt;li>Bw-Treeï¼Œä¸€ç§åŸºäºB-Treeçš„æ ‘å­˜å‚¨ç»“æ„&lt;/li>
&lt;li>åŸºäºæ—¥å¿—çš„å­˜å‚¨ç®¡ç†&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-8/19953353.jpg" alt="">&lt;/p>
&lt;h2 id="åœ¨ç°ä»£ç¡¬ä»¶ä¸Šçš„bw-tree">åœ¨ç°ä»£ç¡¬ä»¶ä¸Šçš„Bw-Tree &lt;a href="#%e5%9c%a8%e7%8e%b0%e4%bb%a3%e7%a1%ac%e4%bb%b6%e4%b8%8a%e7%9a%84bw-tree" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="ç°ä»£å¤šæ ¸cpu">ç°ä»£å¤šæ ¸CPU &lt;a href="#%e7%8e%b0%e4%bb%a3%e5%a4%9a%e6%a0%b8cpu" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å¤šæ ¸CPUå¸¦æ¥äº†é«˜å¹¶å‘ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿå¼•å…¥äº†é”ç«äº‰å’Œç¼“å­˜å¤±æ•ˆé—®é¢˜ã€‚&lt;/p>
&lt;p>ä¸ºäº†è®²è§£é”ç«äº‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªç»å…¸çš„ä¾‹å­ï¼šå¤šçº¿ç¨‹è®¡æ•°å™¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¦‚æœä¸ä½¿ç”¨é”æ¥ä¿æŠ¤è®¡æ•°å™¨å˜é‡çš„è¯ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç»“æœå‡ ä¹ä¸å¯èƒ½æ˜¯æ­£ç¡®çš„ã€‚å¤šä¸ªçº¿ç¨‹ä¸­ï¼Œåªèƒ½æœ‰å”¯ä¸€ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æŒæœ‰é”ï¼Œå…¶å®ƒçš„çº¿ç¨‹éƒ½éœ€è¦ç­‰å¾…ã€‚è¿™æ ·å°±å½±å“åˆ°äº†ç¨‹åºçš„å¹¶å‘åº¦ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œä¸€äº›é«˜çº§ç©å®¶ä¼šæåˆ°CASï¼ˆcompare-and-swapï¼‰å‘½ä»¤ã€‚CASç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯â€œæ¯”è¾ƒå¹¶äº¤æ¢â€ï¼Œç”¨åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å®ç°æ•°æ®äº¤æ¢æ“ä½œã€‚è¯¦æƒ…è¯·è§ï¼š&lt;a href="https://en.wikipedia.org/wiki/Compare-and-swap">æ¯”è¾ƒå¹¶äº¤æ¢&lt;/a>&lt;/p>&lt;/blockquote>
&lt;p>ç¼“å­˜å¤±æ•ˆäº§ç”Ÿäºä¸¤ç§åœºæ™¯ã€‚ä¸€æ˜¯ä¸Šæ–‡æåˆ°çš„é”äº‰ç”¨ï¼Œå³æ¯æ¬¡é”äº‰ç”¨éƒ½ä¼šè®©å½“å‰çº¿ç¨‹é™·å…¥å†…æ ¸æ€ï¼Œäº§ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¯¼è‡´CPUç¼“å­˜çš„å¤±æ•ˆã€‚äºŒæ˜¯ç¼“å­˜ä¸€è‡´æ€§åè®®å¯¼è‡´çš„ç¼“å­˜è¡Œå¤±æ•ˆï¼Œå³å¤šä¸ªCPUåœ¨å…±äº«ä¸€ä¸ªå…±åŒçš„ä¸»å­˜èµ„æºæ—¶ï¼Œä¸ºäº†ä¿è¯ç¼“å­˜ä¸­çš„æ•°æ®ä¸€è‡´æ€§ï¼Œåœ¨ä¸»å­˜èµ„æºè¢«ä¿®æ”¹åï¼Œç›¸åº”çš„ç¼“å­˜è¡Œä¹Ÿä¼šå¤±æ•ˆã€‚&lt;/p>
&lt;p>Bw-Treeä¸ºäº†è§£å†³ä»¥ä¸Šçš„é—®é¢˜ï¼Œä½¿ç”¨äº†ä»¥ä¸‹ä¸¤ä¸ªæªæ–½ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æ— é”æ•°æ®ç»“æ„ &lt;br>
é¿å…äº†ç³»ç»Ÿé˜»å¡åœ¨é”ä¸Šï¼Œæ›´é¿å…äº†ç”±äºé”äº‰ç”¨å¯¼è‡´çš„ç¼“å­˜å¤±æ•ˆä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¢é‡æ›´æ–° &lt;br>
ä½¿ç”¨å¢é‡æ›´æ–°è€Œä¸æ˜¯åŸåœ°æ›´æ–°ï¼Œé¿å…ä¿®æ”¹å…±äº«çš„ä¸»å­˜èµ„æºï¼Œè§„é¿ç¼“å­˜ä¸€è‡´æ€§äº§ç”Ÿçš„ç¼“å­˜å¤±æ•ˆé—®é¢˜ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ç°ä»£å­˜å‚¨è®¾å¤‡">ç°ä»£å­˜å‚¨è®¾å¤‡ &lt;a href="#%e7%8e%b0%e4%bb%a3%e5%ad%98%e5%82%a8%e8%ae%be%e5%a4%87" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æ•°æ®åº“ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦ç“¶é¢ˆå°±æ˜¯IOæ€§èƒ½ã€‚SSDï¼ˆå›ºæ€ç¡¬ç›˜ï¼‰æä¾›äº†æ¯”ä¼ ç»Ÿæœºæ¢° ç¡¬ç›˜æ›´å¥½çš„è¯»å†™æ€§èƒ½ï¼Œè™½ç„¶è¡¨é¢ä¸Šç¼“è§£äº†é—®é¢˜ï¼Œä½†æ˜¯IOä»ç„¶å¯èƒ½æ˜¯æ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚&lt;/p>
&lt;p>æ‰€ä»¥ï¼ŒBw-Treeä½¿ç”¨å¤§å†…å­˜åšä¸ºè¯»ç¼“å­˜ï¼ŒåŒæ—¶é‡‡ç”¨append-onlyç»“æ„ä¿å­˜å†™ä¿¡æ¯ã€‚å› ä¸ºä¸è®ºæ˜¯SSDè¿˜æ˜¯æœºæ¢°ç¡¬ç›˜ï¼Œé¡ºåºè¯»å†™çš„æ€§èƒ½éƒ½éå¸¸å‡ºè‰²ã€‚&lt;/p>
&lt;h2 id="bw-treeçš„é¡µå¼å­˜å‚¨ç»“æ„">Bw-Treeçš„é¡µå¼å­˜å‚¨ç»“æ„ &lt;a href="#bw-tree%e7%9a%84%e9%a1%b5%e5%bc%8f%e5%ad%98%e5%82%a8%e7%bb%93%e6%9e%84" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="æ˜ å°„è¡¨mapping-table">æ˜ å°„è¡¨ï¼ˆMapping Tableï¼‰ &lt;a href="#%e6%98%a0%e5%b0%84%e8%a1%a8mapping-table" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä¸Šæ–‡ä¸­æˆ‘ä»¬æåˆ°äº†ç¼“å­˜ä¸€è‡´æ€§ï¼ˆcache coheranceï¼‰ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“æˆ‘ä»¬ä¿®æ”¹å¤šä¸ªCPUå…±äº«çš„å†…å­˜èµ„æºæ—¶ï¼Œä¼šå¯¼è‡´ç¼“å­˜çš„å¤±æ•ˆï¼Œè¿›è€Œå½±å“æŒ‡ä»¤çš„æ‰§è¡Œæ•ˆç‡ã€‚&lt;/p>
&lt;p>Bw-Treeä½¿ç”¨é¡µå¼ï¼ˆpaginatedï¼‰å­˜å‚¨ç®¡ç†ä¸æ˜ å°„è¡¨è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚Bw-Treeä»¥â€œé¡µâ€åšä¸ºå­˜å‚¨çš„å•å…ƒï¼Œæ¯ä¸€é¡µéƒ½æœ‰ä¸€ä¸ªPIDã€‚é¡µçš„ç‰©ç†ä½ç½®å¯ä»¥å­˜å‚¨åœ¨ä¸»å­˜ä¸Šï¼Œä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚&lt;/p>
&lt;p>æ˜ å°„è¡¨å°†PIDæ‰€ä»£è¡¨çš„æ˜ å°„åˆ°é¡µæ‰€åœ¨çš„å…·ä½“ç‰©ç†ä½ç½®ã€‚æ‰€ä»¥å½“é¡µçš„ç‰©ç†ä½ç½®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä»ç„¶ä¿æŒPIDä¸€è‡´ï¼Œä¸éœ€è¦å¯¹Bw-Treeçš„ç»“æ„è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚&lt;/p>
&lt;h3 id="å¢é‡ä¿®æ”¹delta-updating">å¢é‡ä¿®æ”¹ï¼ˆDelta Updatingï¼‰ &lt;a href="#%e5%a2%9e%e9%87%8f%e4%bf%ae%e6%94%b9delta-updating" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-10/18893113.jpg" alt="">&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰æ•°æ®&lt;code>D&lt;/code>ï¼Œå½“æœ‰ä¿®æ”¹è¯·æ±‚&lt;code>delta&lt;/code>åˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®&lt;code>D&lt;/code>&lt;strong>åŸåœ°&lt;/strong>ä¿®æ”¹ä¸º&lt;code>D'&lt;/code>ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å¢é‡æ›´æ–°çš„æ–¹æ³•å°†å…¶ä¿å­˜ä¸º&lt;code>delta + D&lt;/code>çš„å½¢å¼ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-18/98762144.jpg" alt="">&lt;/p>
&lt;p>å¢é‡æ›´æ–°çœ‹èµ·æ¥æ¯”åŸåœ°æ›´æ–°è€—è´¹äº†æ›´å¤šçš„å†…å­˜ï¼Œä½†å…¶ä¼˜åŠ¿ä¹Ÿéå¸¸æ˜æ˜¾ã€‚ä¸€æ˜¯ä¿®æ”¹ä¸éœ€è¦å¯¹é¡µåŠ é”ï¼Œå¯ä»¥ä½¿ç”¨CASæ— é”æ–¹æ³•å®‰å…¨çš„æ›´æ–°å…±äº«èµ„æºã€‚äºŒæ˜¯ä¸éœ€è¦ä¿®æ”¹é¡µå†…å­˜ï¼Œä¸ä¼šå¯¼è‡´ç°æœ‰cacheå¤±æ•ˆã€‚&lt;/p>
&lt;p>å½“å¢é‡è¿‡å¤šæ—¶ï¼ŒBw-Treeä¼šè‡ªåŠ¨åˆå¹¶å¢é‡å’Œé¡µå†…å­˜ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒæ ·æ˜¯æ— é”çš„ã€‚&lt;/p>
&lt;h3 id="å¼¹æ€§è™šæ‹Ÿé¡µelastic-virtual-pages">å¼¹æ€§è™šæ‹Ÿé¡µï¼ˆElastic Virtual Pagesï¼‰ &lt;a href="#%e5%bc%b9%e6%80%a7%e8%99%9a%e6%8b%9f%e9%a1%b5elastic-virtual-pages" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-10/91449803.jpg" alt="image">&lt;/p>
&lt;blockquote>
&lt;p>B+-Treeï¼Œå›¾ç‰‡æ¥æºï¼š&lt;a href="https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html">B+ Trees Visualization&lt;/a>&lt;/p>&lt;/blockquote>
&lt;p>B+-Treeçš„ç‰¹æ€§æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>æ‰€æœ‰è®°å½•éƒ½åœ¨å¶å­èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹ä¹Ÿè¢«ç§°ä¸ºé¡µï¼‰ä¸Šï¼Œå¹¶ä¸”æ˜¯é¡ºåºå­˜æ”¾çš„&lt;/li>
&lt;li>æ¯ä¸ªéå¶å­èŠ‚ç‚¹åŒ…å«å…³é”®å­—ï¼ˆreferencesï¼‰ä¸å­©å­æŒ‡é’ˆ&lt;/li>
&lt;li>å¶å­èŠ‚ç‚¹æœ‰ä¸€ä¸ªæŒ‡å‘å·¦å³å…„å¼Ÿçš„æŒ‡é’ˆï¼Œæ–¹ä¾¿é¡ºåºéå†æ•°æ®&lt;/li>
&lt;/ol>
&lt;p>Bw-Treeåœ¨B+-Treeçš„åŸºç¡€ä¸Šæ·»åŠ äº†ï¼š&lt;/p>
&lt;ol>
&lt;li>low/high keyï¼Œç”¨æ¥æ ‡æ˜æœ¬èŠ‚ç‚¹ä»¥åŠå­èŠ‚ç‚¹çš„æ•°æ®èŒƒå›´&lt;/li>
&lt;li>æ¯ä¸ªèŠ‚ç‚¹ï¼ˆåŒ…æ‹¬å¶å­èŠ‚ç‚¹å’Œä¸­é—´èŠ‚ç‚¹ï¼‰éƒ½æœ‰ä¸€ä¸ªside pointeræŒ‡å‘å…¶å³é¢çš„å…„å¼ŸèŠ‚ç‚¹&lt;/li>
&lt;/ol>
&lt;h3 id="èŒƒå›´æŸ¥è¯¢">èŒƒå›´æŸ¥è¯¢ &lt;a href="#%e8%8c%83%e5%9b%b4%e6%9f%a5%e8%af%a2" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ç”±äºBw-Treeçš„æ•°æ®éƒ½åˆ†å¸ƒåœ¨å¶å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¶å­èŠ‚ç‚¹ä¹‹é—´å¯ä»¥é€šè¿‡å…„å¼ŸæŒ‡é’ˆè¿›è¡Œéå†ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä½¿ç”¨æ¸¸æ ‡ï¼ˆcursorï¼‰æ¥æ ‡è®°å½“å‰æ£€ç´¢çš„ä½ç½®ã€‚å¹¶ä¸”ä½¿ç”¨ç¼“å­˜å½“å‰é¡µä¸Šç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚è¿™æ ·å¯ä»¥åŠ é€Ÿé€æ¡éå†æ“ä½œï¼ˆ&amp;ldquo;next-record&amp;rdquo; functionalityï¼‰ã€‚&lt;/p>
&lt;p>é€æ¡éå†æ“ä½œæ˜¯åŸå­çš„ï¼Œä½†æ˜¯é€æ¡éå†æŸä¸€æ®µæ•°æ®åˆ™ä¸æ˜¯åŸå­çš„ã€‚å¦‚æœè¯»å†™åŒæ—¶å‘ç”Ÿåœ¨åŒä¸€é¡µï¼Œåˆ™æˆ‘ä»¬ä¼šæ ¹æ®äº‹åŠ¡çš„åŒæ­¥çº§åˆ«æ¥å†³å®šæ˜¯å¦éœ€è¦é‡å»ºæ£€ç´¢ç¼“å­˜ã€‚&lt;/p>
&lt;h3 id="åƒåœ¾å›æ”¶">åƒåœ¾å›æ”¶ &lt;a href="#%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>æ— é”æ•°æ®ç»“æ„å¯¼è‡´çš„ä¸€ä¸ªç»“æœï¼Œæ˜¯æˆ‘ä»¬æ— æ³•æ˜¾å¼çš„è®©æŸä¸ªé¡µå¤±æ•ˆã€‚è¿™æ„å‘³ç€ï¼Œä¸€äº›çº¿ç¨‹ä¼šæŒæœ‰è¿‡æ—¶çš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨åˆ é™¤è¿™äº›è¿‡æ—¶çš„æ•°æ®æ—¶è¦éå¸¸å°å¿ƒã€‚&lt;/p>
&lt;p>æ‰€ä»¥è¿™é‡Œå¼•å…¥äº†â€œä»£â€ï¼ˆepochï¼‰çš„æ¦‚å¿µï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ¯ä¸€ä¸ªæ“ä½œéƒ½åœ¨æŸä¸€ä¸ªä»£ä¸­ï¼Œå¹¶ä¸”è¿™ä¸€ä»£ä¸­çš„æ‰€æœ‰æ•°æ®ä»¥åŠè¿‡æ—¶æ•°æ®éƒ½ä¸ä¼šè¢«åˆ é™¤ã€‚å½“æŸä¸€ä»£ä¸­æ‰€æœ‰çº¿ç¨‹æ“ä½œéƒ½è¢«æ‰§è¡Œå®Œæ¯•åï¼Œè¿™ä¸€ä»£å°±ä¼šç»“æŸï¼Œå…¶ä¸­çš„è¿‡æ—¶æ•°æ®å°±ä¼šè¢«å®‰å…¨çš„å›æ”¶ã€‚&lt;/p>
&lt;h2 id="bw-treeçš„ç»“æ„æ”¹å˜">Bw-Treeçš„ç»“æ„æ”¹å˜ &lt;a href="#bw-tree%e7%9a%84%e7%bb%93%e6%9e%84%e6%94%b9%e5%8f%98" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>Bw-Treeçš„ç»“æ„ä¼šåœ¨æŸäº›æ“ä½œä¸‹è¿›è¡Œæ”¹å˜ï¼Œä»¥ç»´æŠ¤å…¶æ€§è´¨ã€‚ç»“æ„æ”¹å˜çš„æ“ä½œä»ç„¶æ˜¯æ— é”çš„ã€‚&lt;/p>
&lt;p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å‡è®¾ç»“æ„æ”¹å˜çš„å†™æ“ä½œä¸æ˜¯å¹¶å‘çš„ã€‚&lt;/p>
&lt;h3 id="èŠ‚ç‚¹åˆ†è£‚">èŠ‚ç‚¹åˆ†è£‚ &lt;a href="#%e8%8a%82%e7%82%b9%e5%88%86%e8%a3%82" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>å½“æŸçº¿ç¨‹å‘ç°Bw-Treeä¸­æŸä¸ªèŠ‚ç‚¹çš„å¤§å°è¶…å‡ºäº†ç³»ç»Ÿè®¾å®šçš„é˜ˆå€¼åï¼Œåœ¨æ‰§è¡Œå®Œå…¶é¢„å®šçš„ä»»åŠ¡åï¼Œå°±ä¼šè§¦å‘èŠ‚ç‚¹çš„åˆ†è£‚æ“ä½œã€‚&lt;/p>
&lt;p>èŠ‚ç‚¹åˆ†è£‚åˆ†ä¸ºä¸¤æ­¥æ‰§è¡Œï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯åŸå­çš„ï¼š&lt;/p>
&lt;ol>
&lt;li>å­èŠ‚ç‚¹åˆ†è£‚&lt;/li>
&lt;li>å­èŠ‚ç‚¹æ›´æ–°åï¼Œå‘ä¸Šæ›´æ–°çˆ¶èŠ‚ç‚¹&lt;/li>
&lt;/ol>
&lt;h4 id="å­èŠ‚ç‚¹åˆ†è£‚">å­èŠ‚ç‚¹åˆ†è£‚ &lt;a href="#%e5%ad%90%e8%8a%82%e7%82%b9%e5%88%86%e8%a3%82" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-13/53138696.jpg" alt="">&lt;/p>
&lt;p>ä¸Šå›¾æ˜¯Bw-Treeä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç°åœ¨æˆ‘ä»¬æƒ³åˆ†è£‚&lt;code>PQ&lt;/code>èŠ‚ç‚¹ä¸º&lt;code>P&lt;/code>å’Œ&lt;code>Q&lt;/code>ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚å³å¤§äºæŸä¸ªå€¼&lt;code>KP&lt;/code>çš„æ•°æ®å…¨éƒ¨è¿ç§»åˆ°æ–°èŠ‚ç‚¹&lt;code>Q&lt;/code>ã€‚&lt;/p>
&lt;p>èŠ‚ç‚¹åˆ†è£‚çš„æ“ä½œå¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>å…ˆæ‹·è´Qä¸­çš„æ•°æ®åˆ°ä¸€ä¸ªæ–°çš„æ•°æ®é¡µ&lt;code>Q'&lt;/code>ï¼Œè¿™ä¸€æ­¥å¹¶ä¸ä¼šå½±å“åˆ°å…¶å®ƒçš„çº¿ç¨‹ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-13/52526691.jpg" alt="">&lt;/p>
&lt;ol start="2">
&lt;li>åœ¨PèŠ‚ç‚¹ï¼Œä½¿ç”¨CASæ“ä½œï¼Œæ·»åŠ åˆ†è£‚çš„ä¿¡æ¯Î”ï¼Œæ ‡æ˜è¯¥èŠ‚ç‚¹å·²ç»åˆ†è£‚ï¼Œå…¶ä¸­åŒ…å«ç€&lt;code>KP&lt;/code>çš„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“æŸ¥è¯¢çš„Keyå¤§äº&lt;code>KP&lt;/code>æ—¶ï¼Œä¼šè·³è½¬åˆ°æ–°èŠ‚ç‚¹&lt;code>Q'&lt;/code>è¿›è¡ŒæŸ¥è¯¢ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-13/7152787.jpg" alt="">&lt;/p>
&lt;h4 id="çˆ¶èŠ‚ç‚¹æ›´æ–°">çˆ¶èŠ‚ç‚¹æ›´æ–° &lt;a href="#%e7%88%b6%e8%8a%82%e7%82%b9%e6%9b%b4%e6%96%b0" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>åŒæ ·ï¼Œçˆ¶èŠ‚ç‚¹çš„æ›´æ–°ä»ç„¶æ˜¯é‡‡ç”¨å¢é‡ä¿®æ”¹çš„æ¨¡å¼ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨çˆ¶èŠ‚ç‚¹ä½¿ç”¨CASæ“ä½œæ·»åŠ ä¸€æ¡ä¿®æ”¹å¢é‡ï¼ˆindex term delta recordï¼‰ã€‚å½“æŸ¥è¯¢è¯·æ±‚è½åœ¨&lt;code>Q&lt;/code>èŠ‚ç‚¹çš„èŒƒå›´å†…æ—¶ï¼Œä¼šç›´æ¥è·³è½¬åˆ°&lt;code>Q'&lt;/code>èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-13/29669418.jpg" alt="">&lt;/p>
&lt;h4 id="æ›´æ–°åˆå¹¶">æ›´æ–°åˆå¹¶ &lt;a href="#%e6%9b%b4%e6%96%b0%e5%90%88%e5%b9%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>ä½¿ç”¨å¢é‡æ›´æ–°å¯ä»¥å‡å°‘æ•°æ®æ›´æ–°ã€èŠ‚ç‚¹åˆ†è£‚æ—¶çš„æ—¶é—´å¼€é”€ï¼Œä»è€Œé¿å…å¤±è´¥çš„åˆ†è£‚æ“ä½œï¼ˆfailed splitsï¼‰ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æœ€ç»ˆï¼Œæˆ‘ä»¬ä»ä¼šå°†äº§ç”Ÿçš„æ›´æ–°å¢é‡åˆå¹¶æˆä¸€æ¡å®Œæ•´çš„è®°å½•ï¼Œä»¥é¿å…è¿‡å¤šçš„ç©ºé—´æµªè´¹å’ŒæŒ‡é’ˆè·³è½¬ã€‚&lt;/p>
&lt;h3 id="å­èŠ‚ç‚¹åˆå¹¶">å­èŠ‚ç‚¹åˆå¹¶ &lt;a href="#%e5%ad%90%e8%8a%82%e7%82%b9%e5%90%88%e5%b9%b6" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨Bw-Treeæ•°æ®å‡å°‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†é¿å…è¿‡å¤šçš„æŒ‡é’ˆè·³è½¬ï¼Œéœ€è¦è¿›è¡ŒèŠ‚ç‚¹åˆå¹¶ã€‚èŠ‚ç‚¹åˆå¹¶æ¯”èŠ‚ç‚¹åˆ†è£‚å¤æ‚ä¸€ç‚¹ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç³»åˆ—çš„åŸå­æ“ä½œæ¥è¿›è¡Œã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-14/37353459.jpg" alt="">&lt;/p>
&lt;ol>
&lt;li>åˆ é™¤èŠ‚ç‚¹&lt;/li>
&lt;/ol>
&lt;p>åˆ é™¤èŠ‚ç‚¹æ—¶ä½¿ç”¨æ ‡è®°åˆ é™¤ï¼Œä»ç„¶æ˜¯CASæ“ä½œï¼Œæ·»åŠ ä¸€ä¸ªåˆ é™¤å¢é‡ï¼ˆremove node deltaï¼‰åˆ°&lt;code>Q&lt;/code>ã€‚ä¹‹åæ‰€æœ‰çš„è¯»å†™è¯·æ±‚å…¨éƒ¨è½¬å‘åˆ°å…¶å·¦å…„å¼Ÿ&lt;code>P&lt;/code>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œæœ‰ä¸ªçŒœæµ‹ï¼Œåœ¨Qä¸­åŸæœ‰çš„æ•°æ®ä»ç„¶æ˜¯è¦åˆ°QèŠ‚ç‚¹è¿›è¡Œè®¿é—®çš„ã€‚è®ºæ–‡é‡Œæ²¡æœ‰è¯´ï¼Œé€šè¿‡å¸¸è¯†æ¨æ–­ä¸€ä¸‹åº”è¯¥å¦‚æ­¤ã€‚&lt;/p>&lt;/blockquote>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-14/79837579.jpg" alt="">&lt;/p>
&lt;ol start="2">
&lt;li>åˆå¹¶å­èŠ‚ç‚¹&lt;/li>
&lt;/ol>
&lt;p>åœ¨&lt;code>P&lt;/code>èŠ‚ç‚¹ä¹‹å‰ç”¨CASæ“ä½œæ·»åŠ åˆå¹¶å¢é‡ï¼ˆnode merge deltaï¼‰ã€‚åˆå¹¶å¢é‡å°†&lt;code>P&lt;/code>èŠ‚ç‚¹å’Œ&lt;code>Q&lt;/code>èŠ‚ç‚¹ä»é€»è¾‘ä¸Šåˆä¸ºä¸€ä¸ªï¼Œå¹¶ä¸”è´Ÿè´£è½¬å‘è¯»å†™è¯·æ±‚ã€‚&lt;/p>
&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-14/81902381.jpg" alt="">&lt;/p>
&lt;h4 id="çˆ¶èŠ‚ç‚¹æ›´æ–°-1">çˆ¶èŠ‚ç‚¹æ›´æ–° &lt;a href="#%e7%88%b6%e8%8a%82%e7%82%b9%e6%9b%b4%e6%96%b0-1" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>è¿™ä¸ªå°±éå¸¸ç®€å•ï¼Œå°±æ˜¯CASæ“ä½œåœ¨çˆ¶èŠ‚ç‚¹æ ‡è®°åˆ é™¤&lt;code>Q&lt;/code>èŠ‚ç‚¹çš„Keyå³å¯ã€‚&lt;/p>
&lt;h3 id="åºåˆ—åŒ–ç»“æ„ä¿®æ”¹">åºåˆ—åŒ–ç»“æ„ä¿®æ”¹ &lt;a href="#%e5%ba%8f%e5%88%97%e5%8c%96%e7%bb%93%e6%9e%84%e4%bf%ae%e6%94%b9" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;p>ä¸Šé¢çš„Bw-Treeç»“æ„ä¿®æ”¹çš„å®ç°éƒ½åŸºäºä¸€ä¸ªå‡è®¾ï¼šæ•°æ®åº“çš„åŒæ­¥æœºåˆ¶ä¼šå¤„ç†å¥½æ•°æ®æ›´æ–°å†²çªé—®é¢˜ã€‚&lt;/p>
&lt;p>åŒæ­¥æœºåˆ¶åŒ…æ‹¬æ•°æ®åº“ç³»ç»Ÿçš„é”ç®¡ç†å™¨ï¼ˆlock managerï¼‰ã€äº‹åŠ¡ç®¡ç†ç»„ä»¶ï¼ˆtransactional componentï¼‰ï¼›æˆ–è€…æ˜¯é‡‡ç”¨å¼ƒç–—æ–¹æ¡ˆï¼Œå…è®¸éšæœºäº¤å‰å†™ã€‚&lt;/p>
&lt;p>ä½†æ˜¯åœ¨Bw-Treeå†…éƒ¨ï¼Œæˆ‘ä»¬éœ€è¦åºåˆ—åŒ–æ ‘çš„ç»“æ„ä¿®æ”¹ï¼ˆä¿—ç§°æ’é˜Ÿï¼‰ã€‚å½“ä¸€ä¸ªSMOæ“ä½œé‡åˆ°äº†æœªå®Œæˆçš„SMOæ“ä½œæ—¶ï¼Œå½“å‰çº¿ç¨‹ä¼šç­‰å¾…ä¹‹å‰çš„SMOæ“ä½œå®Œæˆåå†ç»§ç»­å½“å‰æ“ä½œã€‚&lt;/p>
&lt;p>è¿™æ ·çš„æ–¹æ¡ˆå¯èƒ½ä¼šå½¢æˆä¸€ä¸ªâ€œSMOæ ˆâ€ï¼Œä½†æ˜¯è¿™ç§åœºæ™¯æ¯”è¾ƒå°‘è§ï¼Œå®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ã€‚&lt;/p>
&lt;h2 id="ç¼“å­˜ç®¡ç†">ç¼“å­˜ç®¡ç† &lt;a href="#%e7%bc%93%e5%ad%98%e7%ae%a1%e7%90%86" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>ç¼“å­˜å±‚è´Ÿè´£å†…å­˜ä¸SSDç£ç›˜ä¹‹é—´çš„è¯»ã€å†™å›ä»¥åŠæ¢é¡µæ“ä½œã€‚ç¼“å­˜å±‚ä¸ºBw-Treeå±‚æä¾›äº†é€»è¾‘é¡µçš„æŠ½è±¡ã€‚&lt;/p>
&lt;p>Bw-Treeä½¿ç”¨PIDè®¿é—®é€»è¾‘é¡µï¼Œå½“é€»è¾‘é¡µä½äºç£ç›˜ä¸­æ—¶ï¼Œç¼“å­˜å±‚å…ˆæŠŠé¡µè¯»å–åˆ°å†…å­˜ä¸­ï¼Œå†ä½¿ç”¨CASæ“ä½œå°†PIDæŒ‡é’ˆä»ç£ç›˜åç§»é‡æŒ‡å‘å†…å­˜åç§»é‡ã€‚&lt;/p>
&lt;h3 id="é¢„å†™æ—¥å¿—åè®®ä¸æ—¥å¿—åºåˆ—å·lsn">é¢„å†™æ—¥å¿—åè®®ä¸æ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰ &lt;a href="#%e9%a2%84%e5%86%99%e6%97%a5%e5%bf%97%e5%8d%8f%e8%ae%ae%e4%b8%8e%e6%97%a5%e5%bf%97%e5%ba%8f%e5%88%97%e5%8f%b7lsn" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;ul>
&lt;li>æ—¥å¿—åºåˆ—å·ï¼ˆLSNï¼‰&lt;/li>
&lt;/ul>
&lt;p>æ’å…¥æˆ–ä¿®æ”¹Bw-Treeçš„å¢é‡éƒ½ä¼šè¢«æ‰“ä¸Šæ—¥å¿—åºåˆ—å·ã€‚æ—¥å¿—åºåˆ—å·ç”±äº‹åŠ¡å­ç³»ç»Ÿäº§ç”Ÿã€‚&lt;/p>
&lt;p>åœ¨é¡µçš„åˆ·å†™å¢é‡ï¼ˆflush deltaï¼‰ä¸­ï¼Œè®°å½•ç€æœ€åè¢«åˆ·å…¥ï¼ˆflushï¼‰ç£ç›˜çš„æ—¥å¿—åºåˆ—å·ã€‚&lt;/p>
&lt;ul>
&lt;li>äº‹åŠ¡æ—¥å¿—åè°ƒ&lt;/li>
&lt;/ul>
&lt;p>äº‹åŠ¡å­ç³»ç»Ÿç»´æŠ¤ç€ä¸€ä¸ªâ€œæœ€å¤§å†™å…¥æ—¥å¿—åºåˆ—å·â€ï¼ˆEnd of Stable Log, ESLï¼‰ã€‚äº‹åŠ¡å­ç³»ç»Ÿé€šè¿‡ESLæ¥é™åˆ¶æ•°æ®ç®¡ç†å­ç³»ç»Ÿçš„æŒä¹…åŒ–è¿›åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®ç®¡ç†å­ç³»ç»Ÿåªèƒ½æŒä¹…åŒ–äº‹åŠ¡å·å°äºESLçš„äº‹åŠ¡ã€‚è¿™ä¿è¯äº†é¢„å†™æ—¥å¿—åè®®çš„å› æœæ€§ã€‚&lt;/p>
&lt;p>æ•°æ®ç®¡ç†å­ç³»ç»Ÿé€šè¿‡å‘äº‹åŠ¡å­ç³»ç»Ÿåé¦ˆæœ€ååˆ·å†™çš„äº‹åŠ¡åºå·ä»¥æä¾›åé¦ˆã€‚å½“äº‹åŠ¡å­ç³»ç»Ÿæƒ³è¦å‘å‰ç§»åŠ¨â€œäº‹åŠ¡é‡åšæŒ‡é’ˆâ€ï¼ˆRedo-Scan-Start-Point, RSSPï¼‰æ—¶ï¼Œä¼šå‘äº‹åŠ¡å­ç³»ç»Ÿå‘é€è¯·æ±‚ã€‚å½“äº‹åŠ¡åºå·å¤§äºRSSPï¼Œä¸”å°äºESLçš„æ‰€ä»¥äº‹åŠ¡å…¨éƒ¨åˆ·å†™åˆ°ç£ç›˜ä¹‹åï¼Œæ•°æ®ç®¡ç†å­ç³»ç»Ÿä¼šå‘äº‹åŠ¡å­ç³»ç»Ÿå‘é€ACKä¿¡å·ã€‚æœ€åäº‹åŠ¡å­ç³»ç»Ÿå‘å‰ç§»åŠ¨RSSPï¼Œå·²ç»è½ç›˜çš„äº‹åŠ¡ä¿¡æ¯æŠ›å¼ƒã€‚&lt;/p>
&lt;ul>
&lt;li>Bw-Treeçš„ç»“æ„ä¿®æ”¹&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬å°†Bw-Treeçš„ç»“æ„ä¿®æ”¹ï¼ˆSMOï¼‰å°è£…æˆä¸ºä¸€ä¸ªç³»ç»Ÿäº‹åŠ¡ã€‚ç”±äºBw-Treeçš„ç»“æ„ä¿®æ”¹æ˜¯æ— é”çš„ï¼Œæ‰€ä»¥ä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€é¡µçš„æƒ…å†µã€‚&lt;/p>
&lt;p>å°†SMOè§†åšäº‹åŠ¡ï¼Œå…è®¸æˆ‘ä»¬å¹¶å‘çš„æ‰§è¡ŒSMOæ“ä½œï¼Œå½“ä¸”ä»…å½“æŸä¸€ä¸ªSMOæ“ä½œâ€œèƒœå‡ºâ€æ—¶ï¼Œæ‰å°†äº‹åŠ¡æäº¤ã€‚&lt;/p>
&lt;h3 id="å°†é¡µå†™å›æ—¥å¿—å¼å­˜å‚¨lss">å°†é¡µå†™å›æ—¥å¿—å¼å­˜å‚¨ï¼ˆLSSï¼‰ &lt;a href="#%e5%b0%86%e9%a1%b5%e5%86%99%e5%9b%9e%e6%97%a5%e5%bf%97%e5%bc%8f%e5%ad%98%e5%82%a8lss" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;ul>
&lt;li>é¡µå°è£…ï¼ˆPage Marshallingï¼‰&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬å¦‚æœè¦å°†é¡µå†™å›LSSï¼Œé¦–å…ˆè¦å…ˆé€»è¾‘é¡µè½¬åŒ–æˆçº¿æ€§é¡ºåºå­˜å‚¨çš„ç»“æ„ï¼Œä¾¿äºæˆ‘ä»¬å°†å…¶å­˜å‚¨åˆ°ç£ç›˜ã€‚&lt;/p>
&lt;p>ç„¶åæˆ‘ä»¬è¦å°†é¡µçš„çŠ¶æ€è®¾å®šä¸ºâ€œé”å®šâ€ï¼ˆcapturedï¼‰ï¼Œä»¥é˜²æ­¢åç»­çš„ä¿®æ”¹ç ´åé¢„å†™æ—¥å¿—åè®®ã€‚&lt;/p>
&lt;ul>
&lt;li>å¢é‡åˆ·å†™ï¼ˆIncremental Flushingï¼‰&lt;/li>
&lt;/ul>
&lt;p>å½“åˆ·å†™é¡µé¢æ—¶ï¼Œç¼“å­˜ç®¡ç†å™¨åªä¼šåˆ·å†™ESLä¹‹å‰çš„æ•°æ®è®°å½•ã€‚è¿™æ ·çš„å¥½å¤„æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>å‡å°‘ç£ç›˜çš„ä½¿ç”¨&lt;/li>
&lt;li>é¿å…äº§ç”Ÿè¿‡å¤šçš„ç£ç›˜åƒåœ¾&lt;/li>
&lt;li>é¿å…SSDçš„å†™å…¥æ”¾å¤§å¼€é”€&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>åˆ·å†™æ“ä½œ&lt;/li>
&lt;/ul>
&lt;p>ä½¿ç”¨åŒBufferè¿›è¡Œç£ç›˜åˆ·å†™ï¼Œå¯ä»¥é¿å…çº¿ç¨‹ç­‰å¾…IOæ“ä½œã€‚&lt;/p>
&lt;p>åœ¨åˆ·å†™æ“ä½œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä¼šæ›´æ–°mapping tableï¼Œå°†é¡µæŒ‡é’ˆæ”¹å˜æˆç£ç›˜çš„åç§»é‡ã€‚å¹¶å°†å†…å­˜ä¸­çš„é¡µæ¢å‡ºã€‚&lt;/p>
&lt;p>ç¼“å­˜ç®¡ç†å™¨ä¼šç›‘è§†ç³»ç»Ÿå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå†…å­˜ä¸å¤Ÿç”¨ï¼Œå°±å°†ä¸€éƒ¨åˆ†é¡µä»è‡ªåŠ¨å†…å­˜ä¸­æ¢å‡ºã€‚&lt;/p>
&lt;h2 id="æ€§èƒ½">æ€§èƒ½ &lt;a href="#%e6%80%a7%e8%83%bd" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;h3 id="æˆ‘ä»¬çš„å¯¹æ‰‹">æˆ‘ä»¬çš„å¯¹æ‰‹ &lt;a href="#%e6%88%91%e4%bb%ac%e7%9a%84%e5%af%b9%e6%89%8b" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;ul>
&lt;li>BerkeleyDB&lt;/li>
&lt;/ul>
&lt;p>æ€§èƒ½è‰¯å¥½çš„ç‹¬ç«‹å­˜å‚¨å¼•æ“ã€‚æˆ‘ä»¬ä½¿ç”¨Cè¯­è¨€å®ç°ç‰ˆæœ¬ï¼Œå†…ç½®å­˜å‚¨å¼•æ“ä¸ºB-Treeã€‚&lt;/p>
&lt;p>è¿è¡Œæ¨¡å¼ä¸ºæ€§èƒ½è¾ƒå¥½çš„â€œæ— äº‹åŠ¡æ¨¡å¼â€ï¼Œæ”¯æŒä¸€å†™å¤šè¯»ã€‚&lt;/p>
&lt;p>åœ¨æ•´ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å°†BerkeleyDBçš„ç¼“å­˜å¼€åˆ°è¶³å¤Ÿå¤§ï¼Œå…¨éƒ¨ä½¿ç”¨ä¸»å­˜è¿›è¡Œå­˜å‚¨ä¸æŸ¥è¯¢æ“ä½œã€‚&lt;/p>
&lt;ul>
&lt;li>SkipList&lt;/li>
&lt;/ul>
&lt;p>æ— é”çš„è·³è¡¨å®ç°ã€‚&lt;/p>
&lt;h3 id="æµ‹è¯•æ•°æ®é›†">æµ‹è¯•æ•°æ®é›† &lt;a href="#%e6%b5%8b%e8%af%95%e6%95%b0%e6%8d%ae%e9%9b%86" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;ul>
&lt;li>XBox Live &lt;br>
ç½‘æ¸¸æ•°æ®ã€‚Keyçš„å¹³å‡å¤§å°æ˜¯94Bytesï¼ŒValueçš„å¹³å‡å¤§å°æ˜¯1.2Kã€‚è¯»å†™æ¯”å¤§æ¦‚æ˜¯7.5: 1&lt;/li>
&lt;li>å•†ä¸šæ•°æ®åº“çš„å¤‡ä»½æµ &lt;br>
æ€»å…±æœ‰27Mæ•°æ®å—ï¼Œå»é‡åæœ‰12Mã€‚è¯»å†™æ¯”ä¸º2.2ï¼š1ï¼ŒKeyæ˜¯20Bytesçš„SHA1å“ˆå¸Œå€¼ï¼ŒValueæ˜¯44Bytesçš„å…ƒä¿¡æ¯ã€‚&lt;/li>
&lt;li>ç»¼åˆKVæ•°æ® &lt;br>
8Bytesæ•´æ•°Keyï¼Œ8Bytesæ•´æ•°Valueã€‚è¯»å†™æ¯”ä»5ï¼š1ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="æ¯”èµ›é¡¹ç›®">æ¯”èµ›é¡¹ç›® &lt;a href="#%e6%af%94%e8%b5%9b%e9%a1%b9%e7%9b%ae" class="anchor">ğŸ”—&lt;/a>&lt;/h3>&lt;h4 id="å¢é‡é“¾é•¿åº¦é˜ˆå€¼å¯¹æ€§èƒ½çš„å½±å“">å¢é‡é“¾é•¿åº¦é˜ˆå€¼å¯¹æ€§èƒ½çš„å½±å“ &lt;a href="#%e5%a2%9e%e9%87%8f%e9%93%be%e9%95%bf%e5%ba%a6%e9%98%88%e5%80%bc%e5%af%b9%e6%80%a7%e8%83%bd%e7%9a%84%e5%bd%b1%e5%93%8d" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-17/40340311.jpg" alt="">&lt;/p>
&lt;p>å¢é‡é“¾é•¿åº¦é˜ˆå€¼å½±å“è§¦å‘é¡µåˆå¹¶ï¼ˆconsolidationï¼‰çš„é¢‘ç‡ã€‚ä»å›¾ä¸­æˆ‘ä»¬åšå‡ºå¦‚ä¸‹æ¨æµ‹ï¼š&lt;/p>
&lt;ol>
&lt;li>å¢é‡é“¾é•¿åº¦è¾ƒçŸ­æ—¶ï¼Œè¯»å†™æ€§èƒ½å¥½ï¼Œä½†é¡µåˆå¹¶å¼€é”€å¤§&lt;/li>
&lt;li>å¢é‡é“¾é•¿åº¦è½¬é•¿æ—¶ï¼Œè¯»å†™å¼€é”€å¤§ï¼Œé¡µåˆå¹¶å¼€é”€å°&lt;/li>
&lt;/ol>
&lt;p>ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å°±åœ¨è¿™ä¸¤ä¸ªå› ç´ ä¸‹é¢å–ä¸€ä¸ªå¹³è¡¡ã€‚&lt;/p>
&lt;h4 id="æ— é”ç¯å¢ƒä¸‹çš„æ›´æ–°å¤±è´¥">æ— é”ç¯å¢ƒä¸‹çš„æ›´æ–°å¤±è´¥ &lt;a href="#%e6%97%a0%e9%94%81%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84%e6%9b%b4%e6%96%b0%e5%a4%b1%e8%b4%a5" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-17/63409936.jpg" alt="">&lt;/p>
&lt;p>æ•°æ®ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒBw-Treeå†™å…¥å¤±è´¥ï¼ˆFailed Updatesï¼‰æ˜¯éå¸¸å°‘çš„ã€‚ä½†æ˜¯â€œç»¼åˆâ€æ•°æ®é›†çš„â€œé¡µæ‹†åˆ†å¤±è´¥â€å’Œâ€œé¡µåˆå¹¶å¤±è´¥â€æ˜æ˜¾é«˜äºå…¶å®ƒæ•°æ®é›†ã€‚&lt;/p>
&lt;p>è¿™æ˜¯å› ä¸ºâ€œç»¼åˆâ€æ•°æ®é›†ä¸­çš„æ•°æ®éƒ½æ¯”è¾ƒå°ï¼Œæ›´æ–°èµ·æ¥æ¯”è¾ƒå¿«ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ¯”è¾ƒå¤šçš„çº¿ç¨‹ç«äº‰ã€‚&lt;/p>
&lt;h4 id="ä¸ä¼ ç»Ÿb-treeçš„æ¯”è¾ƒ">ä¸ä¼ ç»ŸB-Treeçš„æ¯”è¾ƒ &lt;a href="#%e4%b8%8e%e4%bc%a0%e7%bb%9fb-tree%e7%9a%84%e6%af%94%e8%be%83" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-17/63409936.jpg" alt="">&lt;/p>
&lt;p>Bw-Treeæ˜æ˜¾èƒœå‡ºï¼Œå…¶åŸå› æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>Bw-Treeæ˜¯æ— é”çš„ï¼Œæ‰€ä»¥å¹¶å‘ç¨‹åº¦æ›´é«˜&lt;/li>
&lt;li>Bw-Treeå¯¹CPU cacheæ›´åŠ å‹å¥½&lt;/li>
&lt;/ol>
&lt;h4 id="bw-treeä¸æ— é”è·³è¡¨æ¯”è¾ƒ">Bw-Treeä¸æ— é”è·³è¡¨æ¯”è¾ƒ &lt;a href="#bw-tree%e4%b8%8e%e6%97%a0%e9%94%81%e8%b7%b3%e8%a1%a8%e6%af%94%e8%be%83" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-17/63409936.jpg" alt="">&lt;/p>
&lt;p>Bw-Treeä»ç„¶æ˜æ˜¾èƒœå‡ºï¼Œå…¶åŸå› å½’äºBw-Treeæ›´å‹å¥½ä½¿ç”¨äº†CPU cacheã€‚&lt;/p>
&lt;h4 id="ç¼“å­˜æ€§èƒ½">ç¼“å­˜æ€§èƒ½ &lt;a href="#%e7%bc%93%e5%ad%98%e6%80%a7%e8%83%bd" class="anchor">ğŸ”—&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-12-17/63354469.jpg" alt="">&lt;/p>
&lt;p>Bw-Treeçš„ä¼˜åŠ¿æœ‰ï¼š&lt;/p>
&lt;ol>
&lt;li>ä¸è·³è¡¨ç›¸æ¯”ä¸éœ€è¦è¿‡å¤šçš„æŒ‡é’ˆè·³è½¬&lt;/li>
&lt;li>å†…å­˜ä½¿ç”¨æ›´åŠ é«˜æ•ˆ&lt;/li>
&lt;/ol>
&lt;h2 id="åç»­201026">åç»­ï¼ˆ201026ï¼‰ &lt;a href="#%e5%90%8e%e7%bb%ad201026" class="anchor">ğŸ”—&lt;/a>&lt;/h2>&lt;p>åˆ°äº†æ–°ç»„ä¹‹åï¼Œå‘ç°äº†ä¸€ä¸ªä½¿ç”¨BW-Treeçš„å­˜å‚¨å¼•æ“ã€‚ä¸è¿‡å·²ç»å³å°†åºŸå¼ƒäº†ï¼ˆæŒ¥æ‰‹&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>ç‰¹æŒ‡Redisçš„ä¸€äº›ä¸»è¦åŠŸèƒ½&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>tree-basedæ•°æ®ç»“æ„çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯å›¾ä¹¦é¦†ã€‚å›¾ä¹¦é¦†ç”¨A-Zä»£è¡¨å¤§ç±»ï¼Œç„¶åä½¿ç”¨æ•°å­—ä»£è¡¨å°ç±»ï¼Œæœ€ååŠ ä¸Šä¸€ä¸ªæ•°å­—ç¡®å®šè¿™æœ¬ä¹¦çš„ä¹¦å·ã€‚ &lt;br>
å›¾ä¹¦é¦†è—ä¹¦çš„é¡ºåºæ˜¯æŒ‰ç…§ä¹¦å·çš„é¡ºåºè¿›è¡Œæ’åºçš„ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥æ‰¾ä¸€æœ¬ä¹¦çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹å®šçš„ä¹¦å·ï¼Œåˆ©ç”¨å…¶ä¸­çš„å±‚æ¬¡ä¿¡æ¯æŸ¥æ‰¾æŸä¸€æœ¬ä¹¦ï¼Œä¹Ÿå¯ä»¥æ ¹æ®æŸä¸€ä¸ªä¹¦å·èŒƒå›´è¿›è¡ŒæŸ¥æ‰¾ä¸€ç³»åˆ—è¿ç»­çš„ä¹¦ã€‚ &lt;br>
å¦‚æœè¿˜å¼„ä¸æ˜ç™½çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨&lt;a href="http://www.ztflh.com/">ä¸­å›½å›¾ä¹¦é¦†åˆ†ç±»æ³•ç½‘ç«™&lt;/a>åŠ æ·±ä¸€ä¸‹ç†è§£ã€‚&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item></channel></rss>