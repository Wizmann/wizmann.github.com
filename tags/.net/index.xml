<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>.NET on Maerlyn's Rainbow</title><link>https://wizmann.top/tags/.net/</link><description>Recent content in .NET on Maerlyn's Rainbow</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Wed, 26 Jul 2017 00:00:00 +0000</lastBuildDate><atom:link href="https://wizmann.top/tags/.net/index.xml" rel="self" type="application/rss+xml"/><item><title>Metaprogramming in .NET è¯»ä¹¦ç¬”è®° - 1</title><link>https://wizmann.top/posts/metaprogramming-in-dotnet-1/</link><pubDate>Wed, 26 Jul 2017 00:00:00 +0000</pubDate><guid>https://wizmann.top/posts/metaprogramming-in-dotnet-1/</guid><description>&lt;h2 id="ä»€ä¹ˆæ˜¯-metaprogramming-å…ƒç¼–ç¨‹">ä»€ä¹ˆæ˜¯ Metaprogramming (å…ƒç¼–ç¨‹) &lt;a href="#%e4%bb%80%e4%b9%88%e6%98%af-metaprogramming-%e5%85%83%e7%bc%96%e7%a8%8b" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;p>&lt;img src="https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-2-15/1418894-file_1487139497158_1868c.jpg" alt="">&lt;/p>
&lt;p>å…ƒç¼–ç¨‹ä»Žå­—é¢ä¸Šç†è§£å°±æ˜¯â€œèƒ½å¤„ç†ç¨‹åºçš„ç¨‹åºâ€ã€‚&lt;/p>
&lt;p>è¿™é‡Œçš„â€œå¤„ç†â€ï¼Œæœ‰ä¸¤ä¸ªæ„æ€ã€‚&lt;/p>
&lt;p>ä¸€æ˜¯â€œç¼–å†™â€ã€â€œç”Ÿæˆâ€ï¼Œæœ€ç»å…¸ä¾‹å­å°±æ˜¯ç¼–è¯‘å™¨ï¼Œå®ƒå°†æˆ‘ä»¬çš„æ‰€ç¼–å†™çš„é«˜çº§è¯­è¨€ç¿»è¯‘æˆæœºå™¨ä»£ç ã€‚ç¼–è¯‘å™¨å°±åƒå»ºç­‘å·¥äººï¼Œå°†â€œè“å›¾â€ï¼ˆé«˜çº§è¯­è¨€ï¼‰è½¬åŒ–æˆâ€œé«˜æ¥¼å¤§åŽ¦â€ï¼ˆæœºå™¨è¯­è¨€ï¼‰ã€‚è¿˜æœ‰ä¸€ä¸ªæˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„å°±æ˜¯â€œå®â€(Macro)ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨é¢„å…ˆç¼–å†™å¥½çš„å®ï¼Œåœ¨ç¼–è¯‘æœŸï¼Œå®ä¼šè¢«è‡ªåŠ¨å±•å¼€æˆç›¸åº”çš„ä»£ç ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ç”¨æœºå™¨å¸¦æ›¿äººç±»åŠ³åŠ¨ã€‚&lt;/p>
&lt;p>â€œå¤„ç†â€çš„å¦å¤–ä¸€ä¸ªæ„æ€å°±æ˜¯â€œå¤„ç†è‡ªå·±â€ï¼Œå…ƒç¼–ç¨‹è®©ç¨‹åºåœ¨è¿è¡Œæ—¶äº†è§£è‡ªå·±çš„çŠ¶æ€ï¼Œå¹¶åŠ¨æ€çš„æ‰©å±•å¹¶æ‰§è¡Œçš„ç›¸åº”é€»è¾‘ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œæœ€é«˜çº§çš„â€œå¤„ç†â€å°±æ˜¯èƒ½å®Œå…¨ä»£æ›¿äººè„‘çš„äººå·¥æ™ºèƒ½ã€‚å¦‚æžœé‚£ä¸€å¤©åˆ°æ¥ï¼Œæˆ‘ä»¬å°±è·ç¦»ç”Ÿæ´»åœ¨Matrixé‡Œä¸è¿œäº†ã€‚&lt;/p>
&lt;h2 id="å…ƒç¼–ç¨‹çš„å®žçŽ°">å…ƒç¼–ç¨‹çš„å®žçŽ° &lt;a href="#%e5%85%83%e7%bc%96%e7%a8%8b%e7%9a%84%e5%ae%9e%e7%8e%b0" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;p>å…ƒç¼–ç¨‹ä¸»è¦å®žçŽ°åœ¨ç¼–è¯‘æœŸå‰åŽä»¥åŠè¿è¡Œæ—¶ã€‚&lt;/p>
&lt;p>å…ƒç¼–ç¨‹ä¸»è¦ä¾èµ–äºŽä»¥ä¸‹æŠ€æœ¯ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»£ç ç”Ÿæˆ(code generation)&lt;/li>
&lt;li>åå°„(reflection)&lt;/li>
&lt;li>æ±‡ç¼–é‡å†™(assembly rewriting)&lt;/li>
&lt;li>è¡¨è¾¾å¼(expression)&lt;/li>
&lt;li>ä»£ç åˆ†æž(code analysis)&lt;/li>
&lt;/ul>
&lt;h2 id="ä»£ç ç”Ÿæˆcode-generation">ä»£ç ç”Ÿæˆ(code generation) &lt;a href="#%e4%bb%a3%e7%a0%81%e7%94%9f%e6%88%90code-generation" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;blockquote>
&lt;p>â€œæ‹³æœ‰å®šåŠ¿ï¼Œè€Œç”¨æ—¶åˆ™æ— å®šåŠ¿ã€‚ç„¶å½“å…¶ç”¨ä¹Ÿï¼Œå˜æ— å®šåŠ¿ï¼Œè€Œå®žä¸å¤±åŠ¿â€&lt;/p>&lt;/blockquote>
&lt;p>è™½ç„¶å†™ä»£ç æ˜¯ä¸€é¡¹åˆ›é€ æ€§å·¥ä½œï¼Œä½†æ˜¯è¿™ä¸æ„å‘³ç€å¯¹äºŽæ¯ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½è¦ä»Žé›¶å¼€å§‹ã€‚åœ¨è½¯ä»¶å·¥ç¨‹çš„å‘å±•è¿‡ç¨‹ä¸­ï¼Œå‰äººå·²ç»ä¸ºæˆ‘ä»¬æ€»ç»“äº†ä¸€äº›å¸¸ç”¨çš„â€œæœ€ä½³å®žè·µâ€(best practise)ã€‚åœ¨æˆ‘ä»¬çš„å¼€å‘å·¥ç¨‹ä¸­ï¼Œçµæ´»æ°å½“çš„åº”ç”¨è¿™äº›â€œå®šåŠ¿â€ï¼Œä¼šå¤§å¤§ç®€åŒ–æˆ‘ä»¬çš„å·¥ä½œï¼Œé™ä½ŽäººåŠ›æˆæœ¬ã€‚&lt;/p>
&lt;p>â€œå®šåŠ¿â€æ„å‘³ç€â€œé‡å¤â€ã€‚è€Œé‡å¤å·¥ä½œå¾€å¾€æ˜¯å¤æ‚è€Œæ˜“å‡ºé”™çš„ï¼Œæ‰€ä»¥æœ‰äººæå‡ºäº†DRYåŽŸåˆ™ï¼šDon&amp;rsquo;t Repeat Yourselfã€‚ä»£ç ç”Ÿæˆå·¥å…·åˆ™æ˜¯è¿™ä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>å¯¹äºŽçµæ´»å¤šå˜è€Œåˆéµä»Žå®šåŠ¿çš„ä»£ç ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆå¯ä»¥æé«˜å¼€å‘é€Ÿåº¦ï¼Œé™ä½Žå­¦ä¹ æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ï¼Œä½¿ä»£ç ç»´æŠ¤åŒä¸€ç§æŠ½è±¡æ–¹æ³•ï¼Œéµä»Žé¢„å…ˆç¡®å®šçš„æ¨¡å¼ï¼Œä¹Ÿæ›´æ–¹ä¾¿ç®¡ç†ã€‚&lt;/p>
&lt;h3 id="ä¸¾ä¸€ä¸ªä¾‹å­">ä¸¾ä¸€ä¸ªä¾‹å­ &lt;a href="#%e4%b8%be%e4%b8%80%e4%b8%aa%e4%be%8b%e5%ad%90" class="anchor">ðŸ”—&lt;/a>&lt;/h3>&lt;p>åœ¨C++é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®žçŽ°ä¸€ä¸ª&lt;code>max(a, b)&lt;/code>å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define max(a, b) ((a) &amp;gt; (b)? (a): (b))
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ç„¶ï¼Œæœ‰ç»éªŒçš„è€å¸æœºéƒ½çŸ¥é“è¿™æ ·å†™çš„é—®é¢˜ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¢ä¸€ç§æ–¹æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> T&lt;span style="color:#f92672">&amp;amp;&lt;/span> max(&lt;span style="color:#66d9ef">const&lt;/span> T&lt;span style="color:#f92672">&amp;amp;&lt;/span> a, &lt;span style="color:#66d9ef">const&lt;/span> T&lt;span style="color:#f92672">&amp;amp;&lt;/span> b) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> a &lt;span style="color:#f92672">&amp;gt;&lt;/span> b&lt;span style="color:#f92672">?&lt;/span> a: b;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™çœ‹èµ·æ¥ä¸é”™ï¼Œä½†æ˜¯åœ¨C#é‡Œï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½è¿™ä¹ˆåšã€‚&lt;/p>
&lt;p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¼ºè¡Œå¥—ç”¨C++çš„è¯­æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> T MyMax&amp;lt;T&amp;gt;(T a, T b)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> a &amp;gt; b ? a : b;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·çš„ä»£ç ä¼šæŠ¥ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç±»åž‹éƒ½æ”¯æŒ&lt;code>&amp;gt;&lt;/code>æ¯”è¾ƒæ“ä½œã€‚è¿›ä¸€æ­¥è¯´ï¼ŒC++çš„templateå±•å¼€æ˜¯ç¼–è¯‘æ—¶è¿›è¡Œçš„ï¼Œæ ¹æ®ä¸åŒçš„æ¨¡æ¿å‚æ•°ç”Ÿæˆä¸åŒç‰ˆæœ¬çš„ä»£ç ï¼Œè¿è¡Œæ—¶çš„é€»è¾‘æ˜¯ç¡®å®šçš„ã€‚è€ŒC#çš„æ³›åž‹åœ¨è¿è¡Œæ—¶ä»æ˜¯â€œæ³›åž‹â€çš„ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘æ—¶ï¼ŒC#ç¼–è¯‘å™¨éœ€è¦çŸ¥é“æ›´å¤šçš„ä¿¡æ¯æ¥ä¿è¯è¿è¡Œæ—¶çš„ç±»åž‹å®‰å…¨(type-safe)ã€‚&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬è¦ç»™&lt;code>&amp;lt;T&amp;gt;&lt;/code>åŠ ä¸€ä¸ªé™åˆ¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒC#ä¸­å¯ä»¥ç»§æ‰¿&lt;code>IComparable&amp;lt;T&amp;gt;&lt;/code>æŽ¥å£æ¥å®žçŽ°&amp;quot;æ¯”è¾ƒ&amp;quot;(compare)æ“ä½œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> T MyMax&amp;lt;T&amp;gt;(T a, T b) &lt;span style="color:#66d9ef">where&lt;/span> T: IComparable&amp;lt;T&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> a.CompareTo(b) &amp;gt; &lt;span style="color:#ae81ff">0&lt;/span> ? a : b;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·ä¼¼ä¹Žè§£å†³äº†é—®é¢˜ï¼Œå¯¹äºŽå®žçŽ°äº†&lt;code>IComparable&amp;lt;T&amp;gt;&lt;/code>æŽ¥å£çš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code>MyMax&amp;lt;T&amp;gt;&lt;/code>æ¥å–ä¸¤ä¸ªå…ƒç´ çš„æœ€å¤§å€¼ã€‚ä½†æ˜¯ï¼Œå¯¹äºŽåªå®žçŽ°äº†&lt;code>IComparable&lt;/code>çš„ç±»ï¼Œæˆ‘ä»¬ä»ä¸èƒ½ä½¿ç”¨&lt;code>MyMax&amp;lt;T&amp;gt;&lt;/code>å‡½æ•°ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥å®žçŽ°ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„&lt;code>MyMax&amp;lt;T&amp;gt;&lt;/code>å‡½æ•°ï¼Œæ¥åŒ¹é…&lt;code>IComparable&lt;/code>å’Œ&lt;code>IComparable&amp;lt;T&amp;gt;&lt;/code>ä¸¤ä¸ªä¸åŒçš„æŽ¥å£ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•é¢„çŸ¥ä¸€åˆ‡ï¼Œå‡å¦‚ä¸Šæ¸¸å›¢é˜Ÿä½¿ç”¨äº†ä¸€ä¸ªç§æœ‰çš„æ¯”è¾ƒæŽ¥å£ï¼Œæˆ–è€…ç›´æŽ¥ç¡¬ç¼–ç äº†&lt;code>CompareTo(other)&lt;/code>å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€Žä¹ˆåŠžå‘¢ï¼Ÿ&lt;/p>
&lt;h3 id="ä»£ç ç”Ÿæˆçš„ä¼˜ç‚¹">ä»£ç ç”Ÿæˆçš„ä¼˜ç‚¹ &lt;a href="#%e4%bb%a3%e7%a0%81%e7%94%9f%e6%88%90%e7%9a%84%e4%bc%98%e7%82%b9" class="anchor">ðŸ”—&lt;/a>&lt;/h3>&lt;p>åˆ©ç”¨ä»£ç ç”Ÿæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥çªç ´ç¼–ç¨‹è¯­è¨€å¯¹æˆ‘ä»¬çš„é™åˆ¶ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç©·ä¸¾å¯èƒ½è¢«æ¯”è¾ƒçš„ç±»åž‹ï¼Œç”Ÿæˆç›¸åº”çš„å‡½æ•°é‡è½½ï¼Œå®žçŽ°ç›¸åº”çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯­è¨€çš„ä¸€äº›åŠ¨æ€ç‰¹æ€§æ¥ç»•è¿‡é™åˆ¶ï¼Œä½†æ˜¯åŠ¨æ€ç‰¹æ€§å¸¦æ¥çš„æ€§èƒ½æŸå¤±æ˜¯ä¸å¯å¿½ç•¥çš„ã€‚&lt;/p>
&lt;p>åŒæ—¶ï¼Œä»£ç ç”Ÿæˆå¯ä»¥è½»æ¾çš„ç”Ÿæˆå¤§æ®µçš„é‡å¤æ€§é€»è¾‘ä»£ç ï¼Œæ¯”å¦‚æ•°æ®è¡¨æŸ¥è¯¢ï¼Œä¸šåŠ¡æµç¨‹ç­‰ã€‚è¿™æ˜¯ä»£ç ç”Ÿæˆçš„ä¸å¯æ›¿ä»£çš„ç‰¹é•¿ã€‚&lt;/p>
&lt;h3 id="t4æ¨¡æ¿å¼•æ“Ž">T4æ¨¡æ¿å¼•æ“Ž &lt;a href="#t4%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e" class="anchor">ðŸ”—&lt;/a>&lt;/h3>&lt;p>T4çš„å…¨ç§°æ˜¯â€œText Template Transformation Toolkitâ€ã€‚æ˜¯å¾®è½¯å‡ºå“çš„åŸºäºŽæ¨¡æ¿çš„æ–‡æœ¬ç”Ÿæˆæ¡†æž¶ï¼Œæœ€æ—©åœ¨VS2008ä¸­è¢«å¼•å…¥ã€‚&lt;/p>
&lt;p>T4å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥è¿›è¡Œç¼–ç ï¼ŒåŒ…æ‹¬C#, VB, F#ç­‰ï¼Œç›®æ ‡æ ¼å¼æ²¡æœ‰é™åˆ¶ã€‚&lt;/p>
&lt;p>å¯¹äºŽæ¨¡æ¿å¼•æ“Žï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šå±•å¼€ã€‚å¦å¤–ï¼Œæˆ‘æœ€å–œæ¬¢çš„å¼•æ“Žæ˜¯Jinja2ã€‚ï¼ˆ&lt;/p>
&lt;h3 id="codedom">CodeDOM &lt;a href="#codedom" class="anchor">ðŸ”—&lt;/a>&lt;/h3>&lt;p>é€šå¸¸æ„ä¹‰ä¸Šçš„DOMæ˜¯ç”¨æ¥æè¿°æµè§ˆå™¨ä¸­å±•ç¤ºçš„å…ƒç´ ã€‚CodeDOMå’ŒDOMå®šä¹‰ç±»ä¼¼ï¼Œæ˜¯ç”¨æ¥æè¿°ä»£ç ä¸­çš„ç»“æž„çš„ã€‚&lt;/p>
&lt;p>CodeDOMæ¯”ä¸€èˆ¬çš„æ¨¡æ¿å¼•æ“Žè¦æ›´ä¸¥è°¨ï¼ŒåŒæ—¶æ˜¯è¯­è¨€æ— å…³çš„ï¼Œå³æ”¯æŒå°†ä¸€ä»½CodeDOMç”Ÿæˆä¸ºä¸åŒçš„è¯­è¨€ã€‚åŒæ—¶ï¼Œè¿˜æ”¯æŒåœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ç”Ÿæˆä»£ç ã€‚&lt;/p>
&lt;p>CodeDOMçš„åº”ç”¨å¾ˆå¹¿æ³›ï¼Œä¾‹å¦‚.NETä¸­çš„è¡¨è¾¾å¼æ ‘(expression treeï¼ŒåŽä¼šä¸­ä¼šæåˆ°)ï¼Œä»¥åŠå‰æ–‡ä¸­æåˆ°çš„T4ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.CodeDom;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.CodeDom.Compiler;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.Collections.Generic;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.IO;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.Linq;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.Text;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> System.Threading.Tasks;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> Microsoft.CSharp;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> Microsoft.VisualBasic;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> ConsoleApplication5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Program&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Main(&lt;span style="color:#66d9ef">string&lt;/span>[] args)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeCompileUnit lUnit = &lt;span style="color:#66d9ef">new&lt;/span> CodeCompileUnit();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeNamespace lNamespace = &lt;span style="color:#66d9ef">new&lt;/span> CodeNamespace(&lt;span style="color:#e6db74">&amp;#34;MyNamespace&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lNamespace.Imports.Add(&lt;span style="color:#66d9ef">new&lt;/span> CodeNamespaceImport(&lt;span style="color:#e6db74">&amp;#34;System&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lNamespace.Imports.Add(&lt;span style="color:#66d9ef">new&lt;/span> CodeNamespaceImport(&lt;span style="color:#e6db74">&amp;#34;System.IO&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lUnit.Namespaces.Add(lNamespace);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeTypeDeclaration lClass = &lt;span style="color:#66d9ef">new&lt;/span> CodeTypeDeclaration(&lt;span style="color:#e6db74">&amp;#34;MyClass&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeMethodInvokeExpression lExpression = &lt;span style="color:#66d9ef">new&lt;/span> CodeMethodInvokeExpression(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">new&lt;/span> CodeTypeReferenceExpression(&lt;span style="color:#e6db74">&amp;#34;Console&amp;#34;&lt;/span>), &lt;span style="color:#e6db74">&amp;#34;WriteLine&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">new&lt;/span> CodePrimitiveExpression(&lt;span style="color:#e6db74">&amp;#34;hello world !&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lNamespace.Types.Add(lClass);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeEntryPointMethod lMain = &lt;span style="color:#66d9ef">new&lt;/span> CodeEntryPointMethod();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lMain.Statements.Add(lExpression);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lClass.Members.Add(lMain);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">string&lt;/span> lDesktopPath = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory) + &lt;span style="color:#e6db74">@&amp;#34;\&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CodeGeneratorOptions lOptions = &lt;span style="color:#66d9ef">new&lt;/span> CodeGeneratorOptions();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lOptions.IndentString = &lt;span style="color:#e6db74">&amp;#34; &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lOptions.BlankLinesBetweenMembers = &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// generate a C# source code file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CSharpCodeProvider lCSharpCodeProvider = &lt;span style="color:#66d9ef">new&lt;/span> CSharpCodeProvider();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> (StreamWriter lStreamWriter = &lt;span style="color:#66d9ef">new&lt;/span> StreamWriter(lDesktopPath + &lt;span style="color:#e6db74">&amp;#34;HelloWorld.cs&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">false&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lCSharpCodeProvider.GenerateCodeFromCompileUnit(lUnit, lStreamWriter, lOptions);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// generate a VB source code file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> VBCodeProvider lVBCodeProvider = &lt;span style="color:#66d9ef">new&lt;/span> VBCodeProvider();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> (StreamWriter lStreamWriter = &lt;span style="color:#66d9ef">new&lt;/span> StreamWriter(lDesktopPath + &lt;span style="color:#e6db74">&amp;#34;HelloWorld.vb&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">false&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lVBCodeProvider.GenerateCodeFromCompileUnit(lUnit, lStreamWriter, lOptions);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”Ÿæˆçš„C#ä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> MyNamespace {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> System;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> System.IO;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">MyClass&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Main() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Console.WriteLine(&lt;span style="color:#e6db74">&amp;#34;hello world !&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”Ÿæˆçš„VBä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vb" data-lang="vb">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">Option Strict Off&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">Option Explicit On&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">Imports&lt;/span> System
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">Imports&lt;/span> System.IO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">Namespace&lt;/span> MyNamespace
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">Public&lt;/span> &lt;span style="color:#66d9ef">Class&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">[&lt;/span>&lt;span style="color:#a6e22e">MyClass&lt;/span>&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">Public&lt;/span> &lt;span style="color:#66d9ef">Shared&lt;/span> &lt;span style="color:#66d9ef">Sub&lt;/span> &lt;span style="color:#a6e22e">Main&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Console.WriteLine(&lt;span style="color:#e6db74">&amp;#34;hello world !&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">End&lt;/span> &lt;span style="color:#66d9ef">Sub&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">End&lt;/span> &lt;span style="color:#66d9ef">Class&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">End&lt;/span> &lt;span style="color:#66d9ef">Namespace&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä¸Žæ¨¡æ¿å¼•æ“Žç›¸æ¯”ï¼ŒCodeDOMæ›´å¤æ‚ï¼Œä¹Ÿæ›´ä¸ç›´è§‚ã€‚ä½†æ˜¯ç”±äºŽå®ƒçš„è¯­è¨€æ— å…³æ€§ï¼Œéžå¸¸é€‚åˆç”¨æ¥ç”Ÿæˆä¸€äº›å·¥å…·ä»£ç ï¼Œæ¯”å¦‚SDKç­‰ã€‚&lt;/p>
&lt;h2 id="whats-next">What&amp;rsquo;s next? &lt;a href="#whats-next" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;p>ç”±äºŽ.NETå…ƒç¼–ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„è¯é¢˜ï¼Œæ‰€ä»¥è¯»ä¹¦ç¬”è®°å†™ä¼šåšæˆä¸€ä¸ªå°ç³»åˆ—ä¸€ç¯‡ä¸€ç¯‡å‘å‡ºã€‚&lt;/p>
&lt;p>ä¸‹ä¸€ç¯‡æˆ‘ä»¬ä¼šæ›´è¿›æ­¥ï¼Œè®¨è®ºILçº§åˆ«çš„ä»£ç ç”Ÿæˆã€‚&lt;/p>
&lt;h2 id="ä¸€äº›æµ‹è¯•ä»£ç ">ä¸€äº›æµ‹è¯•ä»£ç  &lt;a href="#%e4%b8%80%e4%ba%9b%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="http://code.wizmann.tk/Home/Code?guid=81cb583a-2498-4f2a-8eff-b17a1af9b5e5">&lt;code>max(a, b)&lt;/code> function with template in C++&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://code.wizmann.tk/Home/Code?guid=1a30e464-c08c-45bd-b9ca-da2675de19df">Generate code with CodeDOM&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒé“¾æŽ¥">å‚è€ƒé“¾æŽ¥ &lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="anchor">ðŸ”—&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://blogs.msdn.microsoft.com/csharpfaq/2004/03/12/how-do-c-generics-compare-to-c-templates/">How do C# generics compare to C++ templates?&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.pl-enthusiast.net/2014/08/05/type-safety/">What is type safety?&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://csharphardcoreprogramming.wordpress.com/tag/codedom/">Reflection (part 5, professional), CodeDOM (&amp;amp; lambda expression tree)&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>