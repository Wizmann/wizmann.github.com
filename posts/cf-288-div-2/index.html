<!doctype html><html lang=zh-cn dir=auto><head><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}}</script><script defer src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wizmann.top/ accesskey=h title="Maerlyn's Rainbow (Alt + H)">Maerlyn's Rainbow</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Codeforces Round #288 (Div. 2)</h1><div class=post-meta><span title='2015-02-16 21:16:30 +0000 UTC'>February 16, 2015</span>&nbsp;Â·&nbsp;wizmann</div></header><div class=post-content><h2 id=a-pasha-and-pixels>A. Pasha and Pixels<a hidden class=anchor aria-hidden=true href=#a-pasha-and-pixels>#</a></h2><p>Brute force.</p><p>There are multiple ways to form a 2*2 square at one single step.</p><p><img alt="Alt text" loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/6fb53c51539b47559cf0d122a832cf63></p><p>So at every step, we have to check the neighbours of pixel that is colored black.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdio&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdlib&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstring&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define print(x) cout &lt;&lt; x &lt;&lt; endl
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define input(x) cin &gt;&gt; x
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>123</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> mx[] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> my[] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> MOVE <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> mp[SIZE][SIZE];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> n, m, k;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>isBlackBlock</span>(<span style=color:#66d9ef>int</span> y, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> cnt <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> MOVE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> ny <span style=color:#f92672>=</span> y <span style=color:#f92672>+</span> my[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> nx <span style=color:#f92672>=</span> x <span style=color:#f92672>+</span> mx[i];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (ny <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> ny <span style=color:#f92672>&lt;</span> n
</span></span><span style=display:flex><span>                <span style=color:#f92672>&amp;&amp;</span> nx <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> nx <span style=color:#f92672>&lt;</span> m
</span></span><span style=display:flex><span>                <span style=color:#f92672>&amp;&amp;</span> mp[ny][nx]) {
</span></span><span style=display:flex><span>            cnt<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cnt <span style=color:#f92672>==</span> MOVE;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> y, x;
</span></span><span style=display:flex><span>    input(n <span style=color:#f92672>&gt;&gt;</span> m <span style=color:#f92672>&gt;&gt;</span> k);
</span></span><span style=display:flex><span>    memset(mp, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>sizeof</span>(mp));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> ans <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> k; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        input(y <span style=color:#f92672>&gt;&gt;</span> x);
</span></span><span style=display:flex><span>        x<span style=color:#f92672>--</span>; y<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>        mp[y][x] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>bool</span> flag <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> MOVE; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            flag <span style=color:#f92672>|=</span> isBlackBlock(y <span style=color:#f92672>-</span> my[j], x <span style=color:#f92672>-</span> mx[j]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (flag) {
</span></span><span style=display:flex><span>            ans <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    print(ans);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=b-anton-and-currency-you-all-know>B. Anton and currency you all know<a hidden class=anchor aria-hidden=true href=#b-anton-and-currency-you-all-know>#</a></h2><p>At first, you have to understand the questions accurately.</p><p>The exchange rate is <strong>an odd number</strong>. And your mission is swap one digit with another, to make it the maximum even number.</p><p>Because if the exchange rate is an even number, it will lead to a more sophisticated problem.</p><p>The intuitive thought is that we can swap the hightest even digit with the last digit. However, for this case &ldquo;92291&rdquo;, you may swap the second digit &ldquo;2&rdquo; and the last digit &ldquo;1&rdquo;. But &ldquo;91292&rdquo; is not the largest number, &ldquo;92192&rdquo; is.</p><p>So, ther are two scenario. First is the final answer is greater than the ordinary one. Just find out the <strong>first even digit that is less than the last digit</strong>. Second is the final answer is less than the given one. If we want to make it the largest one, we have to find the <strong>lowest even digit and then swap</strong>.</p><p>We can make it by loop twice. But there is a way to find the final answer in one single iteration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdio&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdlib&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstring&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define print(x) cout &lt;&lt; x &lt;&lt; endl
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define input(x) cin &gt;&gt; x
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>123456</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> number[SIZE];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    scanf(<span style=color:#e6db74>&#34;%s&#34;</span>, number);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> len <span style=color:#f92672>=</span> strlen(number);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> p <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, q <span style=color:#f92672>=</span> number[len <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> len <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> u <span style=color:#f92672>=</span> number[i] <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (u <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (p <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> q <span style=color:#f92672>&gt;</span> u) {
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (p <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        print(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        swap(number[p], number[len <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        print(number);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=c-anya-and-ghosts>C. Anya and Ghosts<a hidden class=anchor aria-hidden=true href=#c-anya-and-ghosts>#</a></h2><p>The background of this problem is quite twisted.</p><p>First of all, we have to find out in which scenario there is no way to defence against the ghost.</p><p><img alt="Alt text" loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/833368d068c6dc956b62d9babf01c3b6></p><p>It&rsquo;s easy to find out in that diagram above that if the duration of the candle is less than the number of candles which is needed.</p><p>So, before the ghost comes, we have to light up the candles. If we want to have K candles in one second, we have to light it up at second (T - 1) (T - 2) &mldr; (T - K).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(m, t, r) <span style=color:#f92672>=</span> map(int, raw_input()<span style=color:#f92672>.</span>split())
</span></span><span style=display:flex><span>ghosts <span style=color:#f92672>=</span> map(int, raw_input()<span style=color:#f92672>.</span>split())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># impossible</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> t <span style=color:#f92672>&lt;</span> r:
</span></span><span style=display:flex><span>    print <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>candles <span style=color:#f92672>=</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(r)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ghost <span style=color:#f92672>in</span> ghosts:
</span></span><span style=display:flex><span>    delay <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(r):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> candles[i] <span style=color:#f92672>&lt;</span> ghost:
</span></span><span style=display:flex><span>            candles[i] <span style=color:#f92672>=</span> ghost <span style=color:#f92672>+</span> t <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> delay
</span></span><span style=display:flex><span>            delay <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            ans <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print ans
</span></span></code></pre></div><h2 id=d-tanya-and-password>D. Tanya and Password<a hidden class=anchor aria-hidden=true href=#d-tanya-and-password>#</a></h2><p>Tanya cut the password into three-letter continuous substrings. Our mission is to re-assemble these substrings.</p><p>For example,</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 248 41"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="20" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="20" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="16" y="20" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="24" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="32" y="20" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="40" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="20" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="56" y="20" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="20" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="72" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="80" y="20" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="104" y="20" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="112" y="20" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="120" y="20" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="136" y="20" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="144" y="20" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="152" y="20" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="176" y="20" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="184" y="20" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="200" y="20" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="216" y="20" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="232" y="20" fill="currentcolor" style="font-size:1em">e</text></g></svg></div><p>It&rsquo;s not hard to find out that the problem is not about the &ldquo;string&rdquo; but the &ldquo;graph&rdquo;. But how to convert the string and substrings into a graph.</p><p>At the every beginning, we regard the substrings as vertexes, every two substrings which could be connected has an edge between them.</p><p><img alt="Alt text" loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/bbc690924ece17dde46fd5d23188bf5d></p><p>In this scenario, all we have to do is find a path that visit all the vertexes. This path is called <strong>Hamilton path</strong>. The algorithm to find a hamilton path in a graph is quite slow with O(2 ** N) time complexity. We have to find another way.</p><p>Similar to hamilton path, the eular path is a path that visit all the edges of the graph. And this inspires us to make the strings to another graph, and the eular path will be the final answer with the complete password.</p><p><img alt="Alt text" loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/bd69ddd562d6b4b4cde4e3a461a8706e></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdio&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstdlib&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstring&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;algorithm&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;set&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define print(x) cout &lt;&lt; x &lt;&lt; endl
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define input(x) cin &gt;&gt; x
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define err(x)   cerr &lt;&lt; x &lt;&lt; endl
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> BASE <span style=color:#f92672>=</span> <span style=color:#ae81ff>64</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>64</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>64</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> g[SIZE][SIZE];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> iter[SIZE];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> father[SIZE];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> indeg[SIZE], outdeg[SIZE];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> ans;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>get_value</span>(<span style=color:#66d9ef>char</span> c) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>&lt;=</span> c <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;z&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;a&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>&lt;=</span> c <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;Z&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>&lt;=</span> c <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;9&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>52</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    err(<span style=color:#e6db74>&#34;get_value_err:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>&lt;&lt;</span> c);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>get_char</span>(<span style=color:#66d9ef>int</span> v) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;=</span> v <span style=color:#f92672>&amp;&amp;</span> v <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>25</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>+</span> v;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>26</span> <span style=color:#f92672>&lt;=</span> v <span style=color:#f92672>&amp;&amp;</span> v <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>51</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>+</span> v <span style=color:#f92672>-</span> <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>52</span> <span style=color:#f92672>&lt;=</span> v <span style=color:#f92672>&amp;&amp;</span> v <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>61</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>+</span> v <span style=color:#f92672>-</span> <span style=color:#ae81ff>52</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    err(<span style=color:#e6db74>&#34;get_char_err&#34;</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>&lt;&lt;</span> v);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>get_id</span>(<span style=color:#66d9ef>char</span> a, <span style=color:#66d9ef>char</span> b) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> ia <span style=color:#f92672>=</span> get_value(a);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> ib <span style=color:#f92672>=</span> get_value(b);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ia <span style=color:#f92672>*</span> BASE <span style=color:#f92672>+</span> ib;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>add_edge</span>(<span style=color:#66d9ef>const</span> string<span style=color:#f92672>&amp;</span> node_str) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a <span style=color:#f92672>=</span> get_id(node_str[<span style=color:#ae81ff>0</span>], node_str[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> b <span style=color:#f92672>=</span> get_id(node_str[<span style=color:#ae81ff>1</span>], node_str[<span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    g[a][b]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    outdeg[a]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    indeg[b]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>get_father</span>(<span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (father[x] <span style=color:#f92672>==</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> father[x] <span style=color:#f92672>=</span> get_father(father[x]);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>is_connected</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> SIZE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        father[i] <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> SIZE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> SIZE; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (g[i][j]) {
</span></span><span style=display:flex><span>                father[get_father(i)] <span style=color:#f92672>=</span> get_father(j);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    set<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> st;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> SIZE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>indeg[i] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>outdeg[i]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        st.insert(get_father(i));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> st.size() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1U</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>get_start_point</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>is_connected()) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> b <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> res <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> SIZE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (outdeg[i] <span style=color:#f92672>==</span> indeg[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            a<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>            res <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (outdeg[i] <span style=color:#f92672>==</span> indeg[i] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            c<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (outdeg[i] <span style=color:#f92672>==</span> indeg[i]) {
</span></span><span style=display:flex><span>            b<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> b <span style=color:#f92672>==</span> SIZE <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> res;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> b <span style=color:#f92672>==</span> SIZE) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>dfs</span>(<span style=color:#66d9ef>int</span> p) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> iter[p]; i <span style=color:#f92672>&lt;</span> SIZE; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (g[p][i]) {
</span></span><span style=display:flex><span>            g[p][i]<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>            dfs(i);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        iter[p]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    ans.push_back(p);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>show_path</span>(<span style=color:#66d9ef>int</span> st) {
</span></span><span style=display:flex><span>    string res;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> u: ans) {
</span></span><span style=display:flex><span>        u <span style=color:#f92672>%=</span> BASE;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span> c <span style=color:#f92672>=</span> get_char(u);
</span></span><span style=display:flex><span>        res <span style=color:#f92672>+=</span> c;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> a <span style=color:#f92672>=</span> get_char(st <span style=color:#f92672>/</span> BASE);
</span></span><span style=display:flex><span>    res <span style=color:#f92672>+=</span> a;
</span></span><span style=display:flex><span>    reverse(res.begin(), res.end());
</span></span><span style=display:flex><span>    print(res);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    input(n);
</span></span><span style=display:flex><span>    string node_str;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        input(node_str);
</span></span><span style=display:flex><span>        add_edge(node_str);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> u <span style=color:#f92672>=</span> get_start_point();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (u <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;NO&#34;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;YES&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (u <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            u <span style=color:#f92672>=</span> get_id(node_str[<span style=color:#ae81ff>0</span>], node_str[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        dfs(u);
</span></span><span style=display:flex><span>        show_path(u);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=e-arthur-and-brackets>E. Arthur and Brackets<a hidden class=anchor aria-hidden=true href=#e-arthur-and-brackets>#</a></h2><p>DP + Greedy</p><p>For this problem, be ware that the position of the right bracket is not the absolute position but the relative position. And according to the common sense, there will only be complete brackets between one left bracket and one right bracket.</p><p>For example,</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 176 41"><g transform="translate(8,16)"><circle cx="56" cy="0" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="56" cy="16" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="72" cy="0" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="72" cy="16" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="144" cy="0" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="144" cy="16" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="160" cy="0" r="6" stroke="currentcolor" fill="currentcolor"/><circle cx="160" cy="16" r="6" stroke="currentcolor" fill="currentcolor"/><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="0" y="20" fill="currentcolor" style="font-size:1em">W</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">I</text><text text-anchor="middle" x="8" y="20" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">G</text><text text-anchor="middle" x="16" y="20" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">H</text><text text-anchor="middle" x="24" y="20" fill="currentcolor" style="font-size:1em">N</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="20" fill="currentcolor" style="font-size:1em">G</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="40" y="20" fill="currentcolor" style="font-size:1em">:</text></g></svg></div><p>So, it&rsquo;s OK to close the bracket if possible. And this is the key to solve to problem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>n <span style=color:#f92672>=</span> int(raw_input())
</span></span><span style=display:flex><span>brackets <span style=color:#f92672>=</span> [tuple(map(int, raw_input()<span style=color:#f92672>.</span>split())) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(n)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>ptr <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>INF <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xcafebabe</span>
</span></span><span style=display:flex><span>st <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (l, r) <span style=color:#f92672>in</span> brackets:
</span></span><span style=display:flex><span>    res <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;(&#39;</span>
</span></span><span style=display:flex><span>    st<span style=color:#f92672>.</span>append((ptr <span style=color:#f92672>+</span> l, ptr <span style=color:#f92672>+</span> r))
</span></span><span style=display:flex><span>    ptr <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> st:
</span></span><span style=display:flex><span>        (pre_l, pre_r) <span style=color:#f92672>=</span> st[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pre_l <span style=color:#f92672>&lt;=</span> ptr <span style=color:#f92672>&lt;=</span> pre_r:
</span></span><span style=display:flex><span>            res <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;)&#39;</span>
</span></span><span style=display:flex><span>            ptr <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            st<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> st:
</span></span><span style=display:flex><span>    print <span style=color:#e6db74>&#39;IMPOSSIBLE&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print res
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://wizmann.top/tags/codeforces/>Codeforces</a></li><li><a href=https://wizmann.top/tags/algorithm/>Algorithm</a></li><li><a href=https://wizmann.top/tags/%E7%AE%97%E6%B3%95/>ç®æ³</a></li><li><a href=https://wizmann.top/tags/%E9%A2%98%E8%A7%A3/>é¢è§£</a></li></ul><nav class=paginav><a class=prev href=https://wizmann.top/posts/cf-289-div-2/><span class=title>Â«</span><br><span>Codeforces Round #289 (Div. 2) Tutorial</span>
</a><a class=next href=https://wizmann.top/posts/sequence-median/><span class=title>Â»</span><br><span>Sequence Median</span></a></nav></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://wizmann.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2025 <a href=https://wizmann.top/>Maerlyn's Rainbow</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>