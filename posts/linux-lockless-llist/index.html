<!doctype html><html><head><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}}</script><script defer src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><header class=header-wrapper><div class=header><a class=site-title href=https://wizmann.top/>Maerlyn's Rainbow</a><nav class=menu></nav></div></header><main class=main-wrapper><div class=main><section class=single><h1 class=title>Linuxå†…æ ¸ä¸­çš„å°‘é”é“¾è¡¨</h1><div class=tip><time datetime="2013-11-28 00:00:00 +0000 UTC">2013/11/28</time>
<span class=split>Â·</span>
<span>2898 words </span><span class=split>Â·</span>
<span>6 minutes to read</span></div><div class=taxonomies><div>Tags:
<a href=/tags/linux>linux</a>
<a href=/tags/lock-less>lock-less</a>
<a href=/tags/%E9%93%BE%E8%A1%A8>é“¾è¡¨</a>
<a href=/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B>å¹¶å‘ç¼–ç¨‹</a></div></div><hr><div class=content><h1 id=å‰è¨€>å‰è¨€ <a href=#%e5%89%8d%e8%a8%80 class=anchor>ğŸ”—</a></h1><p>æœ€è¿‘åœ¨stackexchangeä¸Šçœ‹åˆ°ä¸€ä¸ªé—®ç­”ï¼Œè®¨è®ºæˆ‘ä»¬å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¸ç®—æ³•åœ¨å®é™…å·¥ç¨‹ä¸­çš„åº”ç”¨ã€‚(<a href=http://cstheory.stackexchange.com/questions/19759/core-algorithms-deployed/19773#19773>æˆ³æˆ‘</a>)</p><p>æˆ‘æ‰“ç®—å€ŸåŠ©è¿™ä¸ªé—®ç­”ä¸­çš„å†…å®¹ï¼Œä»¥æˆ‘æ¯”è¾ƒç†Ÿæ‚‰çš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä¸ºç´¢å¼•æ¥é˜…è¯»å¼€æºä»£ç ã€‚</p><h1 id=æ­£æ–‡>æ­£æ–‡ <a href=#%e6%ad%a3%e6%96%87 class=anchor>ğŸ”—</a></h1><h2 id=talk-is-cheap>Talk is cheap <a href=#talk-is-cheap class=anchor>ğŸ”—</a></h2><blockquote><p>Lock-less NULL terminated single linked list</p></blockquote><p><a href=https://github.com/mirrors/linux-2.6/blob/master/include/linux/llist.h>linux-2.6/include/linux/llist.h</a></p><p><a href=https://github.com/mirrors/linux-2.6/blob/master/lib/llist.c>linux-2.6/lib/llist.c</a></p><h2 id=çŸ¥è¯†å‡†å¤‡>çŸ¥è¯†å‡†å¤‡ <a href=#%e7%9f%a5%e8%af%86%e5%87%86%e5%a4%87 class=anchor>ğŸ”—</a></h2><h3 id=volatile>volatile <a href=#volatile class=anchor>ğŸ”—</a></h3><blockquote><p>volatileå…³é”®å­—å£°æ˜çš„å˜é‡æˆ–å¯¹è±¡é€šå¸¸æ‹¥æœ‰å’Œä¼˜åŒ–å’Œï¼ˆæˆ–ï¼‰å¤šçº¿ç¨‹ç›¸å…³çš„ç‰¹æ®Šå±æ€§ã€‚</p></blockquote><blockquote><p>é€šå¸¸ï¼Œvolatileå…³é”®å­—ç”¨æ¥é˜»æ­¢ï¼ˆä¼ªï¼‰ç¼–è¯‘å™¨å¯¹é‚£äº›å®ƒè®¤ä¸ºå˜é‡çš„å€¼ä¸èƒ½â€œè¢«ä»£ç æœ¬èº«â€æ”¹å˜çš„ä»£ç ä¸Šæ‰§è¡Œä»»ä½•ä¼˜åŒ–ã€‚</p></blockquote><blockquote><p>å¦‚æœä¸ä½¿ç”¨volatileå…³é”®å­—ï¼Œç¼–è¯‘å™¨å°†å‡è®¾å½“å‰ç¨‹åºæ˜¯ç³»ç»Ÿä¸­å”¯ä¸€èƒ½æ”¹å˜è¿™ä¸ªå€¼éƒ¨åˆ†ã€‚ ä¸ºäº†é˜»æ­¢ç¼–è¯‘å™¨åƒä¸Šé¢é‚£æ ·ä¼˜åŒ–ä»£ç ï¼Œéœ€è¦ä½¿ç”¨volatileå…³é”®å­—ã€‚</p></blockquote><blockquote><p>From: <a href=http://zh.wikipedia.org/wiki/Volatile%E5%8F%98%E9%87%8F>http://zh.wikipedia.org/wiki/Volatile%E5%8F%98%E9%87%8F</a></p></blockquote><h3 id=typeof>typeof <a href=#typeof class=anchor>ğŸ”—</a></h3><blockquote><p>Another way to refer to the type of an expression is with typeof. The syntax of using of this keyword looks like sizeof, but the construct acts semantically like a type name defined with typedef.</p></blockquote><blockquote><p>From: <a href=http://gcc.gnu.org/onlinedocs/gcc/Typeof.html>http://gcc.gnu.org/onlinedocs/gcc/Typeof.html</a></p></blockquote><p><code>typeof</code>å’Œ<code>sizeof</code>ç±»ä¼¼ï¼Œsizeofæ±‚çš„æ˜¯å˜é‡/ç±»å‹çš„å¤§å°ï¼Œè€Œtypeofæ˜¯æ±‚å˜é‡/ç±»å‹çš„<strong>æ•°æ®ç±»å‹</strong>ã€‚</p><p>typeofåœ¨#defineä¸­çš„åº”ç”¨å¾ˆå¤šï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#define max(a,b) \
</span></span></span><span style=display:flex><span><span style=color:#75715e>   ({ typeof (a) _a = (a); \
</span></span></span><span style=display:flex><span><span style=color:#75715e>       typeof (b) _b = (b); \
</span></span></span><span style=display:flex><span><span style=color:#75715e>     _a &gt; _b ? _a : _b; })
</span></span></span></code></pre></div><p><code>typeof(a)</code>è·å¾—äº†<code>a</code>çš„ç±»å‹ï¼Œå£°æ˜äº†ä¸€ä¸ªåŒç±»å‹çš„<code>_a</code>å˜é‡ã€‚</p><p>p.s. ä¸Šé¢æ˜¯ä¸€ä¸ªå®‰å…¨çš„ç”¨<code>#define</code>å®ç°çš„<code>max</code>å‡½æ•°ã€‚</p><h3 id=access_once>ACCESS_ONCE <a href=#access_once class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#define ACCESS_ONCE(x) (*(volatile typeof(x) *)&amp;(x))ï¼›
</span></span></span></code></pre></div><p><code>ACCESS_ONCE</code>ä½¿ç”¨äº†ä¸€ä¸ªç±»å‹è½¬æ¢ï¼Œä½¿ç”¨<code>volatile</code>ä¿®é¥° <code>x</code>ã€‚é¿å…ç¼–è¯‘å™¨ä¼˜åŒ–å¸¦æ¥çš„æ½œåœ¨å²ä¹‰ã€‚</p><h3 id=cmpxchg>cmpxchg <a href=#cmpxchg class=anchor>ğŸ”—</a></h3><blockquote><p>compare-and-swap (CAS) is an atomic instruction used in multithreading to achieve synchronization.</p></blockquote><blockquote><p>It compares the contents of a memory location to a given value and, only if they are the same, modifies the contents of that memory location to a given new value.</p></blockquote><blockquote><p>This is done as a single atomic operation. The atomicity guarantees that the new value is calculated based on up-to-date information; if the value had been updated by another thread in the meantime, the write would fail.</p></blockquote><blockquote><p>The result of the operation must indicate whether it performed the substitution; this can be done either with a simple Boolean response (this variant is often called compare-and-set), or by returning the value read from the memory location (not the value written to it).</p></blockquote><blockquote><p>&mldr;</p></blockquote><blockquote><p>In the x86 (since 80486) and Itanium architectures this is implemented as the compare and exchange (CMPXCHG) instruction, though here the LOCK prefix should be there to make it really atomic.</p></blockquote><blockquote><p>From: <a href=http://en.wikipedia.org/wiki/Compare-and-swap>http://en.wikipedia.org/wiki/Compare-and-swap</a></p></blockquote><p><code>cmpxchg</code>æ˜¯åœ¨Intelå¹³å°ä¸Š<code>atomic compare-and-swap</code>æ“ä½œçš„å®ç°ã€‚</p><p><code>cmpxchg</code>è¿˜è¢«ç”¨æ¥å®ç°<code>spinlock</code>ï¼Œ<a href=http://stackoverflow.com/questions/6935442/x86-spinlock-using-cmpxchg>æˆ³æˆ‘</a>ã€‚</p><h2 id=show-me-the-code>Show me the code <a href=#show-me-the-code class=anchor>ğŸ”—</a></h2><h3 id=æ•°æ®ç±»å‹>æ•°æ®ç±»å‹ <a href=#%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> llist_head {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>first;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> llist_node {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>ä¸€ä¸ªç®€å•çš„ç±»å‹åŒ…è£¹ã€‚</p><p><code>llist_head</code>æ˜¯é“¾è¡¨å¤´ï¼Œè€Œ<code>llist_node</code>æ˜¯é“¾è¡¨ä¸­<strong>é“¾</strong>çš„éƒ¨åˆ†ã€‚</p><h3 id=åˆå§‹åŒ–>åˆå§‹åŒ– <a href=#%e5%88%9d%e5%a7%8b%e5%8c%96 class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define LLIST_HEAD_INIT(name)        { NULL }
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define LLIST_HEAD(name)        struct llist_head name = LLIST_HEAD_INIT(name)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * init_llist_head - initialize lock-less list head
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the head for your lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>init_llist_head</span>(<span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>list)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        list<span style=color:#f92672>-&gt;</span>first <span style=color:#f92672>=</span> NULL;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=é“¾è¡¨çš„éå†>é“¾è¡¨çš„éå† <a href=#%e9%93%be%e8%a1%a8%e7%9a%84%e9%81%8d%e5%8e%86 class=anchor>ğŸ”—</a></h3><h4 id=llist_entry>llist_entry <a href=#llist_entry class=anchor>ğŸ”—</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_entry - get the struct of this entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @ptr:        the &amp;struct llist_node pointer.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @type:        the type of the struct this is embedded in.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @member:        the name of the llist_node within the struct.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define llist_entry(ptr, type, member)                \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        container_of(ptr, type, member)
</span></span></span></code></pre></div><p>å£°æ˜ä¸€ä¸ªé“¾è¡¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ<code>llist_node</code>åŒ…å«åœ¨é“¾è¡¨èŠ‚ç‚¹ä¸­ï¼Œ<code>llist_head</code>æ˜¯é“¾è¡¨å¤´ã€‚</p><p><code>llist_entry</code>æ˜¯ä»é“¾è¡¨èŠ‚ç‚¹ä¸­çš„<code>llist_node</code>æˆå‘˜å˜é‡è·å¾—é“¾è¡¨èŠ‚ç‚¹çš„åœ°å€ã€‚</p><p><code>llist_entry</code>å®æ˜¯ä»<code>container_of</code>å®ç»§æ‰¿è€Œæ¥çš„ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * container_of - cast a member of a structure out to the containing structure
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @ptr:        the pointer to the member.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @type:        the type of the container struct this is embedded in.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @member:        the name of the member within the struct.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define container_of(ptr, type, member) ({                        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        const typeof( ((type *)0)-&gt;member ) *__mptr = (ptr);        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        (type *)( (char *)__mptr - offsetof(type,member) );})
</span></span></span></code></pre></div><p>å…·ä½“åŸç†å¯ä»¥å°å°å‚è€ƒä¸€ä¸‹<a href=http://hi.baidu.com/holinux/item/af2e32c9dcbd3953ac00ef49>è¿™é‡Œ</a>ã€‚</p><h4 id=for_each>for_each <a href=#for_each class=anchor>ğŸ”—</a></h4><h5 id=llist_for_each>llist_for_each <a href=#llist_for_each class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_for_each - iterate over some deleted entries of a lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @pos:        the &amp;struct llist_node to use as a loop cursor
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @node:        the first entry of deleted list entries
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * In general, some entries of the lock-less list can be traversed
</span></span></span><span style=display:flex><span><span style=color:#75715e> * safely only after being deleted from list, so start with an entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * instead of list head.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * If being used on entries deleted from lock-less list directly, the
</span></span></span><span style=display:flex><span><span style=color:#75715e> * traverse order is from the newest to the oldest added entry.  If
</span></span></span><span style=display:flex><span><span style=color:#75715e> * you want to traverse from the oldest to the newest, you must
</span></span></span><span style=display:flex><span><span style=color:#75715e> * reverse the order by yourself before traversing.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define llist_for_each(pos, node)                        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        for ((pos) = (node); pos; (pos) = (pos)-&gt;next)
</span></span></span></code></pre></div><p>ä¸€ä¸ª<code>forå¾ªç¯</code>ã€‚ç®€å•çš„å®ã€‚</p><h5 id=llist_for_each_entry>llist_for_each_entry <a href=#llist_for_each_entry class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_for_each_entry - iterate over some deleted entries of lock-less list of given type
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @pos:        the type * to use as a loop cursor.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @node:        the fist entry of deleted list entries.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @member:        the name of the llist_node with the struct.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * In general, some entries of the lock-less list can be traversed
</span></span></span><span style=display:flex><span><span style=color:#75715e> * safely only after being removed from list, so start with an entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * instead of list head.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * If being used on entries deleted from lock-less list directly, the
</span></span></span><span style=display:flex><span><span style=color:#75715e> * traverse order is from the newest to the oldest added entry.  If
</span></span></span><span style=display:flex><span><span style=color:#75715e> * you want to traverse from the oldest to the newest, you must
</span></span></span><span style=display:flex><span><span style=color:#75715e> * reverse the order by yourself before traversing.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define llist_for_each_entry(pos, node, member)                                \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        for ((pos) = llist_entry((node), typeof(*(pos)), member);        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &amp;(pos)-&gt;member != NULL;                                        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>             (pos) = llist_entry((pos)-&gt;member.next, typeof(*(pos)), member))
</span></span></span></code></pre></div><p>éå†é“¾è¡¨çš„ç±»ã€‚
ç”¨ä¼ªä»£ç æ¥è¡¨è¿°ä¸€ä¸‹å°±æ˜¯ã€‚</p><div class=mermaid>for ((pos) = é“¾è¡¨èŠ‚ç‚¹;
&(pos)->nextæŒ‡é’ˆ != NULL;
(pos) = é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹) {
// éå†æ“ä½œ
pos.foo = bar;
}</div><h5 id=llist_for_each_entry_safe>llist_for_each_entry_safe <a href=#llist_for_each_entry_safe class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_for_each_entry_safe - iterate over some deleted entries of lock-less list of given type
</span></span></span><span style=display:flex><span><span style=color:#75715e> *                               safe against removal of list entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @pos:        the type * to use as a loop cursor.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @n:                another type * to use as temporary storage
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @node:        the first entry of deleted list entries.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @member:        the name of the llist_node with the struct.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * In general, some entries of the lock-less list can be traversed
</span></span></span><span style=display:flex><span><span style=color:#75715e> * safely only after being removed from list, so start with an entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * instead of list head.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * If being used on entries deleted from lock-less list directly, the
</span></span></span><span style=display:flex><span><span style=color:#75715e> * traverse order is from the newest to the oldest added entry.  If
</span></span></span><span style=display:flex><span><span style=color:#75715e> * you want to traverse from the oldest to the newest, you must
</span></span></span><span style=display:flex><span><span style=color:#75715e> * reverse the order by yourself before traversing.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define llist_for_each_entry_safe(pos, n, node, member)                               \
</span></span></span><span style=display:flex><span><span style=color:#75715e>        for (pos = llist_entry((node), typeof(*pos), member);                       \
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &amp;pos-&gt;member != NULL &amp;&amp;                                               \
</span></span></span><span style=display:flex><span><span style=color:#75715e>                (n = llist_entry(pos-&gt;member.next, typeof(*n), member), true); \
</span></span></span><span style=display:flex><span><span style=color:#75715e>             pos = n)
</span></span></span></code></pre></div><p><code>safe</code>è¡¨ç¤ºå•é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æœ‰å¯èƒ½è¢«å¢åŠ /åˆ é™¤ã€‚</p><p>ä½¿ç”¨<code>(n = llist_entry(pos->member.next, typeof(*n), member), true)</code>å¯ä»¥ä¿æŒéå†çš„å®‰å…¨æ€§ã€‚</p><h6 id=llist_next>llist_next <a href=#llist_next class=anchor>ğŸ”—</a></h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span><span style=color:#a6e22e>llist_next</span>(<span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>node)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> node<span style=color:#f92672>-&gt;</span>next;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=é“¾è¡¨å…ƒç´ çš„æ“ä½œ>é“¾è¡¨å…ƒç´ çš„æ“ä½œ <a href=#%e9%93%be%e8%a1%a8%e5%85%83%e7%b4%a0%e7%9a%84%e6%93%8d%e4%bd%9c class=anchor>ğŸ”—</a></h3><h5 id=llist_add_batch>llist_add_batch <a href=#llist_add_batch class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_add_batch - add several linked entries in batch
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @new_first:        first entry in batch to be added
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @new_last:        last entry in batch to be added
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the head for your lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Return whether list is empty before adding.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>llist_add_batch</span>(<span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>new_first, <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>new_last,
</span></span><span style=display:flex><span>                     <span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>first;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>                new_last<span style=color:#f92672>-&gt;</span>next <span style=color:#f92672>=</span> first <span style=color:#f92672>=</span> <span style=color:#a6e22e>ACCESS_ONCE</span>(head<span style=color:#f92672>-&gt;</span>first);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>cmpxchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, first, new_first) <span style=color:#f92672>!=</span> first);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>!</span>first;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ‰¹é‡å¢åŠ å‘½ä»¤ï¼Œä½¿ç”¨<code>cmpxchg</code>ä¿æŒçº¿ç¨‹å®‰å…¨ã€‚</p><h5 id=llist_add>llist_add <a href=#llist_add class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_add - add a new entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @new:        new entry to be added
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the head for your lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Returns true if the list was empty prior to adding this entry.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>llist_add</span>(<span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>new, <span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>llist_add_batch</span>(new, new, head);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=llist_empty>llist_empty <a href=#llist_empty class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_empty - tests whether a lock-less list is empty
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the list to test
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Not guaranteed to be accurate or up to date.  Just a quick way to
</span></span></span><span style=display:flex><span><span style=color:#75715e> * test whether the list is empty without deleting something from the
</span></span></span><span style=display:flex><span><span style=color:#75715e> * list.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>llist_empty</span>(<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ACCESS_ONCE</span>(head<span style=color:#f92672>-&gt;</span>first) <span style=color:#f92672>==</span> NULL;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä½¿ç”¨<code>ACCESS_ONCE</code>é¿å…ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä¿æŒçº¿ç¨‹å®‰å…¨æ€§ã€‚</p><h5 id=llist_del_all>llist_del_all <a href=#llist_del_all class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_del_all - delete all entries from lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the head of lock-less list to delete all entries
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * If list is empty, return NULL, otherwise, delete all entries and
</span></span></span><span style=display:flex><span><span style=color:#75715e> * return the pointer to the first entry.  The order of entries
</span></span></span><span style=display:flex><span><span style=color:#75715e> * deleted is from the newest to the oldest added one.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span><span style=color:#a6e22e>llist_del_all</span>(<span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>xchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, NULL);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=llist_del_first>llist_del_first <a href=#llist_del_first class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_del_first - delete the first entry of lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        the head for your lock-less list
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * If list is empty, return NULL, otherwise, return the first entry
</span></span></span><span style=display:flex><span><span style=color:#75715e> * deleted, this is the newest added one.
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Only one llist_del_first user can be used simultaneously with
</span></span></span><span style=display:flex><span><span style=color:#75715e> * multiple llist_add users without lock.  Because otherwise
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_del_first, llist_add, llist_add (or llist_del_all, llist_add,
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_add) sequence in another user may change @head-&gt;first-&gt;next,
</span></span></span><span style=display:flex><span><span style=color:#75715e> * but keep @head-&gt;first.  If multiple consumers are needed, please
</span></span></span><span style=display:flex><span><span style=color:#75715e> * use llist_del_all or use lock between consumers.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span><span style=color:#a6e22e>llist_del_first</span>(<span style=color:#66d9ef>struct</span> llist_head <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>entry, <span style=color:#f92672>*</span>old_entry, <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        entry <span style=color:#f92672>=</span> head<span style=color:#f92672>-&gt;</span>first;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (;;) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (entry <span style=color:#f92672>==</span> NULL)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> NULL;
</span></span><span style=display:flex><span>                old_entry <span style=color:#f92672>=</span> entry;
</span></span><span style=display:flex><span>                next <span style=color:#f92672>=</span> entry<span style=color:#f92672>-&gt;</span>next;
</span></span><span style=display:flex><span>                entry <span style=color:#f92672>=</span> <span style=color:#a6e22e>cmpxchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, old_entry, next);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (entry <span style=color:#f92672>==</span> old_entry)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> entry;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>åˆ é™¤ç¬¬ä¸€ä¸ªå€¼ã€‚åŒæ ·çš„æ— é”æ“ä½œã€‚</p><h5 id=llist_reverse_order>llist_reverse_order <a href=#llist_reverse_order class=anchor>ğŸ”—</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * llist_reverse_order - reverse order of a llist chain
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @head:        first item of the list to be reversed
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Reverse the order of a chain of llist entries and return the
</span></span></span><span style=display:flex><span><span style=color:#75715e> * new first entry.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span><span style=color:#a6e22e>llist_reverse_order</span>(<span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>head)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>new_head <span style=color:#f92672>=</span> NULL;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (head) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> llist_node <span style=color:#f92672>*</span>tmp <span style=color:#f92672>=</span> head;
</span></span><span style=display:flex><span>                head <span style=color:#f92672>=</span> head<span style=color:#f92672>-&gt;</span>next;
</span></span><span style=display:flex><span>                tmp<span style=color:#f92672>-&gt;</span>next <span style=color:#f92672>=</span> new_head;
</span></span><span style=display:flex><span>                new_head <span style=color:#f92672>=</span> tmp;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> new_head;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>EXPORT_SYMBOL_GPL</span>(llist_reverse_order);
</span></span></code></pre></div><p>å¦‚ä½•åè½¬ä¸€ä¸ªå•é“¾è¡¨</p><h2 id=å°‘é”é“¾è¡¨æ˜¯å¦‚ä½•å®ç°çš„>å°‘é”é“¾è¡¨æ˜¯å¦‚ä½•å®ç°çš„ <a href=#%e5%b0%91%e9%94%81%e9%93%be%e8%a1%a8%e6%98%af%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0%e7%9a%84 class=anchor>ğŸ”—</a></h2><h3 id=addå‡½æ•°ä¸­çš„åŸå­æ“ä½œ>addå‡½æ•°ä¸­çš„åŸå­æ“ä½œ <a href=#add%e5%87%bd%e6%95%b0%e4%b8%ad%e7%9a%84%e5%8e%9f%e5%ad%90%e6%93%8d%e4%bd%9c class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>    new_last<span style=color:#f92672>-&gt;</span>next <span style=color:#f92672>=</span> first <span style=color:#f92672>=</span> <span style=color:#a6e22e>ACCESS_ONCE</span>(head<span style=color:#f92672>-&gt;</span>first);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>cmpxchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, first, new_first) <span style=color:#f92672>!=</span> first);
</span></span></code></pre></div><p>å…¶ä¸­<code>cmpxchg</code>çš„æ€§è´¨ç±»ä¼¼äºé”ã€‚ä¿è¯èµ‹å€¼æ˜¯æˆåŠŸçš„ä¸”æ˜¯æ˜¯åŸå­çš„ã€‚</p><h3 id=del_firstä¸­çš„åŸå­æ“ä½œ>del_firstä¸­çš„åŸå­æ“ä½œ <a href=#del_first%e4%b8%ad%e7%9a%84%e5%8e%9f%e5%ad%90%e6%93%8d%e4%bd%9c class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>entry <span style=color:#f92672>=</span> <span style=color:#a6e22e>cmpxchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, old_entry, next);
</span></span></code></pre></div><h3 id=del_allä¸­çš„åŸå­æ“ä½œ>del_allä¸­çš„åŸå­æ“ä½œ <a href=#del_all%e4%b8%ad%e7%9a%84%e5%8e%9f%e5%ad%90%e6%93%8d%e4%bd%9c class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#a6e22e>xchg</span>(<span style=color:#f92672>&amp;</span>head<span style=color:#f92672>-&gt;</span>first, NULL);
</span></span></code></pre></div><h3 id=å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†å¹¶å‘>å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†å¹¶å‘ <a href=#%e5%b0%91%e9%94%81%e9%93%be%e8%a1%a8%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86%e5%b9%b6%e5%8f%91 class=anchor>ğŸ”—</a></h3><p>åœ¨llist.hä¸­æœ‰å¦‚ä¸‹çš„æ³¨é‡Šè¡¨æ˜å¦‚æœä¸¤ç§æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œæ˜¯å¦éœ€è¦åŠ é¢å¤–çš„é”ã€‚</p><div class=mermaid>/*
* | add | del_first | del_all
* add | - | - | -
* del_first | | L | L
* del_all | | | -
*/</div><p><code>add</code>æ“ä½œå’Œå¤´æŒ‡é’ˆæ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å’Œå…¶å®ƒæ“ä½œå¹¶è¡Œã€‚
<code>del_first</code>ä¾èµ–äº<code>list->first->next</code>åœ¨æ“ä½œæ—¶ä¸å˜åŒ–ã€‚
è€Œ<code>del_all</code>åªå¯¹<code>list->first</code>çš„æŒ‡é’ˆè¿›è¡Œæ“ä½œã€‚æ‰€ä»¥æ˜¯å¯ä»¥å¹¶è¡Œçš„ã€‚</p><h3 id=å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†éå†>å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†éå† <a href=#%e5%b0%91%e9%94%81%e9%93%be%e8%a1%a8%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86%e9%81%8d%e5%8e%86 class=anchor>ğŸ”—</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e> * The list entries deleted via llist_del_all can be traversed with
</span></span></span><span style=display:flex><span><span style=color:#75715e> * traversing function such as llist_for_each etc.  But the list
</span></span></span><span style=display:flex><span><span style=color:#75715e> * entries can not be traversed safely before deleted from the list.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * The order of deleted entries is from the newest to the oldest added
</span></span></span><span style=display:flex><span><span style=color:#75715e> * one.  If you want to traverse from the oldest to the newest, you
</span></span></span><span style=display:flex><span><span style=color:#75715e> * must reverse the order by yourself before traversing.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span></code></pre></div><p>å¤§æ¦‚æ„æ€æ˜¯è¯´åªæœ‰ä»åˆ—è¡¨ä¸Šåˆ é™¤ä¸‹æ¥çš„å…ƒç´ æ‰å¯ä»¥å®‰å…¨çš„éå†ã€‚ï¼ˆè¿™ç‚¹ç†è§£çš„ä¸æ·±å…¥ï¼‰</p><h2 id=åè®°>åè®° <a href=#%e5%90%8e%e8%ae%b0 class=anchor>ğŸ”—</a></h2><p>æœ¬æ¥æ˜¯æƒ³æŠŠè¿™llistçš„ä»£ç çœ‹æ˜ç™½çš„ã€‚ä½†æ˜¯ï¼Œå¤§æ¦‚åªçœ‹æ‡‚äº†60%ã€‚ã€‚ã€‚</p><p>ä»¥åå¦‚æœæœ‰æ–°çš„æƒ³æ³•ï¼Œçœ‹åˆ°äº†æ–°çš„ä¸œè¥¿ï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸å°‘æœ‰ç”¨çš„updateå§ã€‚ã€‚</p></div></section></div><div class=side><div class=side-recent><h2 class=side-title><a href=/posts/>Recent Posts</a></h2><hr><ul><li><a href=/posts/why-not-start-with-ddia-part-1/>ä¸ºä»€ä¹ˆæˆ‘ä¸å»ºè®®ä½ é˜…è¯»ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ï¼ˆä¹‹ä¸€ï¼‰</a></li><li><a href=/posts/vertical-axis-wind-turbine-3d-model/>é£åŠ›æ¶¡è½®æœº 3D æ¨¡å‹ / Vertical Axis Wind Turbine (VAWT) 3D Model</a></li><li><a href=/posts/press-pad-3d-model/>3Dæ‰“å°è§£å‹ç©å…· / 3D Printed Fidget Toy</a></li><li><a href=/posts/lava-store/>è®ºæ–‡é˜…è¯»ï¼šLavaStore - é«˜æ€§èƒ½ã€æœ¬åœ°å­˜å‚¨å¼•æ“çš„æ¼”è¿›</a></li><li><a href=/posts/std-smart-ptrs-cpp-for-the-antiquated-4/>åŠ¨æ‰‹å®ç°æ™ºèƒ½æŒ‡é’ˆ ï¼ˆä¸Šç¯‡ï¼‰ - C++ for the Antiquatedï¼ˆä¹‹å››ï¼‰</a></li></ul></div><div class=side-categories><h2>Categories</h2><hr><ul></ul></div><div class=side-tags><h2>Tags</h2><hr><ul><li><a href=/tags/.net>.net (1)</a></li><li><a href=/tags/3d-printing>3d printing (2)</a></li><li><a href=/tags/a2b>a2b (1)</a></li><li><a href=/tags/ahk>ahk (1)</a></li><li><a href=/tags/algorithm>algorithm (26)</a></li><li><a href=/tags/alloca>alloca (1)</a></li><li><a href=/tags/allocate>allocate (1)</a></li><li><a href=/tags/arduino>arduino (1)</a></li><li><a href=/tags/asm>asm (1)</a></li><li><a href=/tags/async>async (2)</a></li><li><a href=/tags/atcoder>atcoder (1)</a></li><li><a href=/tags/autohotkey>autohotkey (1)</a></li><li><a href=/tags/autopilot>autopilot (1)</a></li><li><a href=/tags/azure>azure (2)</a></li><li><a href=/tags/b-tree>b-tree (1)</a></li><li><a href=/tags/basic-paxos>basic paxos (2)</a></li><li><a href=/tags/bbr>bbr (1)</a></li><li><a href=/tags/binary-indexed-tree>binary indexed tree (1)</a></li><li><a href=/tags/binary-tree>binary tree (1)</a></li><li><a href=/tags/bittorrent>bittorrent (1)</a></li><li><a href=/tags/borg>borg (1)</a></li><li><a href=/tags/bw-tree>bw-tree (1)</a></li><li><a href=/tags/c>c# (1)</a></li><li><a href=/tags/c++>c++ (6)</a></li><li><a href=/tags/cache>cache (1)</a></li><li><a href=/tags/cachegrind>cachegrind (1)</a></li><li><a href=/tags/cap>cap (1)</a></li><li><a href=/tags/career>career (1)</a></li><li><a href=/tags/cas>cas (3)</a></li><li><a href=/tags/ceph>ceph (1)</a></li><li><a href=/tags/chrome-extension>chrome-extension (2)</a></li><li><a href=/tags/cmpxchg>cmpxchg (2)</a></li><li><a href=/tags/cocurrency>cocurrency (1)</a></li><li><a href=/tags/code-golf>code golf (1)</a></li><li><a href=/tags/codeforces>codeforces (14)</a></li><li><a href=/tags/compare-ans-swap>compare-ans-swap (1)</a></li><li><a href=/tags/computational-geometry>computational geometry (1)</a></li><li><a href=/tags/consistency>consistency (1)</a></li><li><a href=/tags/cpp>cpp (9)</a></li><li><a href=/tags/cpu>cpu (1)</a></li><li><a href=/tags/cse351>cse351 (2)</a></li><li><a href=/tags/csharp>csharp (1)</a></li><li><a href=/tags/css>css (1)</a></li><li><a href=/tags/data-center>data center (1)</a></li><li><a href=/tags/data-center-management>data center management (1)</a></li><li><a href=/tags/defer>defer (1)</a></li><li><a href=/tags/distributed-system>distributed system (4)</a></li><li><a href=/tags/epoll>epoll (1)</a></li><li><a href=/tags/ergodone>ergodone (1)</a></li><li><a href=/tags/fifo>fifo (1)</a></li><li><a href=/tags/flatbuffer>flatbuffer (2)</a></li><li><a href=/tags/fn-layer>fn-layer (1)</a></li><li><a href=/tags/front-end-development>front-end development (1)</a></li><li><a href=/tags/functional-programming>functional programming (1)</a></li><li><a href=/tags/game>game (1)</a></li><li><a href=/tags/gcj>gcj (1)</a></li><li><a href=/tags/geohash>geohash (1)</a></li><li><a href=/tags/geometric>geometric (1)</a></li><li><a href=/tags/geometry>geometry (1)</a></li><li><a href=/tags/get-things-done>get things done (1)</a></li><li><a href=/tags/google>google (3)</a></li><li><a href=/tags/graph>graph (1)</a></li><li><a href=/tags/head-first>head-first (1)</a></li><li><a href=/tags/heap>heap (1)</a></li><li><a href=/tags/herd7>herd7 (1)</a></li><li><a href=/tags/induction>induction (2)</a></li><li><a href=/tags/interview>interview (5)</a></li><li><a href=/tags/keyboard>keyboard (2)</a></li><li><a href=/tags/kubernetes>kubernetes (1)</a></li><li><a href=/tags/lavastore>lavastore (1)</a></li><li><a href=/tags/leetcode>leetcode (4)</a></li><li><a href=/tags/leveldb>leveldb (1)</a></li><li><a href=/tags/linkedin>linkedin (1)</a></li><li><a href=/tags/linux>linux (1)</a></li><li><a href=/tags/litmus>litmus (1)</a></li><li><a href=/tags/lock-less>lock-less (1)</a></li><li><a href=/tags/lsm-tree>lsm-tree (1)</a></li><li><a href=/tags/markdown>markdown (1)</a></li><li><a href=/tags/median>median (1)</a></li><li><a href=/tags/memory>memory (1)</a></li><li><a href=/tags/memory-barrier>memory-barrier (3)</a></li><li><a href=/tags/mesi>mesi (1)</a></li><li><a href=/tags/message-queue>message queue (1)</a></li><li><a href=/tags/metadata>metadata (1)</a></li><li><a href=/tags/metaprogramming>metaprogramming (1)</a></li><li><a href=/tags/microsoft>microsoft (2)</a></li><li><a href=/tags/misaka>misaka (1)</a></li><li><a href=/tags/modern-c++>modern c++ (1)</a></li><li><a href=/tags/modern-cpp>modern cpp (4)</a></li><li><a href=/tags/mosca>mosca (1)</a></li><li><a href=/tags/mq>mq (1)</a></li><li><a href=/tags/multi-paxos>multi paxos (1)</a></li><li><a href=/tags/multi-thread>multi-thread (3)</a></li><li><a href=/tags/multiprocess>multiprocess (1)</a></li><li><a href=/tags/multithread>multithread (3)</a></li><li><a href=/tags/network>network (1)</a></li><li><a href=/tags/networking>networking (4)</a></li><li><a href=/tags/non-blocking>non-blocking (1)</a></li><li><a href=/tags/normal-distribution>normal-distribution (1)</a></li><li><a href=/tags/ocaml>ocaml (1)</a></li><li><a href=/tags/ot>ot (1)</a></li><li><a href=/tags/parallel>parallel (1)</a></li><li><a href=/tags/partition>partition (1)</a></li><li><a href=/tags/paxos>paxos (2)</a></li><li><a href=/tags/pecifica>pecifica (1)</a></li><li><a href=/tags/pelican>pelican (1)</a></li><li><a href=/tags/phxrpc>phxrpc (8)</a></li><li><a href=/tags/pl>pl (1)</a></li><li><a href=/tags/poi>poi (1)</a></li><li><a href=/tags/poll>poll (1)</a></li><li><a href=/tags/powershell>powershell (1)</a></li><li><a href=/tags/priority-queue>priority queue (1)</a></li><li><a href=/tags/priority_queue>priority_queue (1)</a></li><li><a href=/tags/profile>profile (1)</a></li><li><a href=/tags/programming-interview>programming interview (1)</a></li><li><a href=/tags/promela>promela (2)</a></li><li><a href=/tags/protobuf>protobuf (1)</a></li><li><a href=/tags/protocol>protocol (4)</a></li><li><a href=/tags/python>python (3)</a></li><li><a href=/tags/quartile>quartile (1)</a></li><li><a href=/tags/queue>queue (2)</a></li><li><a href=/tags/quick-sort>quick sort (1)</a></li><li><a href=/tags/quora>quora (1)</a></li><li><a href=/tags/racket>racket (1)</a></li><li><a href=/tags/raft>raft (2)</a></li><li><a href=/tags/rocksdb>rocksdb (2)</a></li><li><a href=/tags/rpc>rpc (4)</a></li><li><a href=/tags/social-network>social network (1)</a></li><li><a href=/tags/socket>socket (1)</a></li><li><a href=/tags/solution>solution (2)</a></li><li><a href=/tags/sort>sort (1)</a></li><li><a href=/tags/spin>spin (4)</a></li><li><a href=/tags/spin/promela>spin/promela (2)</a></li><li><a href=/tags/stack>stack (2)</a></li><li><a href=/tags/stdfunction>std::function (1)</a></li><li><a href=/tags/stl>stl (1)</a></li><li><a href=/tags/storage>storage (3)</a></li><li><a href=/tags/storage-system>storage system (2)</a></li><li><a href=/tags/streambuf>streambuf (1)</a></li><li><a href=/tags/string>string (1)</a></li><li><a href=/tags/stup>stup (3)</a></li><li><a href=/tags/stylish>stylish (1)</a></li><li><a href=/tags/system>system (1)</a></li><li><a href=/tags/system-design>system design (5)</a></li><li><a href=/tags/tcp>tcp (4)</a></li><li><a href=/tags/tcpip>tcpip (1)</a></li><li><a href=/tags/thread>thread (3)</a></li><li><a href=/tags/tlv>tlv (1)</a></li><li><a href=/tags/twisted>twisted (1)</a></li><li><a href=/tags/ucontext>ucontext (2)</a></li><li><a href=/tags/udp>udp (3)</a></li><li><a href=/tags/useless>useless (1)</a></li><li><a href=/tags/userscript>userscript (1)</a></li><li><a href=/tags/valgrind>valgrind (1)</a></li><li><a href=/tags/wait-free>wait-free (1)</a></li><li><a href=/tags/was>was (1)</a></li><li><a href=/tags/wisckey>wisckey (1)</a></li><li><a href=/tags/workflowy>workflowy (1)</a></li><li><a href=/tags/wsl>wsl (1)</a></li><li><a href=/tags/yunfile>yunfile (1)</a></li><li><a href=/tags/zeromq>zeromq (1)</a></li><li><a href=/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B>å¹¶å‘ç¼–ç¨‹ (1)</a></li><li><a href=/tags/%E7%B3%99%E5%BF%AB%E7%8C%9B>ç³™å¿«çŒ› (1)</a></li><li><a href=/tags/%E5%88%9B%E9%80%A0%E5%8A%9B>åˆ›é€ åŠ› (1)</a></li><li><a href=/tags/%E8%AF%BB%E4%B9%A6>è¯»ä¹¦ (2)</a></li><li><a href=/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B>å¤šçº¿ç¨‹ (2)</a></li><li><a href=/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F>åˆ†å¸ƒå¼ç³»ç»Ÿ (6)</a></li><li><a href=/tags/%E5%88%86%E7%B1%BB%E5%99%A8>åˆ†ç±»å™¨ (1)</a></li><li><a href=/tags/%E5%85%AC%E5%BC%80%E8%AF%BE>å…¬å¼€è¯¾ (4)</a></li><li><a href=/tags/%E8%AE%A1%E6%95%B0>è®¡æ•° (1)</a></li><li><a href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6>è®¡ç®—æœºç§‘å­¦ (1)</a></li><li><a href=/tags/%E9%93%BE%E8%A1%A8>é“¾è¡¨ (1)</a></li><li><a href=/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB>è®ºæ–‡é˜…è¯» (1)</a></li><li><a href=/tags/%E9%9D%A2%E8%AF%95>é¢è¯• (1)</a></li><li><a href=/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86>å®¹æ–¥åŸç† (1)</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F>è®¾è®¡æ¨¡å¼ (2)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E7%BC%96%E7%A0%81>æ•°æ®ç¼–ç  (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93>æ•°æ®åº“ (4)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E5%AF%86%E9%9B%86%E5%9E%8B%E5%BA%94%E7%94%A8%E7%B3%BB%E7%BB%9F>æ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿ (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B>æ•°æ®æ¨¡å‹ (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E7%B3%BB%E7%BB%9F>æ•°æ®ç³»ç»Ÿ (1)</a></li><li><a href=/tags/%E6%80%9D%E7%BB%B4>æ€ç»´ (1)</a></li><li><a href=/tags/%E7%AE%97%E6%B3%95>ç®—æ³• (14)</a></li><li><a href=/tags/%E7%B4%A2%E5%BC%95>ç´¢å¼• (1)</a></li><li><a href=/tags/%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84>ç´¢å¼•ç»“æ„ (1)</a></li><li><a href=/tags/%E9%A2%98%E8%A7%A3>é¢˜è§£ (11)</a></li><li><a href=/tags/%E9%97%B2%E8%81%8A>é—²èŠ (3)</a></li><li><a href=/tags/%E5%8D%8F%E7%A8%8B>åç¨‹ (1)</a></li><li><a href=/tags/%E5%8E%8B%E7%BC%A9>å‹ç¼© (1)</a></li><li><a href=/tags/%E4%B8%80%E8%87%B4%E6%80%A7>ä¸€è‡´æ€§ (3)</a></li><li><a href=/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6>ä¸»ä»å¤åˆ¶ (1)</a></li><li><a href=/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2>å­—ç¬¦ä¸² (1)</a></li><li><a href=/tags/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95>æœ€å°è¡¨ç¤ºæ³• (1)</a></li></ul></div></div></main><footer class=footer><div class=footer-row><a class=footer-item href=https://wizmann.top/posts/index.xml>Feed of Posts
<i class=icofont-rss></i></a></div></footer></body></html>