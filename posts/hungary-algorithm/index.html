<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>匈牙利算法 | Maerlyn's Rainbow</title>
<meta name=keywords content="algorithm"><meta name=description content="概念
交错路

交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。"><meta name=author content="wizmann"><link rel=canonical href=https://wizmann.top/posts/hungary-algorithm/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://wizmann.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wizmann.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wizmann.top/favicon-32x32.png><link rel=apple-touch-icon href=https://wizmann.top/apple-touch-icon.png><link rel=mask-icon href=https://wizmann.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://wizmann.top/posts/hungary-algorithm/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-2X5NE9PX0B"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2X5NE9PX0B")</script><meta property="og:url" content="https://wizmann.top/posts/hungary-algorithm/"><meta property="og:site_name" content="Maerlyn's Rainbow"><meta property="og:title" content="匈牙利算法"><meta property="og:description" content="概念 交错路 交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-01-01T22:01:00+00:00"><meta property="article:modified_time" content="2014-01-01T22:01:00+00:00"><meta property="article:tag" content="Algorithm"><meta name=twitter:card content="summary"><meta name=twitter:title content="匈牙利算法"><meta name=twitter:description content="概念
交错路

交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wizmann.top/posts/"},{"@type":"ListItem","position":2,"name":"匈牙利算法","item":"https://wizmann.top/posts/hungary-algorithm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"匈牙利算法","name":"匈牙利算法","description":"概念 交错路 交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。\n通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。\n","keywords":["algorithm"],"articleBody":"概念 交错路 交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。\n通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。\n注：交错路是无向图，图中的箭头只是为了便于观察。\n例如下图中的：(3) -\u003e (2) -\u003e (1)\n从端点扩张交错路 假设我们已经有一个红黑交错路P，其端点为A和B，其路径被标记为黑红。此时，我们向P中的一个端点（假设为A）加入一条边T。\n此时我们有边T + 交错路P（黑红）。当我们将边T标记为黑色时，我们就扩展了交错路P。 如果我们要保持红黑交错路的性质。则我们必须将边T标记为黑色。\n于是P（BR） =\u003e P'(BRB)\n分割交错路 易得，分割交错路不会改变它的性质。\n我们要红还是要黑 如果我们翻转红黑交错路的颜色，例如从RBR =\u003e BRB，则我们的交错路仍然保持原来的性质。\n所以翻转颜色是安全的。\n算法实现 匹配 匈牙利算法是用来求二分图最大匹配的算法。\n于是我们人为标记集合中的点为左集和右集。\n红色是种好颜色 由于红黑交错路可以安全的翻转颜色。所以我们保持交错路中红色路多于黑色路的性质也是安全的。\n因为我们要求出最大匹配，所以我们设完成匹配的边为红色。\n你可以证明你的算法吗 我们选取左集端点T到图中，此时图中有k条边与点T连接。这k条边分别为p1...pk。\n选 如 如 如 所 取 果 果 果 以 p 我 1 图 图 p 们 . 中 将 返 中 如 如 x 则 在 . 没 p 回 有 果 果 不 返 每 . 有 x t 交 存 回 一 p 交 标 r 错 p p 在 f 次 k 错 为 u 路 x 那 返 x 则 ： a 操 中 路 红 e ， 的 么 回 的 我 l 作 的 色 。 且 另 ， t 另 们 s 之 任 或 p 一 我 r 一 在 e 后 一 者 x 个 们 u 个 此 ， ， 条 的 端 可 e 端 端 会 边 图 端 点 以 点 点 洗 得 p 中 点 是 直 在 分 洗 到 x 有 在 交 接 交 割 睡 一 交 交 错 扩 错 交 了 个 错 错 路 展 路 错 返 路 路 的 交 的 路 回 但 中 头 错 中 ， 值 p ： / 路 间 将 。 x 尾 。 。 T 如 的 端 p 点 果 端 点 x 加 为 点 。 标 入 t 不 （ 为 某 r 在 重 红 一 u 交 申 色 交 e 错 ， 错 ， 路 交 路 则 中 错 。 匹 路 并 配 ： 是 且 数 无 选 + 向 取 1 的 此 。 ） 交 反 错 之 路 则 的 不 一 变 个 。 端 点 执 行 这 个 扩 展 操 作 p.s. 我觉得我的证明我自己都TMD看不懂。。。好挫败。。。\n代码 int n, m; //左集端点数，右集端点数 vector\u003cint\u003e g[SIZE]; // 边集 char inPath[SIZE]; // 是否在交错路中 int match[SIZE]; // 只存储黑色路径 int hungary() { int sum = 0; // 总数标为0 for (int i = 0; i \u003c n; i++) { memset(inPath, 0, sizeof(inPath)); // 新加入的点不在任何交错路中 sum += deal(i)? 1: 0; } return sum; } bool deal(int x) { // 遍历所有的边 for (int i = 0; i \u003c (int)g[x].size(); i++) { int next = g[x][i]; if (inPath[next]) continue; // 如果点在交错路中，pass inPath[next] = 1; // 如果找到一个不在交错路中的点，将其加入交错路，此轮算法结束 // 否则，分割交错路，从下一个点重新寻找扩展交错路的方法。 // 方法存在则更新。如果不存在，不更新。 if (match[next] == -1 || deal(match[next])) { match[next] = x; return true; } } return false; } 参考 byvoid: 匈牙利算法\nMatrix67: 二分图最大匹配的König定理及其证明\nwikipedia: 匈牙利算法\n","wordCount":"1105","inLanguage":"zh-cn","datePublished":"2014-01-01T22:01:00Z","dateModified":"2014-01-01T22:01:00Z","author":{"@type":"Person","name":"wizmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wizmann.top/posts/hungary-algorithm/"},"publisher":{"@type":"Organization","name":"Maerlyn's Rainbow","logo":{"@type":"ImageObject","url":"https://wizmann.top/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wizmann.top/ accesskey=h title="Maerlyn's Rainbow (Alt + H)">Maerlyn's Rainbow</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">匈牙利算法</h1><div class=post-meta><span title='2014-01-01 22:01:00 +0000 UTC'>January 1, 2014</span>&nbsp;·&nbsp;wizmann</div></header><div class=post-content><h2 id=概念>概念<a hidden class=anchor aria-hidden=true href=#概念>#</a></h2><h3 id=交错路>交错路<a hidden class=anchor aria-hidden=true href=#交错路>#</a></h3><blockquote><p>交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。</p></blockquote><p>通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路<strong>红黑交错</strong>。</p><p>注：交错路是无向图，图中的箭头只是为了便于观察。</p><p>例如下图中的：<code>(3) -> (2) -> (1)</code></p><p><img alt=图1 loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-1.png></p><h3 id=从端点扩张交错路>从端点扩张交错路<a hidden class=anchor aria-hidden=true href=#从端点扩张交错路>#</a></h3><p>假设我们已经有一个红黑交错路<code>P</code>，其端点为<code>A</code>和<code>B</code>，其路径被标记为<code>黑红</code>。此时，我们向<code>P</code>中的一个端点（假设为<code>A</code>）加入一条边<code>T</code>。</p><p>此时我们有<code>边T + 交错路P（黑红）</code>。当我们将边<code>T</code>标记为<code>黑色</code>时，我们就扩展了交错路<code>P</code>。
如果我们要保持红黑交错路的<strong>性质</strong>。则我们必须将边<code>T</code>标记为<code>黑色</code>。</p><p>于是<code>P（BR） => P'(BRB)</code></p><p><img alt=图2 loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-2.png></p><h3 id=分割交错路>分割交错路<a hidden class=anchor aria-hidden=true href=#分割交错路>#</a></h3><p>易得，分割交错路不会改变它的性质。</p><h3 id=我们要红还是要黑>我们要红还是要黑<a hidden class=anchor aria-hidden=true href=#我们要红还是要黑>#</a></h3><p>如果我们翻转红黑交错路的颜色，例如从<code>RBR => BRB</code>，则我们的交错路仍然<strong>保持原来的性质</strong>。</p><p>所以翻转颜色是安全的。</p><h2 id=算法实现>算法实现<a hidden class=anchor aria-hidden=true href=#算法实现>#</a></h2><h3 id=匹配>匹配<a hidden class=anchor aria-hidden=true href=#匹配>#</a></h3><p>匈牙利算法是用来求二分图最大匹配的算法。</p><p>于是我们人为标记集合中的点为<code>左集</code>和<code>右集</code>。</p><h3 id=红色是种好颜色>红色是种好颜色<a hidden class=anchor aria-hidden=true href=#红色是种好颜色>#</a></h3><p>由于<code>红黑交错路</code>可以安全的翻转颜色。所以我们保持交错路中<strong>红色路多于黑色路</strong>的性质也是安全的。</p><p>因为我们要求出最大匹配，所以我们设完成匹配的边为红色。</p><h3 id=你可以证明你的算法吗>你可以证明你的算法吗<a hidden class=anchor aria-hidden=true href=#你可以证明你的算法吗>#</a></h3><p>我们选取左集端点<code>T</code>到图中，此时图中有<code>k</code>条边与点<code>T</code>连接。这<code>k</code>条边分别为<code>p1...pk</code>。</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 432 281"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="0" y="36" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="212" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="260" fill="currentcolor" style="font-size:1em">所</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="8" y="36" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="212" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="24" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="116" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="164" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">没</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="40" y="116" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="164" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="212" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">每</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="48" y="212" fill="currentcolor" style="font-size:1em">存</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="56" y="116" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="164" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="212" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">次</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="64" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="64" y="116" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">那</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="64" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="64" y="212" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="72" y="52" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="72" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="72" y="100" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="72" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">么</text><text text-anchor="middle" x="72" y="148" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="72" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="180" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="72" y="228" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="72" y="260" fill="currentcolor" style="font-size:1em">作</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="80" y="68" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="80" y="100" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="80" y="116" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="80" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="80" y="164" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="180" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="80" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="80" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">任</text><text text-anchor="middle" x="88" y="36" fill="currentcolor" style="font-size:1em">或</text><text text-anchor="middle" x="88" y="100" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="88" y="116" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="88" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="88" y="164" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="180" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="88" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="88" y="260" fill="currentcolor" style="font-size:1em">后</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">者</text><text text-anchor="middle" x="96" y="100" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="96" y="116" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="132" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="96" y="148" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="96" y="164" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="96" y="228" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="96" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">条</text><text text-anchor="middle" x="104" y="100" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="104" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="132" fill="currentcolor" style="font-size:1em">可</text><text text-anchor="middle" x="104" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="104" y="164" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="260" fill="currentcolor" style="font-size:1em">会</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">边</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="112" y="100" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="112" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="132" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="112" y="164" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="112" y="260" fill="currentcolor" style="font-size:1em">得</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="120" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="120" y="100" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="120" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="120" y="132" fill="currentcolor" style="font-size:1em">直</text><text text-anchor="middle" x="120" y="164" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="120" y="180" fill="currentcolor" style="font-size:1em">分</text><text text-anchor="middle" x="120" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="120" y="260" fill="currentcolor" style="font-size:1em">到</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="128" y="100" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="132" fill="currentcolor" style="font-size:1em">接</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="180" fill="currentcolor" style="font-size:1em">割</text><text text-anchor="middle" x="128" y="228" fill="currentcolor" style="font-size:1em">睡</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="136" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="132" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="228" fill="currentcolor" style="font-size:1em">了</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="132" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="144" y="164" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="260" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="152" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="132" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="152" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="160" y="36" fill="currentcolor" style="font-size:1em">但</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">头</text><text text-anchor="middle" x="160" y="132" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="160" y="164" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="180" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">值</text><text text-anchor="middle" x="168" y="36" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="168" y="116" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="168" y="132" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="168" y="164" fill="currentcolor" style="font-size:1em">间</text><text text-anchor="middle" x="168" y="180" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="36" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="176" y="116" fill="currentcolor" style="font-size:1em">尾</text><text text-anchor="middle" x="176" y="132" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="164" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="180" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="184" y="36" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="184" y="132" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="184" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="192" y="36" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="192" y="180" fill="currentcolor" style="font-size:1em">加</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="200" y="36" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="200" y="132" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="200" y="180" fill="currentcolor" style="font-size:1em">入</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="208" y="36" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">（</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="208" y="180" fill="currentcolor" style="font-size:1em">某</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="216" y="36" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">重</text><text text-anchor="middle" x="216" y="132" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="216" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="224" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">申</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="232" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="232" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="240" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="240" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="248" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="248" y="180" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">匹</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="256" y="180" fill="currentcolor" style="font-size:1em">并</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">配</text><text text-anchor="middle" x="264" y="36" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="264" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="264" y="180" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">数</text><text text-anchor="middle" x="272" y="116" fill="currentcolor" style="font-size:1em">无</text><text text-anchor="middle" x="272" y="180" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="272" y="260" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="280" y="116" fill="currentcolor" style="font-size:1em">向</text><text text-anchor="middle" x="280" y="180" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="280" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="288" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="288" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">）</text><text text-anchor="middle" x="296" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="296" y="260" fill="currentcolor" style="font-size:1em">反</text><text text-anchor="middle" x="304" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="304" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="312" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="312" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="320" y="180" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="328" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="328" y="260" fill="currentcolor" style="font-size:1em">变</text><text text-anchor="middle" x="336" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="336" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="344" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="352" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="360" y="180" fill="currentcolor" style="font-size:1em">执</text><text text-anchor="middle" x="368" y="180" fill="currentcolor" style="font-size:1em">行</text><text text-anchor="middle" x="376" y="180" fill="currentcolor" style="font-size:1em">这</text><text text-anchor="middle" x="384" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="392" y="180" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="400" y="180" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="408" y="180" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="416" y="180" fill="currentcolor" style="font-size:1em">作</text></g></svg></div><p>p.s. 我觉得我的证明我自己都TMD看不懂。。。好挫败。。。</p><h2 id=代码>代码<a hidden class=anchor aria-hidden=true href=#代码>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> n, m; <span style=color:#75715e>//左集端点数，右集端点数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> g[SIZE]; <span style=color:#75715e>// 边集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>char</span> inPath[SIZE]; <span style=color:#75715e>// 是否在交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> match[SIZE]; <span style=color:#75715e>// 只存储黑色路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>hungary</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 总数标为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        memset(inPath, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>sizeof</span>(inPath)); <span style=color:#75715e>// 新加入的点不在任何交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        sum <span style=color:#f92672>+=</span> deal(i)<span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>deal</span>(<span style=color:#66d9ef>int</span> x)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 遍历所有的边
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> (<span style=color:#66d9ef>int</span>)g[x].size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> next <span style=color:#f92672>=</span> g[x][i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (inPath[next]) <span style=color:#66d9ef>continue</span>; <span style=color:#75715e>// 如果点在交错路中，pass
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        inPath[next] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 如果找到一个不在交错路中的点，将其加入交错路，此轮算法结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 否则，分割交错路，从下一个点重新寻找扩展交错路的方法。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 方法存在则更新。如果不存在，不更新。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (match[next] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> deal(match[next])) {
</span></span><span style=display:flex><span>            match[next] <span style=color:#f92672>=</span> x;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><p>byvoid: <a href=https://www.byvoid.com/blog/hungary>匈牙利算法</a></p><p>Matrix67: <a href=http://www.matrix67.com/blog/archives/116>二分图最大匹配的König定理及其证明</a></p><p>wikipedia: <a href=http://zh.wikipedia.org/wiki/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95>匈牙利算法</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wizmann.top/tags/algorithm/>Algorithm</a></li></ul><nav class=paginav><a class=prev href=https://wizmann.top/posts/read-head-first-design-pattern/><span class=title>«</span><br><span>读书 - 《Head first 设计模式》</span>
</a><a class=next href=https://wizmann.top/posts/cf-3c-tic-tac-toe/><span class=title>»</span><br><span>Codeforces 3C - Tic-tac-toe</span></a></nav></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://wizmann.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2025 <a href=https://wizmann.top/>Maerlyn's Rainbow</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>