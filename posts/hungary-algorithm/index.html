<!doctype html><html lang=zh-CN dir=ltr><head><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}}</script><script defer src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class=notransition><div id=container><header id=main-header><div role=navigation aria-label=Main><div class=nav-left><a href=https://wizmann.top/ style=color:inherit>Maerlyn's Rainbow</a></div><div class=nav-right><div style=position:absolute;width:0;height:0><div id=nav-dropdown-menu class=hidden href=#><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div></div></div><a id=nav-dropdown-button href=#><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div id=nav-menu><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div></div><a id=theme-switcher href=#><svg class="light-icon" viewBox="0 0 24 24" fill="none"><path d="M12 3V4m0 16v1M4 12H3M6.31412 6.31412 5.5 5.5m12.1859.81412L18.5 5.5M6.31412 17.69 5.5 18.5001M17.6859 17.69 18.5 18.5001M21 12H20m-4 0c0 2.2091-1.7909 4-4 4-2.20914.0-4-1.7909-4-4 0-2.20914 1.79086-4 4-4 2.2091.0 4 1.79086 4 4z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><svg class="dark-icon" viewBox="0 0 24 24" fill="none"><path d="M3.32031 11.6835c0 4.9706 4.02944 9 8.99999 9 3.7872.0 7.028-2.3392 8.3565-5.6515C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834c-4.9706.0-8.99999-4.0294-8.99999-8.99998C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996 5.65605 4.66028 3.32031 7.89912 3.32031 11.6835z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a></div></div></header><div class="flex grow"><div id=main-pane><main id=main-content><div class=single-header><ol class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://wizmann.top/><span itemprop=name></span>
</a><meta itemprop=position content='1'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://wizmann.top/posts/><span itemprop=name>Posts</span>
</a><meta itemprop=position content='2'></li><span>&nbsp»&nbsp</span></ol><h1>匈牙利算法</h1><time class=dim datetime=2014-01-01T22:01:00+00:00>January 1, 2014</time><div class=term-container><div class=tag><a href=https://wizmann.top/tags/algorithm/>#algorithm</a></div></ol></div><section class=page-section><h2 id=概念>概念</h2><h3 id=交错路>交错路</h3><blockquote><p>交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。</p></blockquote><p>通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路<strong>红黑交错</strong>。</p><p>注：交错路是无向图，图中的箭头只是为了便于观察。</p><p>例如下图中的：<code>(3) -> (2) -> (1)</code></p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-1.png alt=图1></p><h3 id=从端点扩张交错路>从端点扩张交错路</h3><p>假设我们已经有一个红黑交错路<code>P</code>，其端点为<code>A</code>和<code>B</code>，其路径被标记为<code>黑红</code>。此时，我们向<code>P</code>中的一个端点（假设为<code>A</code>）加入一条边<code>T</code>。</p><p>此时我们有<code>边T + 交错路P（黑红）</code>。当我们将边<code>T</code>标记为<code>黑色</code>时，我们就扩展了交错路<code>P</code>。
如果我们要保持红黑交错路的<strong>性质</strong>。则我们必须将边<code>T</code>标记为<code>黑色</code>。</p><p>于是<code>P（BR） => P'(BRB)</code></p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-2.png alt=图2></p><h3 id=分割交错路>分割交错路</h3><p>易得，分割交错路不会改变它的性质。</p><h3 id=我们要红还是要黑>我们要红还是要黑</h3><p>如果我们翻转红黑交错路的颜色，例如从<code>RBR => BRB</code>，则我们的交错路仍然<strong>保持原来的性质</strong>。</p><p>所以翻转颜色是安全的。</p><h2 id=算法实现>算法实现</h2><h3 id=匹配>匹配</h3><p>匈牙利算法是用来求二分图最大匹配的算法。</p><p>于是我们人为标记集合中的点为<code>左集</code>和<code>右集</code>。</p><h3 id=红色是种好颜色>红色是种好颜色</h3><p>由于<code>红黑交错路</code>可以安全的翻转颜色。所以我们保持交错路中<strong>红色路多于黑色路</strong>的性质也是安全的。</p><p>因为我们要求出最大匹配，所以我们设完成匹配的边为红色。</p><h3 id=你可以证明你的算法吗>你可以证明你的算法吗</h3><p>我们选取左集端点<code>T</code>到图中，此时图中有<code>k</code>条边与点<code>T</code>连接。这<code>k</code>条边分别为<code>p1...pk</code>。</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 432 281"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="0" y="36" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="212" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="260" fill="currentcolor" style="font-size:1em">所</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="8" y="36" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="212" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="24" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="116" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="164" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">没</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="40" y="116" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="164" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="212" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">每</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="48" y="212" fill="currentcolor" style="font-size:1em">存</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="56" y="116" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="164" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="212" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">次</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="64" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="64" y="116" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">那</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="64" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="64" y="212" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="72" y="52" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="72" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="72" y="100" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="72" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">么</text><text text-anchor="middle" x="72" y="148" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="72" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="180" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="72" y="228" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="72" y="260" fill="currentcolor" style="font-size:1em">作</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="80" y="68" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="80" y="100" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="80" y="116" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="80" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="80" y="164" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="180" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="80" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="80" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">任</text><text text-anchor="middle" x="88" y="36" fill="currentcolor" style="font-size:1em">或</text><text text-anchor="middle" x="88" y="100" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="88" y="116" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="88" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="88" y="164" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="180" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="88" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="88" y="260" fill="currentcolor" style="font-size:1em">后</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">者</text><text text-anchor="middle" x="96" y="100" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="96" y="116" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="132" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="96" y="148" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="96" y="164" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="96" y="228" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="96" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">条</text><text text-anchor="middle" x="104" y="100" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="104" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="132" fill="currentcolor" style="font-size:1em">可</text><text text-anchor="middle" x="104" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="104" y="164" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="260" fill="currentcolor" style="font-size:1em">会</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">边</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="112" y="100" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="112" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="132" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="112" y="164" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="112" y="260" fill="currentcolor" style="font-size:1em">得</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="120" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="120" y="100" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="120" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="120" y="132" fill="currentcolor" style="font-size:1em">直</text><text text-anchor="middle" x="120" y="164" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="120" y="180" fill="currentcolor" style="font-size:1em">分</text><text text-anchor="middle" x="120" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="120" y="260" fill="currentcolor" style="font-size:1em">到</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="128" y="100" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="132" fill="currentcolor" style="font-size:1em">接</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="180" fill="currentcolor" style="font-size:1em">割</text><text text-anchor="middle" x="128" y="228" fill="currentcolor" style="font-size:1em">睡</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="136" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="132" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="228" fill="currentcolor" style="font-size:1em">了</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="132" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="144" y="164" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="260" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="152" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="132" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="152" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="160" y="36" fill="currentcolor" style="font-size:1em">但</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">头</text><text text-anchor="middle" x="160" y="132" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="160" y="164" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="180" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">值</text><text text-anchor="middle" x="168" y="36" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="168" y="116" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="168" y="132" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="168" y="164" fill="currentcolor" style="font-size:1em">间</text><text text-anchor="middle" x="168" y="180" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="36" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="176" y="116" fill="currentcolor" style="font-size:1em">尾</text><text text-anchor="middle" x="176" y="132" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="164" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="180" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="184" y="36" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="184" y="132" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="184" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="192" y="36" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="192" y="180" fill="currentcolor" style="font-size:1em">加</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="200" y="36" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="200" y="132" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="200" y="180" fill="currentcolor" style="font-size:1em">入</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="208" y="36" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">（</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="208" y="180" fill="currentcolor" style="font-size:1em">某</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="216" y="36" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">重</text><text text-anchor="middle" x="216" y="132" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="216" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="224" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">申</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="232" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="232" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="240" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="240" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="248" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="248" y="180" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">匹</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="256" y="180" fill="currentcolor" style="font-size:1em">并</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">配</text><text text-anchor="middle" x="264" y="36" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="264" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="264" y="180" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">数</text><text text-anchor="middle" x="272" y="116" fill="currentcolor" style="font-size:1em">无</text><text text-anchor="middle" x="272" y="180" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="272" y="260" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="280" y="116" fill="currentcolor" style="font-size:1em">向</text><text text-anchor="middle" x="280" y="180" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="280" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="288" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="288" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">）</text><text text-anchor="middle" x="296" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="296" y="260" fill="currentcolor" style="font-size:1em">反</text><text text-anchor="middle" x="304" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="304" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="312" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="312" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="320" y="180" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="328" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="328" y="260" fill="currentcolor" style="font-size:1em">变</text><text text-anchor="middle" x="336" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="336" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="344" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="352" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="360" y="180" fill="currentcolor" style="font-size:1em">执</text><text text-anchor="middle" x="368" y="180" fill="currentcolor" style="font-size:1em">行</text><text text-anchor="middle" x="376" y="180" fill="currentcolor" style="font-size:1em">这</text><text text-anchor="middle" x="384" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="392" y="180" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="400" y="180" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="408" y="180" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="416" y="180" fill="currentcolor" style="font-size:1em">作</text></g></svg></div><p>p.s. 我觉得我的证明我自己都TMD看不懂。。。好挫败。。。</p><h2 id=代码>代码</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> n, m; <span style=color:#75715e>//左集端点数，右集端点数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> g[SIZE]; <span style=color:#75715e>// 边集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>char</span> inPath[SIZE]; <span style=color:#75715e>// 是否在交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> match[SIZE]; <span style=color:#75715e>// 只存储黑色路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>hungary</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 总数标为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        memset(inPath, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>sizeof</span>(inPath)); <span style=color:#75715e>// 新加入的点不在任何交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        sum <span style=color:#f92672>+=</span> deal(i)<span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>deal</span>(<span style=color:#66d9ef>int</span> x)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 遍历所有的边
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> (<span style=color:#66d9ef>int</span>)g[x].size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> next <span style=color:#f92672>=</span> g[x][i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (inPath[next]) <span style=color:#66d9ef>continue</span>; <span style=color:#75715e>// 如果点在交错路中，pass
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        inPath[next] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 如果找到一个不在交错路中的点，将其加入交错路，此轮算法结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 否则，分割交错路，从下一个点重新寻找扩展交错路的方法。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 方法存在则更新。如果不存在，不更新。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (match[next] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> deal(match[next])) {
</span></span><span style=display:flex><span>            match[next] <span style=color:#f92672>=</span> x;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=参考>参考</h2><p>byvoid: <a href=https://www.byvoid.com/blog/hungary>匈牙利算法</a></p><p>Matrix67: <a href=http://www.matrix67.com/blog/archives/116>二分图最大匹配的König定理及其证明</a></p><p>wikipedia: <a href=http://zh.wikipedia.org/wiki/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95>匈牙利算法</a></p></section></main><footer id=main-footer><div class=footer><a href=#></a><div class=footer-copyright><div class=dim>© 2025</div><div></div></div></div></footer></div><aside id=side-pane class=side-sticky><div class=side-details><span>1105 </span><span>3 - 4</span></div><h3></h3><nav id=TableOfContents><ul><li><a href=#概念>概念</a><ul><li><a href=#交错路>交错路</a></li><li><a href=#从端点扩张交错路>从端点扩张交错路</a></li><li><a href=#分割交错路>分割交错路</a></li><li><a href=#我们要红还是要黑>我们要红还是要黑</a></li></ul></li><li><a href=#算法实现>算法实现</a><ul><li><a href=#匹配>匹配</a></li><li><a href=#红色是种好颜色>红色是种好颜色</a></li><li><a href=#你可以证明你的算法吗>你可以证明你的算法吗</a></li></ul></li><li><a href=#代码>代码</a></li><li><a href=#参考>参考</a></li></ul></nav><h3></h3><ul><li><a href=/posts/cf-3c-tic-tac-toe/>Codeforces 3C - Tic-tac-toe</a></li><li><a href=/posts/how-to-rotate-image-leetcode/>How to "Rotate Image"?</a></li><li><a href=/posts/cf-221-div-2/>Codeforces Round #221 (Div. 2)不完全不正确题解</a></li><li><a href=/posts/cf-218-div-2/>Codeforces Round #218 (Div. 2)不完全不正确题解</a></li><li><a href=/posts/cf-215-div-2/>Codeforces Round #215 (Div. 2)不完全不正确题解</a></li></ul></aside></div></div></body></html>