<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=Content-Security-Policy content="script-src 'self'; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'none'"><link rel=stylesheet href=/css/style.feedcd92d05c2cf19ee7487656b358ee4805f831b7b39711851199d0a6f8934cf9ba379d02425d485c5b65ae299bdffda3770739545d595074076bf3ead284ab.css media=screen integrity="sha512-/u3NktBcLPGe50h2VrNY7kgF+DG3s5cRhRGZ0Kb4k0z5ujedAkJdSFxbZa4pm9/9o3cHOVRdWVB0B2vz6tKEqw==" crossorigin=anonymous><title>匈牙利算法</title>
<meta name=description content="概念 交错路 交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。
"><link rel=canonical href=https://wizmann.top/posts/hungary-algorithm/><link rel=alternate hreflang=zh-CN href=https://wizmann.top/posts/hungary-algorithm/><link rel=alternate hreflang=x-default href=https://wizmann.top/posts/hungary-algorithm/><meta property="og:title" content="匈牙利算法"><meta property="og:description" content="概念
交错路

交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。"><meta property="og:type" content="article"><meta property="og:url" content="https://wizmann.top/posts/hungary-algorithm/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-01-01T22:01:00+00:00"><meta property="article:modified_time" content="2014-01-01T22:01:00+00:00"><meta property="og:site_name" content="Maerlyn's Rainbow"><meta name=twitter:card content="summary"><meta name=twitter:title content="匈牙利算法"><meta name=twitter:description content="概念
交错路

交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。
通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"匈牙利算法","datePublished":"2014-01-01T22:01:00+00:00","dateModified":"2014-01-01T22:01:00+00:00","mainEntityOfPage":"https://wizmann.top/","publisher":{"@type":"Organization","name":"Maerlyn's Rainbow"},"wordcount":1105,"description":"概念 交错路 交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。\n通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路红黑交错。\n","keywords":null}</script></head><body class="posts single d-flex flex-column min-vh-100"><header class=main-header><nav class="navbar navbar-expand-lg"><div class=container><a class=navbar-brand href=/>Maerlyn's Rainbow
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="menu-main navbar-nav me-auto mb-2 mb-lg-0"></ul></div></div></nav></header><div id=content><div class="container py-3"><h2 id=概念>概念</h2><h3 id=交错路>交错路</h3><blockquote><p>交错路：设P是图G的一条路，如果P的任意两条相邻的边一定是一条属于M而另一条不属于M，就称P是一条交错路。</p></blockquote><p>通俗点来说，就是把一个图中的路径染成红黑两种。然后找出一条路，使这条路<strong>红黑交错</strong>。</p><p>注：交错路是无向图，图中的箭头只是为了便于观察。</p><p>例如下图中的：<code>(3) -> (2) -> (1)</code></p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-1.png alt=图1></p><h3 id=从端点扩张交错路>从端点扩张交错路</h3><p>假设我们已经有一个红黑交错路<code>P</code>，其端点为<code>A</code>和<code>B</code>，其路径被标记为<code>黑红</code>。此时，我们向<code>P</code>中的一个端点（假设为<code>A</code>）加入一条边<code>T</code>。</p><p>此时我们有<code>边T + 交错路P（黑红）</code>。当我们将边<code>T</code>标记为<code>黑色</code>时，我们就扩展了交错路<code>P</code>。
如果我们要保持红黑交错路的<strong>性质</strong>。则我们必须将边<code>T</code>标记为<code>黑色</code>。</p><p>于是<code>P（BR） => P'(BRB)</code></p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-hungary-2.png alt=图2></p><h3 id=分割交错路>分割交错路</h3><p>易得，分割交错路不会改变它的性质。</p><h3 id=我们要红还是要黑>我们要红还是要黑</h3><p>如果我们翻转红黑交错路的颜色，例如从<code>RBR => BRB</code>，则我们的交错路仍然<strong>保持原来的性质</strong>。</p><p>所以翻转颜色是安全的。</p><h2 id=算法实现>算法实现</h2><h3 id=匹配>匹配</h3><p>匈牙利算法是用来求二分图最大匹配的算法。</p><p>于是我们人为标记集合中的点为<code>左集</code>和<code>右集</code>。</p><h3 id=红色是种好颜色>红色是种好颜色</h3><p>由于<code>红黑交错路</code>可以安全的翻转颜色。所以我们保持交错路中<strong>红色路多于黑色路</strong>的性质也是安全的。</p><p>因为我们要求出最大匹配，所以我们设完成匹配的边为红色。</p><h3 id=你可以证明你的算法吗>你可以证明你的算法吗</h3><p>我们选取左集端点<code>T</code>到图中，此时图中有<code>k</code>条边与点<code>T</code>连接。这<code>k</code>条边分别为<code>p1...pk</code>。</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 432 281"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="0" y="36" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="212" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="0" y="260" fill="currentcolor" style="font-size:1em">所</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="8" y="36" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="212" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="24" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="24" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="32" y="116" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="164" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="32" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">没</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="40" y="116" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="164" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="40" y="212" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">每</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="48" y="212" fill="currentcolor" style="font-size:1em">存</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="56" y="116" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="164" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="56" y="212" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">次</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="64" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="64" y="116" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">那</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="64" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="64" y="212" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="72" y="52" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="72" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="72" y="100" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="72" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">么</text><text text-anchor="middle" x="72" y="148" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="72" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="72" y="180" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="72" y="228" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="72" y="260" fill="currentcolor" style="font-size:1em">作</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="80" y="68" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="80" y="100" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="80" y="116" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="80" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="80" y="164" fill="currentcolor" style="font-size:1em">另</text><text text-anchor="middle" x="80" y="180" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="80" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="80" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">任</text><text text-anchor="middle" x="88" y="36" fill="currentcolor" style="font-size:1em">或</text><text text-anchor="middle" x="88" y="100" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="88" y="116" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">我</text><text text-anchor="middle" x="88" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="88" y="164" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="88" y="180" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="88" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="88" y="260" fill="currentcolor" style="font-size:1em">后</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">者</text><text text-anchor="middle" x="96" y="100" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="96" y="116" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="132" fill="currentcolor" style="font-size:1em">们</text><text text-anchor="middle" x="96" y="148" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="96" y="164" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="96" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="96" y="228" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="96" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">条</text><text text-anchor="middle" x="104" y="100" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="104" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="132" fill="currentcolor" style="font-size:1em">可</text><text text-anchor="middle" x="104" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="104" y="164" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="104" y="260" fill="currentcolor" style="font-size:1em">会</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">边</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">图</text><text text-anchor="middle" x="112" y="100" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="112" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="132" fill="currentcolor" style="font-size:1em">以</text><text text-anchor="middle" x="112" y="164" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="112" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="112" y="260" fill="currentcolor" style="font-size:1em">得</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="120" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="120" y="100" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="120" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="120" y="132" fill="currentcolor" style="font-size:1em">直</text><text text-anchor="middle" x="120" y="164" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="120" y="180" fill="currentcolor" style="font-size:1em">分</text><text text-anchor="middle" x="120" y="228" fill="currentcolor" style="font-size:1em">洗</text><text text-anchor="middle" x="120" y="260" fill="currentcolor" style="font-size:1em">到</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">有</text><text text-anchor="middle" x="128" y="100" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="132" fill="currentcolor" style="font-size:1em">接</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="128" y="180" fill="currentcolor" style="font-size:1em">割</text><text text-anchor="middle" x="128" y="228" fill="currentcolor" style="font-size:1em">睡</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="136" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="100" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="132" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="136" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="136" y="228" fill="currentcolor" style="font-size:1em">了</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="132" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="144" y="164" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="144" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="144" y="260" fill="currentcolor" style="font-size:1em">返</text><text text-anchor="middle" x="152" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="132" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="152" y="164" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="152" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">回</text><text text-anchor="middle" x="160" y="36" fill="currentcolor" style="font-size:1em">但</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">头</text><text text-anchor="middle" x="160" y="132" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="160" y="164" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="160" y="180" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">值</text><text text-anchor="middle" x="168" y="36" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="168" y="116" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="168" y="132" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="168" y="164" fill="currentcolor" style="font-size:1em">间</text><text text-anchor="middle" x="168" y="180" fill="currentcolor" style="font-size:1em">将</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="36" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="176" y="116" fill="currentcolor" style="font-size:1em">尾</text><text text-anchor="middle" x="176" y="132" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="164" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="176" y="180" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">如</text><text text-anchor="middle" x="184" y="36" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="184" y="132" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="184" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">果</text><text text-anchor="middle" x="192" y="36" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="192" y="180" fill="currentcolor" style="font-size:1em">加</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="200" y="36" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="200" y="132" fill="currentcolor" style="font-size:1em">标</text><text text-anchor="middle" x="200" y="180" fill="currentcolor" style="font-size:1em">入</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="208" y="36" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">（</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">为</text><text text-anchor="middle" x="208" y="180" fill="currentcolor" style="font-size:1em">某</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="216" y="36" fill="currentcolor" style="font-size:1em">在</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">重</text><text text-anchor="middle" x="216" y="132" fill="currentcolor" style="font-size:1em">红</text><text text-anchor="middle" x="216" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="224" y="36" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">申</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">色</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="232" y="36" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="232" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">，</text><text text-anchor="middle" x="240" y="36" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="240" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="248" y="36" fill="currentcolor" style="font-size:1em">中</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="248" y="180" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">匹</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="256" y="180" fill="currentcolor" style="font-size:1em">并</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">配</text><text text-anchor="middle" x="264" y="36" fill="currentcolor" style="font-size:1em">：</text><text text-anchor="middle" x="264" y="116" fill="currentcolor" style="font-size:1em">是</text><text text-anchor="middle" x="264" y="180" fill="currentcolor" style="font-size:1em">且</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">数</text><text text-anchor="middle" x="272" y="116" fill="currentcolor" style="font-size:1em">无</text><text text-anchor="middle" x="272" y="180" fill="currentcolor" style="font-size:1em">选</text><text text-anchor="middle" x="272" y="260" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="280" y="116" fill="currentcolor" style="font-size:1em">向</text><text text-anchor="middle" x="280" y="180" fill="currentcolor" style="font-size:1em">取</text><text text-anchor="middle" x="280" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="288" y="180" fill="currentcolor" style="font-size:1em">此</text><text text-anchor="middle" x="288" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">）</text><text text-anchor="middle" x="296" y="180" fill="currentcolor" style="font-size:1em">交</text><text text-anchor="middle" x="296" y="260" fill="currentcolor" style="font-size:1em">反</text><text text-anchor="middle" x="304" y="180" fill="currentcolor" style="font-size:1em">错</text><text text-anchor="middle" x="304" y="260" fill="currentcolor" style="font-size:1em">之</text><text text-anchor="middle" x="312" y="180" fill="currentcolor" style="font-size:1em">路</text><text text-anchor="middle" x="312" y="260" fill="currentcolor" style="font-size:1em">则</text><text text-anchor="middle" x="320" y="180" fill="currentcolor" style="font-size:1em">的</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">不</text><text text-anchor="middle" x="328" y="180" fill="currentcolor" style="font-size:1em">一</text><text text-anchor="middle" x="328" y="260" fill="currentcolor" style="font-size:1em">变</text><text text-anchor="middle" x="336" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="336" y="260" fill="currentcolor" style="font-size:1em">。</text><text text-anchor="middle" x="344" y="180" fill="currentcolor" style="font-size:1em">端</text><text text-anchor="middle" x="352" y="180" fill="currentcolor" style="font-size:1em">点</text><text text-anchor="middle" x="360" y="180" fill="currentcolor" style="font-size:1em">执</text><text text-anchor="middle" x="368" y="180" fill="currentcolor" style="font-size:1em">行</text><text text-anchor="middle" x="376" y="180" fill="currentcolor" style="font-size:1em">这</text><text text-anchor="middle" x="384" y="180" fill="currentcolor" style="font-size:1em">个</text><text text-anchor="middle" x="392" y="180" fill="currentcolor" style="font-size:1em">扩</text><text text-anchor="middle" x="400" y="180" fill="currentcolor" style="font-size:1em">展</text><text text-anchor="middle" x="408" y="180" fill="currentcolor" style="font-size:1em">操</text><text text-anchor="middle" x="416" y="180" fill="currentcolor" style="font-size:1em">作</text></g></svg></div><p>p.s. 我觉得我的证明我自己都TMD看不懂。。。好挫败。。。</p><h2 id=代码>代码</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> n, m; <span style=color:#75715e>//左集端点数，右集端点数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> g[SIZE]; <span style=color:#75715e>// 边集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>char</span> inPath[SIZE]; <span style=color:#75715e>// 是否在交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> match[SIZE]; <span style=color:#75715e>// 只存储黑色路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>hungary</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 总数标为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        memset(inPath, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>sizeof</span>(inPath)); <span style=color:#75715e>// 新加入的点不在任何交错路中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        sum <span style=color:#f92672>+=</span> deal(i)<span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>deal</span>(<span style=color:#66d9ef>int</span> x)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 遍历所有的边
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> (<span style=color:#66d9ef>int</span>)g[x].size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> next <span style=color:#f92672>=</span> g[x][i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (inPath[next]) <span style=color:#66d9ef>continue</span>; <span style=color:#75715e>// 如果点在交错路中，pass
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        inPath[next] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 如果找到一个不在交错路中的点，将其加入交错路，此轮算法结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 否则，分割交错路，从下一个点重新寻找扩展交错路的方法。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 方法存在则更新。如果不存在，不更新。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (match[next] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> deal(match[next])) {
</span></span><span style=display:flex><span>            match[next] <span style=color:#f92672>=</span> x;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=参考>参考</h2><p>byvoid: <a href=https://www.byvoid.com/blog/hungary target=_blank rel=noopener>匈牙利算法</a></p><p>Matrix67: <a href=http://www.matrix67.com/blog/archives/116 target=_blank rel=noopener>二分图最大匹配的König定理及其证明</a></p><p>wikipedia: <a href=http://zh.wikipedia.org/wiki/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95 target=_blank rel=noopener>匈牙利算法</a></p></div></div><footer class="py-3 mt-auto bg-light"><div class="container py-1 my-1"><div class="d-flex flex-wrap justify-content-between align-items-center"><p class="col-md mb-0 text-muted"></p><ul class="nav col-md-auto justify-content-end"></ul></div></div></footer><script src=/js/main.min.e8d88c82c0438b527f1aca4115652ba1e2877bf805b75593b23ac0e3fe2b3fe95a467d1feef275355132ba061da6404b0d24d55afabc209b294b1db043be014d.js integrity="sha512-6NiMgsBDi1J/GspBFWUroeKHe/gFt1WTsjrA4/4rP+laRn0f7vJ1NVEyugYdpkBLDSTVWvq8IJspSx2wQ74BTQ==" crossorigin=anonymous defer></script></body></html>