<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to implement a queue with stack(s)? | Maerlyn's Rainbow</title>
<meta name=keywords content="algorithm,stack,queue"><meta name=description content="This problem is from the book Algorithms, 4th Edition.

Queue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.
Warning : high degree of difficulty.
When I search the Internet to find a solution, I find varieties of this problem, such as &ldquo;implement a queue with ONE stack&rdquo;, &ldquo;implement a queue with TWO stack&rdquo;, etc.
It is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let&rsquo;s rock."><meta name=author content="wizmann"><link rel=canonical href=https://wizmann.top/posts/implement-queue-with-stacks/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://wizmann.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wizmann.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wizmann.top/favicon-32x32.png><link rel=apple-touch-icon href=https://wizmann.top/apple-touch-icon.png><link rel=mask-icon href=https://wizmann.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://wizmann.top/posts/implement-queue-with-stacks/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-2X5NE9PX0B"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2X5NE9PX0B")</script><meta property="og:url" content="https://wizmann.top/posts/implement-queue-with-stacks/"><meta property="og:site_name" content="Maerlyn's Rainbow"><meta property="og:title" content="How to implement a queue with stack(s)?"><meta property="og:description" content="This problem is from the book Algorithms, 4th Edition.
Queue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.
Warning : high degree of difficulty.
When I search the Internet to find a solution, I find varieties of this problem, such as “implement a queue with ONE stack”, “implement a queue with TWO stack”, etc.
It is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let’s rock."><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-05-20T13:23:03+00:00"><meta property="article:modified_time" content="2014-05-20T13:23:03+00:00"><meta property="article:tag" content="Algorithm"><meta property="article:tag" content="Stack"><meta property="article:tag" content="Queue"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to implement a queue with stack(s)?"><meta name=twitter:description content="This problem is from the book Algorithms, 4th Edition.

Queue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.
Warning : high degree of difficulty.
When I search the Internet to find a solution, I find varieties of this problem, such as &ldquo;implement a queue with ONE stack&rdquo;, &ldquo;implement a queue with TWO stack&rdquo;, etc.
It is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let&rsquo;s rock."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wizmann.top/posts/"},{"@type":"ListItem","position":2,"name":"How to implement a queue with stack(s)?","item":"https://wizmann.top/posts/implement-queue-with-stacks/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to implement a queue with stack(s)?","name":"How to implement a queue with stack(s)?","description":"This problem is from the book Algorithms, 4th Edition.\nQueue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.\nWarning : high degree of difficulty.\nWhen I search the Internet to find a solution, I find varieties of this problem, such as \u0026ldquo;implement a queue with ONE stack\u0026rdquo;, \u0026ldquo;implement a queue with TWO stack\u0026rdquo;, etc.\nIt is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let\u0026rsquo;s rock.\n","keywords":["algorithm","stack","queue"],"articleBody":"This problem is from the book Algorithms, 4th Edition.\nQueue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.\nWarning : high degree of difficulty.\nWhen I search the Internet to find a solution, I find varieties of this problem, such as “implement a queue with ONE stack”, “implement a queue with TWO stack”, etc.\nIt is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let’s rock.\nBuild a test environment I choose python as a programming language.\nSo firstly, I implement an ABstract Class(ABC) of a queue as the template of all classes of queue, called QueueTpl.\nimport abc class QueueTpl(object): __metaclass__ = abc.ABCMeta @abc.abstractmethod def __init__(self): pass @abc.abstractmethod def clear(self): pass @abc.abstractmethod def push(self, value): pass @abc.abstractmethod def pop(self, value): pass Secondly, I write an Adapter for Queue.Queue() class of python, called QueueAdapter, to make it returns None when we get items from an empty instance. And we use put_nowait and get_nowait to speed up because there’s no need to get the guarantee of thread safe.\nimport Queue class QueueAdapter(QueueTpl): def __init__(self): self.clear() def clear(self): self.q = Queue.Queue() def push(self, value): self.q.put_nowait(value) def pop(self): if self.q.empty(): return None return self.q.get_nowait() At last, use python unittest to verify my solution.\nclass TestStQueue(unittest.TestCase): def test_push_and_pop(self): sq = QueueAdapter() sq.push(1) self.assertEqual(sq.pop(), 1) self.assertFalse(sq.pop()) for i in xrange(10): sq.push(i) for i in xrange(10): self.assertEqual(sq.pop(), i) self.assertFalse(sq.pop()) def get_rand_command(self): cmd = random.choice(['push', 'pop']) value = random.randint(0, 1 \u003c\u003c 31) return cmd, value def test_brute_force(self): step = 10000 qs = [QueueAdapter(), StQueue3(), StQueue2(), StQueue1()] for i in xrange(step): a, b = self.get_rand_command() if a == 'push': map(lambda q: q.push(b), qs) else: rs = map(lambda q: q.pop(), qs) self.assertTrue(all(x == rs[0] for x in rs)) Implement a queue with ONE stack It’s said that it’s an interview problem of Microsoft.(gossip, perhaps)\nThe problem asks us to implement a queue with ONLY ONE stack. It seems hard, but it is actually an easy problem.\nThe push function is easy, just push the value into the stack. And the pop function is a little bit hard, but we can do it with recursion to get the first element of the “queue”, and put every items else in their origin order in the stack.\nThe code is short, too.\nclass StQueue1(QueueTpl): def __init__(self): self.clear() def clear(self): self.a = []\u0001 def push(self, value): self.a.append(value) def pop(self): if not self.a: return None if len(self.a) == 1: return self.a.pop() else: v = self.a.pop() res = self.pop() self.a.append(v) return res The time complexity of a push is O(1) with no extra memory space; a pop is takes O(n) of time, and O(n) extra memory space in the stack area(not the stack).\nImplement a queue with TWO stacks This problem is so classic and so popular, so I just paste my solution here as everyone knows the answer.\nclass StQueue2(QueueTpl): def __init__(self): self.clear() def clear(self): self.a = [] self.b = [] def push(self, value): self.b.append(value) def pop(self): if not self.a: while self.b: self.a.append(self.b.pop()) if not self.a: return None return self.a.pop() Implement a queue with THREE stacks As it is said in the book, it’s a hard problem. And here is a discuss in the Stackoverflow where I find this solution.\n3 2 1 This solution uses nested stacks to perform as a linked-list, and use the linked-list to perform as a queue.\nA queue of “1, 2, 3” looks like this:\n[1, [2, [3] ] ], We use three stack pointers stack_a stack_b and stack_c, stack_a points to the stack which stores the nested stacks, and stack_b is a pointer to the last stack the nested stack, stack_c as a temporary stack pointer.\nSo, push function is just push the new value in the last stack in the stack which is pointed by pointer stack_b, and then push a new stack in stack_b and make stack_b to point to the new stack. (complicated, \u003c(=/ω＼=)\u003e)\nThe pop function is to get the first element of the nested stack, just get the first element, and make stack_a point to the rest of the data.\nThis code is easy but may hard to understand.\nclass StQueue3(QueueTpl): def __init__(self): self.clear() def clear(self): self.a = [] self.b = self.a self.c = None def push(self, value): self.c = [value] self.b.append(self.c) self.c = [] self.b.append(self.c) self.b = self.c def pop(self): if len(self.a) == 0: return None self.c = self.a.pop() self.a = self.a.pop() res = self.a.pop() self.a = self.c return res The main function if __name__ == '__main__': unittest.main() To sum up ","wordCount":"761","inLanguage":"zh-cn","datePublished":"2014-05-20T13:23:03Z","dateModified":"2014-05-20T13:23:03Z","author":{"@type":"Person","name":"wizmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wizmann.top/posts/implement-queue-with-stacks/"},"publisher":{"@type":"Organization","name":"Maerlyn's Rainbow","logo":{"@type":"ImageObject","url":"https://wizmann.top/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wizmann.top/ accesskey=h title="Maerlyn's Rainbow (Alt + H)">Maerlyn's Rainbow</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How to implement a queue with stack(s)?</h1><div class=post-meta><span title='2014-05-20 13:23:03 +0000 UTC'>May 20, 2014</span>&nbsp;·&nbsp;wizmann</div></header><div class=post-content><p>This problem is from the book <a href=http://book.douban.com/subject/19952400/><em>Algorithms, 4th Edition</em></a>.</p><blockquote><p>Queue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations.</p><p>Warning : high degree of difficulty.</p></blockquote><p>When I search the Internet to find a solution, I find varieties of this problem, such as &ldquo;implement a queue with ONE stack&rdquo;, &ldquo;implement a queue with TWO stack&rdquo;, etc.</p><p>It is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let&rsquo;s rock.</p><h2 id=build-a-test-environment>Build a test environment<a hidden class=anchor aria-hidden=true href=#build-a-test-environment>#</a></h2><p>I choose python as a programming language.</p><p>So firstly, I implement an <strong>ABstract Class</strong>(ABC) of a queue as the template of all classes of queue, called <code>QueueTpl</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> abc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>QueueTpl</span>(object):
</span></span><span style=display:flex><span>    __metaclass__ <span style=color:#f92672>=</span> abc<span style=color:#f92672>.</span>ABCMeta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@abc.abstractmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@abc.abstractmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>clear</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@abc.abstractmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>push</span>(self, value):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@abc.abstractmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pop</span>(self, value):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span></code></pre></div><p>Secondly, I write an <strong>Adapter</strong> for <code>Queue.Queue()</code> class of python, called <code>QueueAdapter</code>, to make it returns <code>None</code> when we get items from an empty instance.
And we use <code>put_nowait</code> and <code>get_nowait</code> to speed up because there&rsquo;s no need to get the guarantee of <strong>thread safe</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> Queue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>QueueAdapter</span>(QueueTpl):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>clear</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>q <span style=color:#f92672>=</span> Queue<span style=color:#f92672>.</span>Queue()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>push</span>(self, value):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>q<span style=color:#f92672>.</span>put_nowait(value)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pop</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>q<span style=color:#f92672>.</span>empty():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>q<span style=color:#f92672>.</span>get_nowait()
</span></span></code></pre></div><p>At last, use <code>python unittest</code> to verify my solution.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TestStQueue</span>(unittest<span style=color:#f92672>.</span>TestCase):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test_push_and_pop</span>(self):
</span></span><span style=display:flex><span>        sq <span style=color:#f92672>=</span> QueueAdapter()
</span></span><span style=display:flex><span>        sq<span style=color:#f92672>.</span>push(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertEqual(sq<span style=color:#f92672>.</span>pop(), <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertFalse(sq<span style=color:#f92672>.</span>pop())
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>            sq<span style=color:#f92672>.</span>push(i)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>assertEqual(sq<span style=color:#f92672>.</span>pop(), i)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertFalse(sq<span style=color:#f92672>.</span>pop())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_rand_command</span>(self):
</span></span><span style=display:flex><span>        cmd <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>choice([<span style=color:#e6db74>&#39;push&#39;</span>, <span style=color:#e6db74>&#39;pop&#39;</span>])
</span></span><span style=display:flex><span>        value <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>31</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cmd, value
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test_brute_force</span>(self):
</span></span><span style=display:flex><span>        step <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span>
</span></span><span style=display:flex><span>        qs <span style=color:#f92672>=</span> [QueueAdapter(), StQueue3(), StQueue2(), StQueue1()]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(step):
</span></span><span style=display:flex><span>            a, b <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>get_rand_command()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> a <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;push&#39;</span>:
</span></span><span style=display:flex><span>                map(<span style=color:#66d9ef>lambda</span> q: q<span style=color:#f92672>.</span>push(b), qs)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                rs <span style=color:#f92672>=</span> map(<span style=color:#66d9ef>lambda</span> q: q<span style=color:#f92672>.</span>pop(), qs)
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>assertTrue(all(x <span style=color:#f92672>==</span> rs[<span style=color:#ae81ff>0</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> rs))
</span></span></code></pre></div><h2 id=implement-a-queue-with-one-stack>Implement a queue with ONE stack<a hidden class=anchor aria-hidden=true href=#implement-a-queue-with-one-stack>#</a></h2><p>It&rsquo;s said that it&rsquo;s an interview problem of Microsoft.(gossip, perhaps)</p><p>The problem asks us to implement a queue with ONLY ONE stack. It seems hard, but it is actually an easy problem.</p><p>The <code>push</code> function is easy, just push the value into the stack. And the <code>pop</code> function is a little bit hard, but we can do it with recursion to get the first element of the &ldquo;queue&rdquo;, and put every items else in their origin order in the stack.</p><p>The code is short, too.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StQueue1</span>(QueueTpl):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>clear</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a <span style=color:#f92672>=</span> []<span style=color:#960050;background-color:#1e0010></span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>push</span>(self, value):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>append(value)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pop</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>a:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(self<span style=color:#f92672>.</span>a) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            v <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>            res <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>append(v)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> res
</span></span></code></pre></div><p>The time complexity of a <code>push</code> is O(1) with no extra memory space; a <code>pop</code> is takes O(n) of time, and O(n) extra memory space in the <strong>stack area</strong>(not the stack).</p><h2 id=implement-a-queue-with-two-stacks>Implement a queue with TWO stacks<a hidden class=anchor aria-hidden=true href=#implement-a-queue-with-two-stacks>#</a></h2><p>This problem is so classic and so popular, so I just paste my solution here as everyone knows the answer.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StQueue2</span>(QueueTpl):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>clear</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>push</span>(self, value):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b<span style=color:#f92672>.</span>append(value)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pop</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>a:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> self<span style=color:#f92672>.</span>b:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>append(self<span style=color:#f92672>.</span>b<span style=color:#f92672>.</span>pop())
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>a:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span></code></pre></div><h2 id=implement-a-queue-with-three-stacks>Implement a queue with THREE stacks<a hidden class=anchor aria-hidden=true href=#implement-a-queue-with-three-stacks>#</a></h2><p>As it is said in the book, it&rsquo;s a hard problem. And here is a <a href=http://stackoverflow.com/questions/5538192/how-to-implement-a-queue-with-three-stacks>discuss</a> in the Stackoverflow where I find this <a href=http://stackoverflow.com/a/5568094/2927439>solution</a>.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 128 185"><g transform="translate(8,16)"><path d="M48 24H64" fill="none" stroke="currentcolor"/><path d="M32 40H80" fill="none" stroke="currentcolor"/><path d="M48 88H64" fill="none" stroke="currentcolor"/><path d="M16 104H96" fill="none" stroke="currentcolor"/><path d="M48 152H64" fill="none" stroke="currentcolor"/><path d="M0 168H112" fill="none" stroke="currentcolor"/><path d="M0 0V160" fill="none" stroke="currentcolor"/><path d="M16 0V96" fill="none" stroke="currentcolor"/><path d="M32 0V32" fill="none" stroke="currentcolor"/><path d="M48 0V16" fill="none" stroke="currentcolor"/><path d="M48 64V80" fill="none" stroke="currentcolor"/><path d="M48 128v16" fill="none" stroke="currentcolor"/><path d="M64 0V16" fill="none" stroke="currentcolor"/><path d="M64 64V80" fill="none" stroke="currentcolor"/><path d="M64 128v16" fill="none" stroke="currentcolor"/><path d="M80 0V32" fill="none" stroke="currentcolor"/><path d="M96 0V96" fill="none" stroke="currentcolor"/><path d="M112 0V160" fill="none" stroke="currentcolor"/><path d="M0 160v8" fill="none" stroke="currentcolor"/><path d="M16 96v8" fill="none" stroke="currentcolor"/><path d="M32 32v8" fill="none" stroke="currentcolor"/><path d="M48 16v8" fill="none" stroke="currentcolor"/><path d="M48 80v8" fill="none" stroke="currentcolor"/><path d="M48 144v8" fill="none" stroke="currentcolor"/><path d="M64 16v8" fill="none" stroke="currentcolor"/><path d="M64 80v8" fill="none" stroke="currentcolor"/><path d="M64 144v8" fill="none" stroke="currentcolor"/><path d="M80 32v8" fill="none" stroke="currentcolor"/><path d="M96 96v8" fill="none" stroke="currentcolor"/><path d="M112 160v8" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="56" y="132" fill="currentcolor" style="font-size:1em">1</text></g></svg></div><p>This solution uses nested stacks to perform as a <strong>linked-list</strong>, and use the <strong>linked-list</strong> to perform as a queue.</p><p>A queue of &ldquo;1, 2, 3&rdquo; looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>[<span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>],
</span></span></code></pre></div><p>We use three stack pointers <code>stack_a</code> <code>stack_b</code> and <code>stack_c</code>, <code>stack_a</code> points to the stack which stores the nested stacks, and <code>stack_b</code> is a pointer to the last stack the nested stack, <code>stack_c</code> as a temporary stack pointer.</p><p>So, <code>push</code> function is just push the new value in the last stack in the stack which is pointed by pointer <code>stack_b</code>, and then push a new stack in <code>stack_b</code> and make <code>stack_b</code> to point to the new stack. (complicated, &lt;(=<em>/ω＼</em>=)>)</p><p>The <code>pop</code> function is to get the first element of the nested stack, just get the first element, and make <code>stack_a</code> point to the rest of the data.</p><p>This code is easy but may hard to understand.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StQueue3</span>(QueueTpl):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>clear</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>a
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>c <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>push</span>(self, value):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>c <span style=color:#f92672>=</span> [value]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b<span style=color:#f92672>.</span>append(self<span style=color:#f92672>.</span>c)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>c <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b<span style=color:#f92672>.</span>append(self<span style=color:#f92672>.</span>c)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>b <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pop</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(self<span style=color:#f92672>.</span>a) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>c <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>a<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>a <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> res
</span></span></code></pre></div><h2 id=the-main-function>The main function<a hidden class=anchor aria-hidden=true href=#the-main-function>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    unittest<span style=color:#f92672>.</span>main()
</span></span></code></pre></div><h2 id=to-sum-up>To sum up<a hidden class=anchor aria-hidden=true href=#to-sum-up>#</a></h2><p><img alt=summarize loading=lazy src=https://github.com/Wizmann/assets/raw/master/wizmann-tk-pic/blog-queue-with-stack-summary.jpg></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wizmann.top/tags/algorithm/>Algorithm</a></li><li><a href=https://wizmann.top/tags/stack/>Stack</a></li><li><a href=https://wizmann.top/tags/queue/>Queue</a></li></ul><nav class=paginav><a class=prev href=https://wizmann.top/posts/world-at-war/><span class=title>«</span><br><span>A simple problem - World at War</span>
</a><a class=next href=https://wizmann.top/posts/read-paper-barrier/><span class=title>»</span><br><span>内存屏障初探</span></a></nav></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://wizmann.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2025 <a href=https://wizmann.top/>Maerlyn's Rainbow</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>