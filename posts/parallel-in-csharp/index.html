<!doctype html><html><head><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}}</script><script defer src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><header class=header-wrapper><div class=header><a class=site-title href=https://wizmann.top/>Maerlyn's Rainbow</a><nav class=menu></nav></div></header><main class=main-wrapper><div class=main><section class=single><h1 class=title>Parallel patterns in C#</h1><div class=tip><time datetime="2017-01-22 22:52:28 +0000 UTC">2017/01/22</time>
<span class=split>Â·</span>
<span>3862 words </span><span class=split>Â·</span>
<span>8 minutes to read</span></div><div class=taxonomies><div>Tags:
<a href=/tags/csharp>csharp</a>
<a href=/tags/parallel>parallel</a>
<a href=/tags/thread>thread</a>
<a href=/tags/async>async</a></div></div><hr><div class=content><h2 id=å†™åœ¨å‰é¢>å†™åœ¨å‰é¢ <a href=#%e5%86%99%e5%9c%a8%e5%89%8d%e9%9d%a2 class=anchor>ğŸ”—</a></h2><p>ä¸C/C++æ‰€ä½¿ç”¨çš„ï¼Œä¼ ç»Ÿçš„åŸºäºçº¿ç¨‹çš„å¹¶è¡Œæ¨¡å¼ä¸åŒï¼ŒC#å®ç°äº†ä¸°å¯Œçš„å¹¶å‘ç¼–ç¨‹æ¨¡å‹ï¼Œå…¶ä¸­ä»¥å¼‚æ­¥æ¨¡å‹æœ€ä¸ºæµè¡Œã€‚</p><p>æœ¬æ–‡ä¸­æˆ‘ä»¬é‡ç‚¹è®¨è®ºC#åœ¨å‘å±•è¿‡ç¨‹ä¸­å‡ºç°çš„å‡ ç§å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼š</p><ul><li>Async Programming Modelï¼ˆAPMï¼‰</li><li>Event-based Async Pattern (EAP)</li><li>Task-based Async Patternï¼ˆTAPï¼‰</li><li>async/awaitè¯­æ³•ç³–</li></ul><h2 id=å¼‚æ­¥ç¼–ç¨‹å…¥é—¨>å¼‚æ­¥ç¼–ç¨‹å…¥é—¨ <a href=#%e5%bc%82%e6%ad%a5%e7%bc%96%e7%a8%8b%e5%85%a5%e9%97%a8 class=anchor>ğŸ”—</a></h2><p>åŒæ­¥æ¨¡å¼æ˜¯æœ€å¸¸è§ï¼Œä¹Ÿæ˜¯æœ€è¢«äººç†ŸçŸ¥çš„ç¼–ç¨‹æ¨¡å‹ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œå‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</p><p>å¼‚æ­¥ç¼–ç¨‹å’ŒåŒæ­¥ç¼–ç¨‹ä¸åŒï¼Œç¨‹åºçš„æ‰§è¡Œæµç¨‹æ˜¯ç”±â€œäº‹ä»¶â€æ‰€é©±åŠ¨çš„ã€‚å¼‚æ­¥ç¼–ç¨‹æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œå›è°ƒä¸futureæ¨¡å¼ã€‚</p><p>å›è°ƒå‡½æ•°åœ¨Javascriptä¸­è¢«å¤§é‡ä½¿ç”¨ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½ä¸ä¼šé™Œç”Ÿã€‚ä½†æ˜¯å¤§é‡çš„å›è°ƒå‡½æ•°ä¼šè®©ä»£ç å¤±å»å¯è¯»æ€§ï¼Œé™·å…¥â€œCallback hellâ€ã€‚</p><p>Promiseæ¨¡å¼æ˜¯å›è°ƒå‡½æ•°çš„ä¸€ç§â€œåŒ…è£…â€ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå ä½ç¬¦æ¥è¡¨ç¤ºâ€œæœªæ¥â€å°†ä¼šäº§ç”Ÿçš„ä¸€ä¸ªå¼‚æ­¥å¤„ç†ç»“æœã€‚</p><p>è¿™ä¸ªå ä½ç¬¦åœ¨ä¸åŒçš„è¯­è¨€/æ¡†æ¶é‡Œé¢æœ‰ä¸åŒçš„åå­—ï¼Œå…¶å®šä¹‰ä¹Ÿä¸å°½ç›¸åŒï¼š</p><ul><li>Task - C#</li><li>Deferred - Python Twisted</li><li>Promise - Javascript</li></ul><p>åœ¨ä»»åŠ¡ç»“æŸåï¼Œä¼šè§¦å‘ç»‘å®šåœ¨è¿™ä¸ªå ä½ç¬¦ä¸Šå®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œç»§ç»­é¢„å®šä¹‰å¥½çš„é€»è¾‘ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼ŒåŒæ­¥æ¨¡å‹å°±æ˜¯ä½ ï¼š</p><p>å®…å®¶æƒ³åƒé¥­ -> ä¸‹æ¥¼ä¹°é¥­ -> ä¸Šæ¥¼ -> åƒé¥­ -> æ‰“æ¸¸æˆçœ‹æ¼‚äº®å°å§å§ã€‚</p><p>è€Œå¼‚æ­¥æ¨¡å‹å‘¢ï¼Œå°±æ˜¯ï¼š</p><p>å®…å®¶æƒ³åƒé¥­ -> æ‰‹æœºå«å¤–å– -> æ‹¿åˆ°äº†å¤–å–å®šå•ï¼ˆæ‹¿åˆ°å ä½ç¬¦ æˆ– æ³¨å†Œå›è°ƒï¼‰-> æ‰“æ¸¸æˆçœ‹æ¼‚äº®å°å§å§ -> å¤–å–å°å“¥æŠŠé¥­é€ä¸Šé—¨ï¼ˆå¯åŠ¨å›è°ƒï¼‰ -> åƒé¥­ -> ç»§ç»­æ‰“æ¸¸æˆçœ‹æ¼‚äº®å°å§å§ã€‚</p><p>è™½ç„¶ä»ä¸Šé¢çœ‹ï¼Œå¼‚æ­¥æ¨¡å‹æ¯”åŒæ­¥æ¨¡å‹è¦å¤æ‚ä¸€äº›ã€‚ä½†æ˜¯å®ƒå´èŠ‚çœäº†è€—æ—¶çš„â€œä¸Šä¸‹æ¥¼ä¹°é¥­â€çš„æ—¶é—´ï¼Œè®©ä½ å¯ä»¥åˆ†é…æ›´å¤šçš„æ—¶é—´ç”¨æ¥çœ‹æ¼‚äº®å°å§å§ã€‚è¿™å’Œæˆ‘ä»¬å†™ç¨‹åºæ—¶çš„æ€è·¯æ˜¯ä¸€è‡´çš„ï¼ŒèŠ‚çœåŠ¨è¾„åå‡ å‡ åæ¯«ç§’è€—æ—¶çš„IOæ—¶é—´ï¼Œå°†æ›´å¤šçš„æ—¶é—´ç”¨åœ¨CPUä¸Šã€‚</p><h2 id=thread-based-parallel>Thread Based Parallel <a href=#thread-based-parallel class=anchor>ğŸ”—</a></h2><p>åŸºäºçº¿ç¨‹çš„å¹¶å‘æ¨¡å‹æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„å¹¶å‘æ¨¡å‹äº†ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç°ä»£ç¼–ç¨‹è¯­è¨€éƒ½ä¼šæ”¯æŒã€‚C#ä¸­Threadçš„ç”¨æ³•ä¸Javaç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸åšå±•å¼€ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼ŒC#è¿˜æ”¯æŒThread poolï¼Œç”¨æ¥è¿è¡Œ"long-running processor-bound tasks"ã€‚</p><p>ç›´æ¥æ“ä½œçº¿ç¨‹ä¹Ÿè®¸æ˜¯ä¸­å¹´ç¨‹åºå‘˜çš„å¿…ä¿®è¯¾ï¼Œä½†æ˜¯æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹ä¼šç»™ç¨‹åºå¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ã€‚æ‰€ä»¥å„ç§æ¨¡å‹ä¸æ¡†æ¶åº”è¿è€Œç”Ÿï¼Œè¯•å›¾é™ä½å¹¶å‘ç¼–ç¨‹çš„å¤æ‚åº¦ã€‚</p><h2 id=async-programming-model-apm>Async Programming Model (APM) <a href=#async-programming-model-apm class=anchor>ğŸ”—</a></h2><p>åœ¨æˆ‘ä»¬ç†Ÿæ‚‰çš„async/awaitè¯­æ³•ç³–å‡ºç°ä¹‹å‰ï¼ŒC#ä¸­ä½¿ç”¨APMæ¥è¡¨ç¤ºå¼‚æ­¥æ“ä½œã€‚è™½ç„¶è¿™æ˜¯ä¸€ç§ä¸Šå¤æ—¶æœŸçš„å›è°ƒæ¨¡å¼è¯­æ³•ï¼Œä½†æ˜¯ç°åœ¨æœ‰å¾ˆå¤šåº“ä»æ—§æ”¯æŒè¿™ç§é£æ ¼ã€‚å¦‚Azure Storage SDKä¸­çš„<code>CloudTable.BeginExecute</code>ç­‰ä¸€ç³»åˆ—å‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨APMæ¨¡å¼çš„ä»£ç èŒƒä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.Remoting.Messaging;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.Remoting.Proxies;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Text;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> ConsoleApplication6
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>delegate</span> <span style=color:#66d9ef>int</span> AsyncInvoke();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> SI = <span style=color:#66d9ef>new</span> AsyncInvoke(MyCall);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> ar = SI.BeginInvoke(MyCallback, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Main()&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (!ar.AsyncWaitHandle.WaitOne(<span style=color:#ae81ff>1000</span>))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(<span style=color:#e6db74>&#34;Main() waiting...&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Main() done&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            Console.ReadLine();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> MyCall()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; <span style=color:#ae81ff>5</span>; i++)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(<span style=color:#e6db74>&#34;running...&#34;</span>);
</span></span><span style=display:flex><span>                Thread.Sleep(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;done&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>42</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> MyCallback(IAsyncResult iResult)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> result = iResult <span style=color:#66d9ef>as</span> AsyncResult;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> si = (AsyncInvoke) result.AsyncDelegate;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> ret = si.EndInvoke(result);
</span></span><span style=display:flex><span>            Console.WriteLine(ret);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-1-19/26234044-file_1484828912411_150f3.gif alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><ol><li>æˆ‘ä»¬å°†<code>MyCall()</code>â€œåŒ…è£…â€åœ¨ä¸€ä¸ª<code>delegate</code>ä¸­ï¼Œç„¶åè°ƒç”¨<code>BeginInvoke</code>å‡½æ•°å®ç°å¼‚æ­¥æ‰§è¡Œã€‚è¿™ä¸ªdelegateçš„æ‰§è¡Œä¸ä¼šé˜»å¡main threadã€‚</li><li>ä¸€ä¸ªå¼‚æ­¥æ‰§è¡Œçš„<code>delegate</code>å¯ä»¥æœ‰ä¸€ä¸ªå›è°ƒï¼Œè¿™ä¸ªå›è°ƒåœ¨delegateæ‰§è¡Œå®Œåè¢«è§¦å‘ã€‚</li><li>æˆ‘ä»¬å¯ä»¥"long-polling"ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨æ‰§è¡Œå®Œã€‚è¿™é‡Œçš„â€œæ‰§è¡Œå®Œâ€ä¸åŒ…æ‹¬æ¡ç›®2æåˆ°çš„å›è°ƒï¼ˆå°å¿ƒrace conditionï¼ï¼‰ã€‚</li><li>å¼‚æ­¥æ‰§è¡Œçš„ç»“æœå¯ä»¥é€šè¿‡<code>delegate.EndInvoke(IAsyncResult)</code>å‡½æ•°è·å–åˆ°å¼‚æ­¥è°ƒç”¨çš„ç»“æœã€‚</li><li>ç”±æ¡ç›®3æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨callbackå‡½æ•°ä¸­è·å–å¼‚æ­¥è°ƒç”¨çš„ç»“æœæ˜¯æœ€åˆé€‚çš„ã€‚</li></ol><p>æ‰€ä»¥APMé£æ ¼çš„ä»£ç å†™èµ·æ¥éå¸¸åƒjavascriptä¸­çš„å›è°ƒå†™æ³•ï¼Œå¦‚æœé€»è¾‘å¤æ‚çš„è¯ï¼Œç»´æŠ¤èµ·æ¥ä¼šæ˜¯ä¸€ä¸ªå¤§å‘ã€‚</p><h2 id=event-asynchronous-pattern-eap>Event Asynchronous Pattern (EAP) <a href=#event-asynchronous-pattern-eap class=anchor>ğŸ”—</a></h2><p>EAPæ˜¯å›è°ƒå‡½æ•°çš„å¦ä¸€ç§å°è£…ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.ComponentModel;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Text;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> ConsoleApplication2
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StringEventArgs</span> : EventArgs
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Content { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Solution</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>event</span> EventHandler&lt;StringEventArgs&gt; _eventHandler;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Solution()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            _eventHandler += Handle1;
</span></span><span style=display:flex><span>            _eventHandler += Handle2;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Run()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            _eventHandler?.Invoke(<span style=color:#66d9ef>this</span>, <span style=color:#66d9ef>new</span> StringEventArgs()
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Content = <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> Handle1(<span style=color:#66d9ef>object</span> sender, StringEventArgs args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Handle1 &#34;</span> + args.Content);
</span></span><span style=display:flex><span>            Thread.Sleep(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> Handle2(<span style=color:#66d9ef>object</span> sender, StringEventArgs args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Handle2 &#34;</span> + args.Content);
</span></span><span style=display:flex><span>            Thread.Sleep(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Solution sol = <span style=color:#66d9ef>new</span> Solution();
</span></span><span style=display:flex><span>            sol.Run();
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Done&#34;</span>);
</span></span><span style=display:flex><span>            Console.ReadLine();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src=https://github.com/Wizmann/assets/raw/master/wizmann-pic/17-1-20/46892581-file_1484911655343_68ae.gif alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„å‡½æ•°éƒ½æ‰§è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚å¹¶ä¸”<code>Handle1</code>å’Œ<code>Handle2</code>é¡ºåºæ‰§è¡Œã€‚</p><p>åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬fire eventçš„ä»£ç å¯ä»¥åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œä¹‹å<code>EventHandler</code>ï¼Œä¹Ÿå°±æ˜¯callbackå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚</p><p>EventåŒæ—¶æ”¯æŒ<code>BeginInvoke</code>å’Œ<code>EndInvoke</code>å‡½æ•°ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¼‚æ­¥çš„fireç›¸åº”çš„å›è°ƒã€‚ä½†æ˜¯æ³¨æ„æ­¤æ—¶æˆ‘ä»¬åªèƒ½æ³¨å†Œå”¯ä¸€çš„å›è°ƒï¼Œå› ä¸º<code>BeginInvoke</code>åªèƒ½æœ‰ä¸€ä¸ªç›®æ ‡å›è°ƒï¼ˆåŸç†ï¼šåœ¨åŒä¸€æ—¶é—´åŒä¸€çº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼‰ã€‚</p><h2 id=task-asynchronous-pattern-tap>Task Asynchronous Pattern (TAP) <a href=#task-asynchronous-pattern-tap class=anchor>ğŸ”—</a></h2><p>åœ¨.NET 4.0ï¼ˆç°åœ¨å·²ç»åˆ°6.0äº†å“¦ï¼‰ï¼ŒC#å¼•å…¥äº†TPLï¼ŒTask Parallel Libraryã€‚Taskçš„ç›®æ ‡æ˜¯ç»Ÿä¸€C#ä¸­çš„ä¸åŒå¼‚æ­¥ç¼–ç¨‹é£æ ¼ã€‚</p><p>TPLä¸­çš„Taskéå¸¸åƒJSä¸­çš„promiseå’Œtwistedä¸­çš„deferredï¼Œæ˜¯â€œæœªæ¥ä¼šå®Œæˆçš„æ“ä½œçš„ç»“æœâ€çš„å ä½ç¬¦ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€æ®µç®€å•ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Text;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> ConsoleApplication3
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Task t = Task.Run(() =&gt;
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(<span style=color:#e6db74>&#34;Task start&#34;</span>);
</span></span><span style=display:flex><span>                Thread.Sleep(<span style=color:#ae81ff>2000</span>);
</span></span><span style=display:flex><span>                Console.WriteLine(<span style=color:#e6db74>&#34;Task end&#34;</span>);
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (!t.IsCompleted)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(<span style=color:#e6db74>&#34;Main(): Task is running...&#34;</span>);
</span></span><span style=display:flex><span>                Thread.Sleep(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Done&#34;</span>);
</span></span><span style=display:flex><span>            Console.ReadLine();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™æ®µä»£ç æˆ‘ä»¬å‰é¢æåˆ°çš„APMå’ŒEAPé£æ ¼çš„ä»£ç æœ‰æ˜æ˜¾çš„ä¸åŒï¼ŒTAPæ›´æ˜“è¯»ï¼Œå¹¶ä¸”ä¿æŒäº†æ§åˆ¶æµçš„å®Œæ•´æ€§ã€‚ä¸åƒAPMéœ€è¦åœ¨<code>EndInvoke</code>å‡½æ•°ä¸­è·å–è¿”å›å€¼ä»¥åŠè¿›è¡Œåç»­æ“ä½œï¼Œä¹Ÿä¸åƒEAPä¸€æ ·éœ€è¦æ ¹æ®ä¸åŒçš„eventå£°æ˜ä¸åŒçš„å›è°ƒã€‚</p><p>Taskä¹Ÿå¯èƒ½â€œä¸²èµ·æ¥â€ï¼Œå®ç°å¤šçº§å›è°ƒçš„æœºåˆ¶ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Text;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> ConsoleApplication4
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> t0 = Task.Run(() =&gt; <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> t1 = t0.ContinueWith((antecedent) =&gt;
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(antecedent.Result);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> antecedent.Result + <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> t2 = t1.ContinueWith((antecedent) =&gt;
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(antecedent.Result);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> antecedent.Result + <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> t3 = t2.ContinueWith((antecedent) =&gt;
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Console.WriteLine(antecedent.Result);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> antecedent.Result + <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            Console.ReadLine();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå›è°ƒå†™æˆä¸€æ£µæ ‘çŠ¶ç»“æ„ï¼Œç„¶åä¸€å±‚ä¸€å±‚çš„æ‰§è¡Œï¼Œä¸è¿‡ç”Ÿå‘½æ˜¯å¦‚æ­¤å®è´µï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å……åˆ†çš„ç†ç”±è¦è¿™ä¹ˆåšã€‚</p><h2 id=asyncawaitè¯­æ³•ç³–>async/awaitè¯­æ³•ç³– <a href=#asyncawait%e8%af%ad%e6%b3%95%e7%b3%96 class=anchor>ğŸ”—</a></h2><p>async/awaitè¯­æ³•ç³–åœ¨C# 5.0ä¸­è¢«å¼•å…¥ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†é¿å…å›è°ƒå¸¦æ¥çš„ä»£ç å¤æ‚åº¦ã€‚å°±åƒTwistedä¸­çš„<code>@inlineCallbacks</code>ä¸€æ ·ï¼Œçœå»äº†deferå¤æ‚çš„å›è°ƒé“¾ã€‚</p><p><code>await</code>ä¸­æœ‰ä¸€ä¸ª"wait"ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªâ€œç­‰å¾…â€æ“ä½œã€‚å®ƒç­‰å¾…çš„æ˜¯ç›¸åº”çš„Taskæ‰§è¡Œå®Œæˆã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>void</span> DumpWebPageAsync(<span style=color:#66d9ef>string</span> uri)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    WebClient webClient = <span style=color:#66d9ef>new</span> WebClient();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>string</span> page = <span style=color:#66d9ef>await</span> webClient.DownloadStringTaskAsync(uri);
</span></span><span style=display:flex><span>    Console.WriteLine(page);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å½“ä»£ç æ‰§è¡Œåˆ°<code>await</code>ä¸€è¡Œæ—¶ï¼Œå½“å‰å‡½æ•°ä¼šä¸»åŠ¨æ”¾å¼ƒå½“å‰çš„æ§åˆ¶æµã€‚å½“ä½¿ç”¨<code>await</code>ä¿®é¥°çš„Taskå®Œæˆåï¼Œå½“å‰å‡½æ•°ä¼šä»ä¹‹å‰ä¸­æ–­çš„åœ°æ–¹ç»§ç»­æ‰§è¡Œã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥å†™å‡ºå’ŒåŒæ­¥ç‰ˆæœ¬éå¸¸ç›¸ä¼¼çš„å¼‚æ­¥ä»£ç ï¼Œåªéœ€è¦åœ¨å¿…é¡»çš„åœ°æ–¹åŠ ä¸Š<code>await</code>å…³é”®å­—ï¼Œæé†’ç¼–è¯‘å™¨è¿™é‡Œæ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œéœ€è¦é¢å¤–çš„å¤„ç†é€»è¾‘ï¼Œä½†è¿™ä¸€åˆ‡éƒ½æ˜¯å¯¹å¼€å‘è€…é€æ˜çš„ã€‚</p><h3 id=asyncawaitå¹²äº†ä»€ä¹ˆ>async/awaitå¹²äº†ä»€ä¹ˆ <a href=#asyncawait%e5%b9%b2%e4%ba%86%e4%bb%80%e4%b9%88 class=anchor>ğŸ”—</a></h3><p>æƒ³å¼„æ¸…æ¥šasync/awaitåˆ°åº•å¹²äº†ä»€ä¹ˆï¼Œé¦–å…ˆæˆ‘ä»¬è¦æƒ³æ˜ç™½çº¿ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆã€å¹²äº†ä»€ä¹ˆã€‚</p><p>çº¿ç¨‹æ˜¯è¿›ç¨‹å†…ä¸€æ¡æ‰§è¡Œæµçš„çŠ¶æ€ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ç¡¬ä»¶çŠ¶æ€ï¼ˆIPã€Registersç­‰ï¼‰ä»¥åŠå †æ ˆï¼ˆæ ˆä¸Šçš„å±€éƒ¨å˜é‡å’Œå †ä¸Šçš„è¿›ç¨‹çº§å†…å­˜ï¼‰ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³å®ç°æŒ‚èµ·/å¯åŠ¨ï¼ˆHibernating and Resumingï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æœ‰ä¸€ä¸ªæœºåˆ¶æ¥ä¿å­˜å½“å‰çº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ã€‚</p><p>æ‰€ä»¥å½“ä½ å†™ä¸‹äº†async/awaitå…³é”®å­—åï¼Œç¼–è¯‘å™¨åœ¨åé¢å¸®åŠ©ä½ ç”Ÿæˆäº†çŠ¶æ€ä¿å­˜å’Œæ¢å¤è¿è¡Œä¸Šä¸‹æ–‡çš„ä»£ç ã€‚</p><h3 id=asyncawaitåˆ°åº•å¹²äº†ä»€ä¹ˆ>async/awaitåˆ°åº•å¹²äº†ä»€ä¹ˆ <a href=#asyncawait%e5%88%b0%e5%ba%95%e5%b9%b2%e4%ba%86%e4%bb%80%e4%b9%88 class=anchor>ğŸ”—</a></h3><p>æƒ³åƒæˆ‘ä»¬æœ‰ä¸€ä¸ªå¤æ‚çš„asyncå‡½æ•°ï¼Œé‡Œé¢æœ‰å¾ˆå¤šä¸ªawaitè°ƒç”¨ï¼Œé‚£å°±æ„å‘³ç€è¿™ä¸ªå‡½æ•°ä¸­ä¼šæœ‰å¤šæ¬¡æŒ‚èµ·/ç»§ç»­æ“ä½œã€‚åŒæ—¶æˆ‘ä»¬è¿˜è¦ç»´æŠ¤è¿™ä¸ªå‡½æ•°çš„çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬æ˜¯è¿™ä¸ªè¯­æ³•ç³–çš„è®¾è®¡è€…ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ€ä¹ˆæ ·çš„æ‰‹æ®µæ¥å¤„ç†è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>æ˜¯çš„ï¼ŒçŠ¶æ€æœºã€‚async/awaité¿å…äº†ä»£ç çš„ç¢ç‰‡åŒ–ï¼Œå®ƒçš„è§£å†³æ–¹æ¡ˆå¹¶ä¸æ˜¯æ¶ˆç­äº†å›è°ƒå‡½æ•°å’ŒContinuation Tasksï¼Œè€Œæ˜¯ä½¿ç”¨å·¥å…·ï¼ˆç¼–è¯‘å™¨ï¼‰æ¥å¸®åŠ©äººç±»è¿›è¡Œé‡å¤åŠ³åŠ¨ã€‚å½“asyncå‡½æ•°ä»æŒ‚èµ·ä¸­æ¢å¤æ—¶ï¼Œä¼šè°ƒç”¨<code>MoveNext</code>å‡½æ•°ï¼ˆç›¸ä¿¡çœ‹è¿‡asyncå‡½æ•°é‚£ä¸€é•¿ä¸²çš„tracebackçš„åŒå­¦è‚¯å®šå¯¹è¿™ä¸ªå‡½æ•°éå¸¸çœ¼ç†Ÿï¼‰ï¼Œ<code>MoveNext</code>å‡½æ•°ä¼šåœ¨asyncå‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨ä»¥åŠä»æŒ‚èµ·ä¸­æ¢å¤æ—¶è¢«è°ƒç”¨ã€‚çŠ¶æ€æœºä¿å­˜äº†å½“å‰å‡½æ•°çš„æ‰§è¡ŒçŠ¶æ€ï¼Œå½“<code>MoveNext</code>å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šæ ¹æ®å½“å‰çŠ¶æ€æ¥åˆ¤æ–­æ¥ä¸‹æ¥æ‰§è¡Œä»€ä¹ˆä»£ç ã€‚</p><h3 id=asycnawaitåˆ°åº•tmdå¹²äº†ä»€ä¹ˆ>asycn/awaitåˆ°åº•TMDå¹²äº†ä»€ä¹ˆ <a href=#asycnawait%e5%88%b0%e5%ba%95tmd%e5%b9%b2%e4%ba%86%e4%bb%80%e4%b9%88 class=anchor>ğŸ”—</a></h3><p>ç”±äºasync/awaicè¯­æ³•ç³–æ˜¯åœ¨ç¼–è¯‘æœŸæ‰è¢«ç¿»è¯‘æˆç›¸åº”çš„ç¨‹åºä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ä½¿ç”¨ILåç¼–è¯‘å™¨æ¥çª¥æ¢ç¼–è¯‘å™¨åˆ°åº•åšäº†æ€æ ·çš„å¤„ç†ä¸ä¼˜åŒ–ã€‚ä¸è¿‡åç¼–è¯‘å™¨ä½ æ‡‚å¾—ï¼Œç”Ÿæˆçš„ä»£ç åŸºæœ¬æ²¡æ³•çœ‹ï¼Œè®²è§£èµ·æ¥ä¹Ÿä¼šéå¸¸æ™¦æ¶©ã€‚</p><p>å¹¸å¥½åœ¨99%çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦çŸ¥é“async/awaitæ˜¯æ€æ ·è¢«å±•å¼€çš„ã€‚å¦‚æœä½ ç¡®å®å¯¹è¿™ä¸ªé—®é¢˜æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href=https://www.codeproject.com/Articles/535635/Async-Await-and-the-Generated-StateMachine>Async Await and the Generated StateMachine</a>ã€‚</p><h2 id=å‡ ä¸ªå¸¸è§çš„å‘>å‡ ä¸ªå¸¸è§çš„å‘ <a href=#%e5%87%a0%e4%b8%aa%e5%b8%b8%e8%a7%81%e7%9a%84%e5%9d%91 class=anchor>ğŸ”—</a></h2><h3 id=await-ä¸-é”>await ä¸ é” <a href=#await-%e4%b8%8e-%e9%94%81 class=anchor>ğŸ”—</a></h3><p>ç”±äºawaitä¼šä¸­æ–­å½“å‰å‡½æ•°åœ¨å½“å‰çº¿ç¨‹çš„æ‰§è¡Œæµï¼Œå¹¶ä¸”å¯èƒ½åœ¨æ¢å¤æ—¶ï¼Œè¢«æŒ‡æ´¾åˆ°å¦å¤–çš„çº¿ç¨‹ã€‚æ‰€ä»¥å¯¹awaitåŠ é”æ˜æ˜¾æ˜¯å¤šæ­¤ä¸€ä¸¾çš„ã€‚å¹¶ä¸”å¦‚æœæ“ä½œä¸å½“ï¼Œè¿˜ä¼šé€ æˆæ­»é”ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æŠŠawaitæ”¾åˆ°åŠ é”çš„åŒºåŸŸå¤–ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>lock</span> (sync)
</span></span><span style=display:flex><span>{    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Prepare for async operation</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> myNum = <span style=color:#66d9ef>await</span> AlexsMethodAsync();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>lock</span> (sync)
</span></span><span style=display:flex><span>{    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Use result of async operation</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=there-is-an--unfired-task-between-us>&ldquo;There is an &mldr; unfired Task between us&rdquo; <a href=#there-is-an--unfired-task-between-us class=anchor>ğŸ”—</a></h3><p>ä¸€ä¸ªasyncå‡½æ•°å¦‚æœè¿”å›çš„æ˜¯Taskï¼Œé‚£ä¹ˆå®ƒè¿”å›çš„ä¸€å®šæ˜¯ä¸€ä¸ªhot taskï¼Œå³å·²ç»è¢«å¯åŠ¨äº†çš„Taskã€‚</p><p>å¹¶ä¸”awaitåªå¯èƒ½ç­‰å¾…ä¸€ä¸ªå¯åŠ¨äº†çš„Taskï¼Œå¦åˆ™awaitæ“ä½œå°†ä¼šhangä½ï¼Œç ´åç¨‹åºæ—¢å®šçš„æ‰§è¡Œæµã€‚</p><h3 id=ä½¿ç”¨tpl-task-parallel-library>ä½¿ç”¨TPL (Task parallel library) <a href=#%e4%bd%bf%e7%94%a8tpl-task-parallel-library class=anchor>ğŸ”—</a></h3><blockquote><p>Async methods are synchronous util needed.</p></blockquote><p>å¦‚æœæˆ‘ä»¬æƒ³åŒæ—¶æ‰§è¡Œå‡ ä¸ªå¼‚æ­¥æ“ä½œï¼Œä½¿ç”¨foræ¥éå†æ‰§è¡Œå¯ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚å› ä¸ºè¿™æ ·å‡½æ•°æ‰§è¡Œæµä»ç„¶æ˜¯é¡ºåºæ‰§è¡Œç›¸åº”çš„å‡½æ•°ã€‚</p><p>TPLæä¾›äº†<code>WhenAll</code>ã€<code>WhenAny</code>ç­‰å‡½æ•°ï¼Œè®©æˆ‘ä»¬å¯ä»¥æœ‰å¼¹æ€§çš„å¹¶å‘æ‰§è¡ŒTaskã€‚</p><p>å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨PLINQï¼Œä¸è¿‡è¿™å°±æ˜¯å¦å¤–ä¸€ä¸ªè¯é¢˜äº†ã€‚</p><h2 id=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥ <a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 class=anchor>ğŸ”—</a></h2><ul><li><a href=https://www.codeproject.com/Articles/535635/Async-Await-and-the-Generated-StateMachine>Async Await and the Generated StateMachine</a></li><li><a href=http://blog.stephencleary.com/2012/07/async-interop-with-iasyncresult.html>Async Interop with IAsyncResult</a></li><li><a href="https://msdn.microsoft.com/en-us/library/wewwczdw(v=vs.110).aspx">Event-based Asynchronous Pattern Overview</a></li><li><a href=https://www.safaribooksonline.com/library/view/async-in-c/9781449337155/>Async in C# 5.0</a></li><li><a href=https://www.safaribooksonline.com/library/view/essential-c-60/9780134176147/>Essential C# 6.0</a> Cpt18</li></ul></div></section></div><div class=side><div class=side-recent><h2 class=side-title><a href=/posts/>Recent Posts</a></h2><hr><ul><li><a href=/posts/why-not-start-with-ddia-part-1/>ä¸ºä»€ä¹ˆæˆ‘ä¸å»ºè®®ä½ é˜…è¯»ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ï¼ˆä¹‹ä¸€ï¼‰</a></li><li><a href=/posts/vertical-axis-wind-turbine-3d-model/>é£åŠ›æ¶¡è½®æœº 3D æ¨¡å‹ / Vertical Axis Wind Turbine (VAWT) 3D Model</a></li><li><a href=/posts/press-pad-3d-model/>3Dæ‰“å°è§£å‹ç©å…· / 3D Printed Fidget Toy</a></li><li><a href=/posts/lava-store/>è®ºæ–‡é˜…è¯»ï¼šLavaStore - é«˜æ€§èƒ½ã€æœ¬åœ°å­˜å‚¨å¼•æ“çš„æ¼”è¿›</a></li><li><a href=/posts/std-smart-ptrs-cpp-for-the-antiquated-4/>åŠ¨æ‰‹å®ç°æ™ºèƒ½æŒ‡é’ˆ ï¼ˆä¸Šç¯‡ï¼‰ - C++ for the Antiquatedï¼ˆä¹‹å››ï¼‰</a></li></ul></div><div class=side-categories><h2>Categories</h2><hr><ul></ul></div><div class=side-tags><h2>Tags</h2><hr><ul><li><a href=/tags/.net>.net (1)</a></li><li><a href=/tags/3d-printing>3d printing (2)</a></li><li><a href=/tags/a2b>a2b (1)</a></li><li><a href=/tags/ahk>ahk (1)</a></li><li><a href=/tags/algorithm>algorithm (26)</a></li><li><a href=/tags/alloca>alloca (1)</a></li><li><a href=/tags/allocate>allocate (1)</a></li><li><a href=/tags/arduino>arduino (1)</a></li><li><a href=/tags/asm>asm (1)</a></li><li><a href=/tags/async>async (2)</a></li><li><a href=/tags/atcoder>atcoder (1)</a></li><li><a href=/tags/autohotkey>autohotkey (1)</a></li><li><a href=/tags/autopilot>autopilot (1)</a></li><li><a href=/tags/azure>azure (2)</a></li><li><a href=/tags/b-tree>b-tree (1)</a></li><li><a href=/tags/basic-paxos>basic paxos (2)</a></li><li><a href=/tags/bbr>bbr (1)</a></li><li><a href=/tags/binary-indexed-tree>binary indexed tree (1)</a></li><li><a href=/tags/binary-tree>binary tree (1)</a></li><li><a href=/tags/bittorrent>bittorrent (1)</a></li><li><a href=/tags/borg>borg (1)</a></li><li><a href=/tags/bw-tree>bw-tree (1)</a></li><li><a href=/tags/c>c# (1)</a></li><li><a href=/tags/c++>c++ (6)</a></li><li><a href=/tags/cache>cache (1)</a></li><li><a href=/tags/cachegrind>cachegrind (1)</a></li><li><a href=/tags/cap>cap (1)</a></li><li><a href=/tags/career>career (1)</a></li><li><a href=/tags/cas>cas (3)</a></li><li><a href=/tags/ceph>ceph (1)</a></li><li><a href=/tags/chrome-extension>chrome-extension (2)</a></li><li><a href=/tags/cmpxchg>cmpxchg (2)</a></li><li><a href=/tags/cocurrency>cocurrency (1)</a></li><li><a href=/tags/code-golf>code golf (1)</a></li><li><a href=/tags/codeforces>codeforces (14)</a></li><li><a href=/tags/compare-ans-swap>compare-ans-swap (1)</a></li><li><a href=/tags/computational-geometry>computational geometry (1)</a></li><li><a href=/tags/consistency>consistency (1)</a></li><li><a href=/tags/cpp>cpp (9)</a></li><li><a href=/tags/cpu>cpu (1)</a></li><li><a href=/tags/cse351>cse351 (2)</a></li><li><a href=/tags/csharp>csharp (1)</a></li><li><a href=/tags/css>css (1)</a></li><li><a href=/tags/data-center>data center (1)</a></li><li><a href=/tags/data-center-management>data center management (1)</a></li><li><a href=/tags/defer>defer (1)</a></li><li><a href=/tags/distributed-system>distributed system (4)</a></li><li><a href=/tags/epoll>epoll (1)</a></li><li><a href=/tags/ergodone>ergodone (1)</a></li><li><a href=/tags/fifo>fifo (1)</a></li><li><a href=/tags/flatbuffer>flatbuffer (2)</a></li><li><a href=/tags/fn-layer>fn-layer (1)</a></li><li><a href=/tags/front-end-development>front-end development (1)</a></li><li><a href=/tags/functional-programming>functional programming (1)</a></li><li><a href=/tags/game>game (1)</a></li><li><a href=/tags/gcj>gcj (1)</a></li><li><a href=/tags/geohash>geohash (1)</a></li><li><a href=/tags/geometric>geometric (1)</a></li><li><a href=/tags/geometry>geometry (1)</a></li><li><a href=/tags/get-things-done>get things done (1)</a></li><li><a href=/tags/google>google (3)</a></li><li><a href=/tags/graph>graph (1)</a></li><li><a href=/tags/head-first>head-first (1)</a></li><li><a href=/tags/heap>heap (1)</a></li><li><a href=/tags/herd7>herd7 (1)</a></li><li><a href=/tags/induction>induction (2)</a></li><li><a href=/tags/interview>interview (5)</a></li><li><a href=/tags/keyboard>keyboard (2)</a></li><li><a href=/tags/kubernetes>kubernetes (1)</a></li><li><a href=/tags/lavastore>lavastore (1)</a></li><li><a href=/tags/leetcode>leetcode (4)</a></li><li><a href=/tags/leveldb>leveldb (1)</a></li><li><a href=/tags/linkedin>linkedin (1)</a></li><li><a href=/tags/linux>linux (1)</a></li><li><a href=/tags/litmus>litmus (1)</a></li><li><a href=/tags/lock-less>lock-less (1)</a></li><li><a href=/tags/lsm-tree>lsm-tree (1)</a></li><li><a href=/tags/markdown>markdown (1)</a></li><li><a href=/tags/median>median (1)</a></li><li><a href=/tags/memory>memory (1)</a></li><li><a href=/tags/memory-barrier>memory-barrier (3)</a></li><li><a href=/tags/mesi>mesi (1)</a></li><li><a href=/tags/message-queue>message queue (1)</a></li><li><a href=/tags/metadata>metadata (1)</a></li><li><a href=/tags/metaprogramming>metaprogramming (1)</a></li><li><a href=/tags/microsoft>microsoft (2)</a></li><li><a href=/tags/misaka>misaka (1)</a></li><li><a href=/tags/modern-c++>modern c++ (1)</a></li><li><a href=/tags/modern-cpp>modern cpp (4)</a></li><li><a href=/tags/mosca>mosca (1)</a></li><li><a href=/tags/mq>mq (1)</a></li><li><a href=/tags/multi-paxos>multi paxos (1)</a></li><li><a href=/tags/multi-thread>multi-thread (3)</a></li><li><a href=/tags/multiprocess>multiprocess (1)</a></li><li><a href=/tags/multithread>multithread (3)</a></li><li><a href=/tags/network>network (1)</a></li><li><a href=/tags/networking>networking (4)</a></li><li><a href=/tags/non-blocking>non-blocking (1)</a></li><li><a href=/tags/normal-distribution>normal-distribution (1)</a></li><li><a href=/tags/ocaml>ocaml (1)</a></li><li><a href=/tags/ot>ot (1)</a></li><li><a href=/tags/parallel>parallel (1)</a></li><li><a href=/tags/partition>partition (1)</a></li><li><a href=/tags/paxos>paxos (2)</a></li><li><a href=/tags/pecifica>pecifica (1)</a></li><li><a href=/tags/pelican>pelican (1)</a></li><li><a href=/tags/phxrpc>phxrpc (8)</a></li><li><a href=/tags/pl>pl (1)</a></li><li><a href=/tags/poi>poi (1)</a></li><li><a href=/tags/poll>poll (1)</a></li><li><a href=/tags/powershell>powershell (1)</a></li><li><a href=/tags/priority-queue>priority queue (1)</a></li><li><a href=/tags/priority_queue>priority_queue (1)</a></li><li><a href=/tags/profile>profile (1)</a></li><li><a href=/tags/programming-interview>programming interview (1)</a></li><li><a href=/tags/promela>promela (2)</a></li><li><a href=/tags/protobuf>protobuf (1)</a></li><li><a href=/tags/protocol>protocol (4)</a></li><li><a href=/tags/python>python (3)</a></li><li><a href=/tags/quartile>quartile (1)</a></li><li><a href=/tags/queue>queue (2)</a></li><li><a href=/tags/quick-sort>quick sort (1)</a></li><li><a href=/tags/quora>quora (1)</a></li><li><a href=/tags/racket>racket (1)</a></li><li><a href=/tags/raft>raft (2)</a></li><li><a href=/tags/rocksdb>rocksdb (2)</a></li><li><a href=/tags/rpc>rpc (4)</a></li><li><a href=/tags/social-network>social network (1)</a></li><li><a href=/tags/socket>socket (1)</a></li><li><a href=/tags/solution>solution (2)</a></li><li><a href=/tags/sort>sort (1)</a></li><li><a href=/tags/spin>spin (4)</a></li><li><a href=/tags/spin/promela>spin/promela (2)</a></li><li><a href=/tags/stack>stack (2)</a></li><li><a href=/tags/stdfunction>std::function (1)</a></li><li><a href=/tags/stl>stl (1)</a></li><li><a href=/tags/storage>storage (3)</a></li><li><a href=/tags/storage-system>storage system (2)</a></li><li><a href=/tags/streambuf>streambuf (1)</a></li><li><a href=/tags/string>string (1)</a></li><li><a href=/tags/stup>stup (3)</a></li><li><a href=/tags/stylish>stylish (1)</a></li><li><a href=/tags/system>system (1)</a></li><li><a href=/tags/system-design>system design (5)</a></li><li><a href=/tags/tcp>tcp (4)</a></li><li><a href=/tags/tcpip>tcpip (1)</a></li><li><a href=/tags/thread>thread (3)</a></li><li><a href=/tags/tlv>tlv (1)</a></li><li><a href=/tags/twisted>twisted (1)</a></li><li><a href=/tags/ucontext>ucontext (2)</a></li><li><a href=/tags/udp>udp (3)</a></li><li><a href=/tags/useless>useless (1)</a></li><li><a href=/tags/userscript>userscript (1)</a></li><li><a href=/tags/valgrind>valgrind (1)</a></li><li><a href=/tags/wait-free>wait-free (1)</a></li><li><a href=/tags/was>was (1)</a></li><li><a href=/tags/wisckey>wisckey (1)</a></li><li><a href=/tags/workflowy>workflowy (1)</a></li><li><a href=/tags/wsl>wsl (1)</a></li><li><a href=/tags/yunfile>yunfile (1)</a></li><li><a href=/tags/zeromq>zeromq (1)</a></li><li><a href=/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B>å¹¶å‘ç¼–ç¨‹ (1)</a></li><li><a href=/tags/%E7%B3%99%E5%BF%AB%E7%8C%9B>ç³™å¿«çŒ› (1)</a></li><li><a href=/tags/%E5%88%9B%E9%80%A0%E5%8A%9B>åˆ›é€ åŠ› (1)</a></li><li><a href=/tags/%E8%AF%BB%E4%B9%A6>è¯»ä¹¦ (2)</a></li><li><a href=/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B>å¤šçº¿ç¨‹ (2)</a></li><li><a href=/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F>åˆ†å¸ƒå¼ç³»ç»Ÿ (6)</a></li><li><a href=/tags/%E5%88%86%E7%B1%BB%E5%99%A8>åˆ†ç±»å™¨ (1)</a></li><li><a href=/tags/%E5%85%AC%E5%BC%80%E8%AF%BE>å…¬å¼€è¯¾ (4)</a></li><li><a href=/tags/%E8%AE%A1%E6%95%B0>è®¡æ•° (1)</a></li><li><a href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6>è®¡ç®—æœºç§‘å­¦ (1)</a></li><li><a href=/tags/%E9%93%BE%E8%A1%A8>é“¾è¡¨ (1)</a></li><li><a href=/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB>è®ºæ–‡é˜…è¯» (1)</a></li><li><a href=/tags/%E9%9D%A2%E8%AF%95>é¢è¯• (1)</a></li><li><a href=/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86>å®¹æ–¥åŸç† (1)</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F>è®¾è®¡æ¨¡å¼ (2)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E7%BC%96%E7%A0%81>æ•°æ®ç¼–ç  (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93>æ•°æ®åº“ (4)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E5%AF%86%E9%9B%86%E5%9E%8B%E5%BA%94%E7%94%A8%E7%B3%BB%E7%BB%9F>æ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿ (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B>æ•°æ®æ¨¡å‹ (1)</a></li><li><a href=/tags/%E6%95%B0%E6%8D%AE%E7%B3%BB%E7%BB%9F>æ•°æ®ç³»ç»Ÿ (1)</a></li><li><a href=/tags/%E6%80%9D%E7%BB%B4>æ€ç»´ (1)</a></li><li><a href=/tags/%E7%AE%97%E6%B3%95>ç®—æ³• (14)</a></li><li><a href=/tags/%E7%B4%A2%E5%BC%95>ç´¢å¼• (1)</a></li><li><a href=/tags/%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84>ç´¢å¼•ç»“æ„ (1)</a></li><li><a href=/tags/%E9%A2%98%E8%A7%A3>é¢˜è§£ (11)</a></li><li><a href=/tags/%E9%97%B2%E8%81%8A>é—²èŠ (3)</a></li><li><a href=/tags/%E5%8D%8F%E7%A8%8B>åç¨‹ (1)</a></li><li><a href=/tags/%E5%8E%8B%E7%BC%A9>å‹ç¼© (1)</a></li><li><a href=/tags/%E4%B8%80%E8%87%B4%E6%80%A7>ä¸€è‡´æ€§ (3)</a></li><li><a href=/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6>ä¸»ä»å¤åˆ¶ (1)</a></li><li><a href=/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2>å­—ç¬¦ä¸² (1)</a></li><li><a href=/tags/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95>æœ€å°è¡¨ç¤ºæ³• (1)</a></li></ul></div></div></main><footer class=footer><div class=footer-row><a class=footer-item href=https://wizmann.top/posts/index.xml>Feed of Posts
<i class=icofont-rss></i></a></div></footer></body></html>