<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=Content-Security-Policy content="script-src 'self'; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'none'"><link rel=stylesheet href=/css/style.feedcd92d05c2cf19ee7487656b358ee4805f831b7b39711851199d0a6f8934cf9ba379d02425d485c5b65ae299bdffda3770739545d595074076bf3ead284ab.css media=screen integrity="sha512-/u3NktBcLPGe50h2VrNY7kgF+DG3s5cRhRGZ0Kb4k0z5ujedAkJdSFxbZa4pm9/9o3cHOVRdWVB0B2vz6tKEqw==" crossorigin=anonymous><title>2020 计蒜之道 线上决赛 - C. 攀登山峰</title>
<meta name=description content=" 本文使用了一种概率算法，不是正解，只求骗分。
题意 原题
给一个长度为n的数组A[1&mldr;n]。
现在有q个查询请求（q <= 1e5），每个请求给定一个长度为m的子数组A[i&mldr;j]和一个整数t。问在子数组中出现次数超过m/t的数字中（t <= 20），最大的数是多少。
"><link rel=canonical href=https://wizmann.top/posts/jisuanke-climb-the-hill/><link rel=alternate hreflang=zh-CN href=https://wizmann.top/posts/jisuanke-climb-the-hill/><link rel=alternate hreflang=x-default href=https://wizmann.top/posts/jisuanke-climb-the-hill/><meta property="og:title" content="2020 计蒜之道 线上决赛 - C. 攀登山峰"><meta property="og:description" content="
本文使用了一种概率算法，不是正解，只求骗分。
题意
原题
给一个长度为n的数组A[1&mldr;n]。
现在有q个查询请求（q <= 1e5），每个请求给定一个长度为m的子数组A[i&mldr;j]和一个整数t。问在子数组中出现次数超过m/t的数字中（t <= 20），最大的数是多少。"><meta property="og:type" content="article"><meta property="og:url" content="https://wizmann.top/posts/jisuanke-climb-the-hill/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-26T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-26T00:00:00+00:00"><meta property="og:site_name" content="Maerlyn's Rainbow"><meta name=twitter:card content="summary"><meta name=twitter:title content="2020 计蒜之道 线上决赛 - C. 攀登山峰"><meta name=twitter:description content="
本文使用了一种概率算法，不是正解，只求骗分。
题意
原题
给一个长度为n的数组A[1&mldr;n]。
现在有q个查询请求（q <= 1e5），每个请求给定一个长度为m的子数组A[i&mldr;j]和一个整数t。问在子数组中出现次数超过m/t的数字中（t <= 20），最大的数是多少。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"2020 计蒜之道 线上决赛 - C. 攀登山峰","datePublished":"2020-10-26T00:00:00+00:00","dateModified":"2020-10-26T00:00:00+00:00","mainEntityOfPage":"https://wizmann.top/","publisher":{"@type":"Organization","name":"Maerlyn's Rainbow"},"wordcount":714,"description":" 本文使用了一种概率算法，不是正解，只求骗分。\n题意 原题\n给一个长度为n的数组A[1\u0026hellip;n]。\n现在有q个查询请求（q \u0026lt;= 1e5），每个请求给定一个长度为m的子数组A[i\u0026hellip;j]和一个整数t。问在子数组中出现次数超过m/t的数字中（t \u0026lt;= 20），最大的数是多少。\n","keywords":null}</script></head><body class="posts single d-flex flex-column min-vh-100"><header class=main-header><nav class="navbar navbar-expand-lg"><div class=container><a class=navbar-brand href=/>Maerlyn's Rainbow
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="menu-main navbar-nav me-auto mb-2 mb-lg-0"></ul></div></div></nav></header><div id=content><div class="container py-3"><blockquote><p>本文使用了一种概率算法，不是正解，只求骗分。</p></blockquote><h2 id=题意>题意</h2><p><a href=https://nanti.jisuanke.com/t/49111 target=_blank rel=noopener>原题</a></p><p>给一个长度为n的数组A[1&mldr;n]。</p><p>现在有q个查询请求（q &lt;= 1e5），每个请求给定一个长度为m的子数组A[i&mldr;j]和一个整数t。问在子数组中出现次数超过m/t的数字中（t &lt;= 20），最大的数是多少。</p><h2 id=题意中的坑>题意中的坑</h2><p>阈值m / t是一个实数。（题意不明先死个🐴好吗？）</p><h2 id=解法>解法</h2><p>首先我们将每种数字出现的位置简历一个索引，此时对于任意一个数，我们可以用二分法在O(logn)的时间内求出其在某个区间内出现的次数。</p><p>因为t最大是20，也就意味着如果我们随机取数，那么取到一个符合出现次数限制的（超过m/t次）数字的概率是1/t。如果我们进行多次尝试，并使用上面的方法对其进行验证，几乎可以保证我们一定可以取到正确的那一个。</p><p>那么“多次尝试”是多少次呢？我们枚举所有的t，然后计算其在q=1e5的情况下的成功率。因为这是一个随机算法，我们先使用下面的代码分别计算一下成功率为10%和50%的期望尝试次数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#coding=utf-8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>21</span>):
</span></span><span style=display:flex><span>    fail <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>/</span> i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3000</span>):
</span></span><span style=display:flex><span>        ff <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> fail <span style=color:#f92672>**</span> j
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pow(ff, <span style=color:#ae81ff>100000</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.1</span>:
</span></span><span style=display:flex><span>            print i, j, pow(ff, <span style=color:#ae81ff>100000</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p><img src=https://raw.githubusercontent.com/Wizmann/assets/master/wizmann-pic/20-10-27/1603729521727_2020-10-27_00-25-20.png alt></p><p>由上表我们可以知道，对于不同的t，我们可以使用不同的尝试次数以达到预期的胜率。</p><p>总的时间复杂度为O(q * logn * attempt)，对于极限数据可能会有超时的风险，所以我们在随机尝试时可以加入些许的优化，例如加上输入输出外挂，以及不计算重复值与小于最大值的值等。剩下的工作就是孜孜不倦的提交，直到获得AC为止。（评测机你辛苦了）</p><p>以及，记得加上初始化随机数种子<code>srand(time(NULL));</code>，否则你的随机数每次都一样。。。</p><p>实际上总的胜率还是很高的，说明数据并没有达到极限，出题人手下留情做了个人（</p><p>代码请见<a href=https://github.com/Wizmann/ACM-ICPC/blob/master/Jisuanke/T49111-%E6%94%80%E7%99%BB%E5%B1%B1%E5%B3%B0.cc target=_blank rel=noopener>这里</a></p></div></div><footer class="py-3 mt-auto bg-light"><div class="container py-1 my-1"><div class="d-flex flex-wrap justify-content-between align-items-center"><p class="col-md mb-0 text-muted"></p><ul class="nav col-md-auto justify-content-end"></ul></div></div></footer><script src=/js/main.min.e8d88c82c0438b527f1aca4115652ba1e2877bf805b75593b23ac0e3fe2b3fe95a467d1feef275355132ba061da6404b0d24d55afabc209b294b1db043be014d.js integrity="sha512-6NiMgsBDi1J/GspBFWUroeKHe/gFt1WTsjrA4/4rP+laRn0f7vJ1NVEyugYdpkBLDSTVWvq8IJspSx2wQ74BTQ==" crossorigin=anonymous defer></script></body></html>